2023-05-16 17:47:25.636495: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-16 17:47:27.091909: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-16 17:47:27.092041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-16 17:47:27.099711: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.099893: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-16 17:47:27.099911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-16 17:47:27.099949: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-16 17:47:27.099967: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-16 17:47:27.099982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-16 17:47:27.099997: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-16 17:47:27.100968: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-16 17:47:27.101000: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-16 17:47:27.101020: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-16 17:47:27.101075: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.101255: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.101394: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-16 17:47:27.101558: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-16 17:47:27.103216: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-16 17:47:27.103290: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.103436: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-16 17:47:27.103453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-16 17:47:27.103464: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-16 17:47:27.103474: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-16 17:47:27.103483: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-16 17:47:27.103499: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-16 17:47:27.103511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-16 17:47:27.103521: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-16 17:47:27.103530: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-16 17:47:27.103570: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.103738: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.103873: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-16 17:47:27.103898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-16 17:47:27.903561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-16 17:47:27.903598: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-16 17:47:27.903604: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-16 17:47:27.903833: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.904049: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.904222: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:27.904368: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21648 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-16 17:47:28.340901: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-16 17:47:28.341117: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:28.341317: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-16 17:47:28.341361: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-16 17:47:28.341379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-16 17:47:28.341389: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-16 17:47:28.341406: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-16 17:47:28.341415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-16 17:47:28.341432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-16 17:47:28.341442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-16 17:47:28.341451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-16 17:47:28.341515: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:28.341697: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:28.341835: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-16 17:47:28.341856: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-16 17:47:28.341860: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-16 17:47:28.341864: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-16 17:47:28.341924: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:28.342095: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-16 17:47:28.342235: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21648 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
2023-05-16 17:47:28.362122: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2023-05-16 17:47:28.404085: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-16 17:47:28.931550: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-16 17:47:29.408853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-16 17:47:29.413316: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
the count of label lines 20084
(20084,)
args: Namespace(eps=1.0, eps_step=0.5, max_iter=20, patience=None, permute_truncated=False, ps_epochs=50, relabel_rounds=1, retrain_seq2seq=False, rv=1, save_path='/home/huan1932/IoTDataGenerate/data_preprocess/result', seed=0, sequence_length=10, use_prob_embedding=False)
args.seed=0
date: 20230516
******************Train Per-Step Detector******************
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
kind: 
ps-detector-attack  trainset_min:-3.0454362462748454
ps-detector-attack  trainset_max:138.38713813073164
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Train on 17236 samples, validate on 1916 samples
Epoch 1/50
17236/17236 - 3s - loss: 0.1351 - accuracy: 0.9545 - auc: 0.9894 - recall: 0.9659 - precision: 0.9446 - val_loss: 0.0765 - val_accuracy: 0.9749 - val_auc: 0.9952 - val_recall: 0.9817 - val_precision: 0.9672
Epoch 2/50
17236/17236 - 2s - loss: 0.0630 - accuracy: 0.9770 - auc: 0.9969 - recall: 0.9875 - precision: 0.9673 - val_loss: 0.0656 - val_accuracy: 0.9796 - val_auc: 0.9963 - val_recall: 0.9925 - val_precision: 0.9665
Epoch 3/50
17236/17236 - 2s - loss: 0.0562 - accuracy: 0.9785 - auc: 0.9974 - recall: 0.9887 - precision: 0.9690 - val_loss: 0.0579 - val_accuracy: 0.9796 - val_auc: 0.9971 - val_recall: 0.9882 - val_precision: 0.9705
Epoch 4/50
17236/17236 - 2s - loss: 0.0518 - accuracy: 0.9804 - auc: 0.9978 - recall: 0.9905 - precision: 0.9710 - val_loss: 0.0548 - val_accuracy: 0.9796 - val_auc: 0.9976 - val_recall: 0.9850 - val_precision: 0.9735
Epoch 5/50
17236/17236 - 2s - loss: 0.0494 - accuracy: 0.9814 - auc: 0.9980 - recall: 0.9914 - precision: 0.9721 - val_loss: 0.0525 - val_accuracy: 0.9828 - val_auc: 0.9976 - val_recall: 0.9946 - val_precision: 0.9706
Epoch 6/50
17236/17236 - 2s - loss: 0.0471 - accuracy: 0.9822 - auc: 0.9982 - recall: 0.9925 - precision: 0.9726 - val_loss: 0.0630 - val_accuracy: 0.9796 - val_auc: 0.9968 - val_recall: 0.9882 - val_precision: 0.9705
Epoch 7/50
17236/17236 - 2s - loss: 0.0453 - accuracy: 0.9825 - auc: 0.9982 - recall: 0.9918 - precision: 0.9739 - val_loss: 0.0509 - val_accuracy: 0.9833 - val_auc: 0.9978 - val_recall: 0.9882 - val_precision: 0.9777
Epoch 8/50
17236/17236 - 2s - loss: 0.0447 - accuracy: 0.9821 - auc: 0.9984 - recall: 0.9910 - precision: 0.9739 - val_loss: 0.0489 - val_accuracy: 0.9828 - val_auc: 0.9980 - val_recall: 0.9936 - val_precision: 0.9716
Epoch 9/50
17236/17236 - 2s - loss: 0.0425 - accuracy: 0.9832 - auc: 0.9985 - recall: 0.9922 - precision: 0.9748 - val_loss: 0.0467 - val_accuracy: 0.9823 - val_auc: 0.9987 - val_recall: 0.9936 - val_precision: 0.9706
Epoch 10/50
17236/17236 - 2s - loss: 0.0418 - accuracy: 0.9838 - auc: 0.9985 - recall: 0.9920 - precision: 0.9761 - val_loss: 0.0524 - val_accuracy: 0.9838 - val_auc: 0.9977 - val_recall: 0.9871 - val_precision: 0.9797
Epoch 11/50
17236/17236 - 2s - loss: 0.0416 - accuracy: 0.9846 - auc: 0.9986 - recall: 0.9928 - precision: 0.9768 - val_loss: 0.0447 - val_accuracy: 0.9843 - val_auc: 0.9988 - val_recall: 0.9936 - val_precision: 0.9747
Epoch 12/50
17236/17236 - 2s - loss: 0.0389 - accuracy: 0.9853 - auc: 0.9987 - recall: 0.9938 - precision: 0.9772 - val_loss: 0.0414 - val_accuracy: 0.9843 - val_auc: 0.9982 - val_recall: 0.9936 - val_precision: 0.9747
Epoch 13/50
17236/17236 - 2s - loss: 0.0381 - accuracy: 0.9849 - auc: 0.9989 - recall: 0.9926 - precision: 0.9777 - val_loss: 0.0415 - val_accuracy: 0.9838 - val_auc: 0.9984 - val_recall: 0.9957 - val_precision: 0.9717
Epoch 14/50
17236/17236 - 2s - loss: 0.0364 - accuracy: 0.9859 - auc: 0.9989 - recall: 0.9942 - precision: 0.9780 - val_loss: 0.0381 - val_accuracy: 0.9849 - val_auc: 0.9991 - val_recall: 0.9946 - val_precision: 0.9747
Epoch 15/50
17236/17236 - 2s - loss: 0.0371 - accuracy: 0.9850 - auc: 0.9989 - recall: 0.9929 - precision: 0.9775 - val_loss: 0.0395 - val_accuracy: 0.9870 - val_auc: 0.9985 - val_recall: 0.9979 - val_precision: 0.9758
Epoch 16/50
17236/17236 - 2s - loss: 0.0358 - accuracy: 0.9862 - auc: 0.9990 - recall: 0.9941 - precision: 0.9787 - val_loss: 0.0380 - val_accuracy: 0.9875 - val_auc: 0.9986 - val_recall: 0.9946 - val_precision: 0.9799
Epoch 17/50
17236/17236 - 2s - loss: 0.0352 - accuracy: 0.9868 - auc: 0.9989 - recall: 0.9946 - precision: 0.9795 - val_loss: 0.0384 - val_accuracy: 0.9864 - val_auc: 0.9987 - val_recall: 0.9936 - val_precision: 0.9788
Epoch 18/50
17236/17236 - 2s - loss: 0.0350 - accuracy: 0.9861 - auc: 0.9990 - recall: 0.9942 - precision: 0.9784 - val_loss: 0.0411 - val_accuracy: 0.9854 - val_auc: 0.9983 - val_recall: 0.9925 - val_precision: 0.9778
Epoch 19/50
17236/17236 - 2s - loss: 0.0338 - accuracy: 0.9873 - auc: 0.9990 - recall: 0.9948 - precision: 0.9802 - val_loss: 0.0397 - val_accuracy: 0.9859 - val_auc: 0.9982 - val_recall: 0.9979 - val_precision: 0.9738
Epoch 20/50
17236/17236 - 2s - loss: 0.0325 - accuracy: 0.9878 - auc: 0.9991 - recall: 0.9954 - precision: 0.9805 - val_loss: 0.0365 - val_accuracy: 0.9870 - val_auc: 0.9987 - val_recall: 0.9979 - val_precision: 0.9758
Epoch 21/50
17236/17236 - 2s - loss: 0.0313 - accuracy: 0.9879 - auc: 0.9991 - recall: 0.9954 - precision: 0.9807 - val_loss: 0.0343 - val_accuracy: 0.9875 - val_auc: 0.9994 - val_recall: 0.9979 - val_precision: 0.9769
Epoch 22/50
17236/17236 - 2s - loss: 0.0297 - accuracy: 0.9888 - auc: 0.9992 - recall: 0.9969 - precision: 0.9811 - val_loss: 0.0320 - val_accuracy: 0.9880 - val_auc: 0.9988 - val_recall: 0.9989 - val_precision: 0.9769
Epoch 23/50
17236/17236 - 2s - loss: 0.0290 - accuracy: 0.9888 - auc: 0.9993 - recall: 0.9964 - precision: 0.9815 - val_loss: 0.0348 - val_accuracy: 0.9885 - val_auc: 0.9988 - val_recall: 0.9914 - val_precision: 0.9851
Epoch 24/50
17236/17236 - 2s - loss: 0.0294 - accuracy: 0.9885 - auc: 0.9992 - recall: 0.9956 - precision: 0.9817 - val_loss: 0.0472 - val_accuracy: 0.9854 - val_auc: 0.9984 - val_recall: 0.9903 - val_precision: 0.9798
Epoch 25/50
17236/17236 - 2s - loss: 0.0295 - accuracy: 0.9889 - auc: 0.9992 - recall: 0.9960 - precision: 0.9822 - val_loss: 0.0331 - val_accuracy: 0.9901 - val_auc: 0.9987 - val_recall: 0.9979 - val_precision: 0.9820
Epoch 26/50
17236/17236 - 2s - loss: 0.0276 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9965 - precision: 0.9830 - val_loss: 0.0321 - val_accuracy: 0.9896 - val_auc: 0.9988 - val_recall: 0.9936 - val_precision: 0.9851
Epoch 27/50
17236/17236 - 2s - loss: 0.0283 - accuracy: 0.9889 - auc: 0.9993 - recall: 0.9961 - precision: 0.9820 - val_loss: 0.0293 - val_accuracy: 0.9885 - val_auc: 0.9990 - val_recall: 0.9936 - val_precision: 0.9830
Epoch 28/50
17236/17236 - 2s - loss: 0.0279 - accuracy: 0.9885 - auc: 0.9993 - recall: 0.9954 - precision: 0.9819 - val_loss: 0.0321 - val_accuracy: 0.9885 - val_auc: 0.9990 - val_recall: 0.9968 - val_precision: 0.9799
Epoch 29/50
17236/17236 - 2s - loss: 0.0269 - accuracy: 0.9892 - auc: 0.9994 - recall: 0.9966 - precision: 0.9821 - val_loss: 0.0347 - val_accuracy: 0.9849 - val_auc: 0.9993 - val_recall: 0.9957 - val_precision: 0.9737
Epoch 30/50
17236/17236 - 2s - loss: 0.0268 - accuracy: 0.9884 - auc: 0.9994 - recall: 0.9950 - precision: 0.9821 - val_loss: 0.0279 - val_accuracy: 0.9890 - val_auc: 0.9991 - val_recall: 0.9946 - val_precision: 0.9830
Epoch 31/50
17236/17236 - 2s - loss: 0.0258 - accuracy: 0.9901 - auc: 0.9994 - recall: 0.9971 - precision: 0.9833 - val_loss: 0.0340 - val_accuracy: 0.9890 - val_auc: 0.9987 - val_recall: 0.9979 - val_precision: 0.9800
Epoch 32/50
17236/17236 - 2s - loss: 0.0255 - accuracy: 0.9896 - auc: 0.9995 - recall: 0.9963 - precision: 0.9831 - val_loss: 0.0310 - val_accuracy: 0.9890 - val_auc: 0.9989 - val_recall: 0.9979 - val_precision: 0.9800
Epoch 33/50
17236/17236 - 2s - loss: 0.0263 - accuracy: 0.9897 - auc: 0.9994 - recall: 0.9955 - precision: 0.9842 - val_loss: 0.0292 - val_accuracy: 0.9880 - val_auc: 0.9994 - val_recall: 0.9989 - val_precision: 0.9769
Epoch 34/50
17236/17236 - 2s - loss: 0.0256 - accuracy: 0.9905 - auc: 0.9994 - recall: 0.9969 - precision: 0.9845 - val_loss: 0.0271 - val_accuracy: 0.9901 - val_auc: 0.9995 - val_recall: 0.9989 - val_precision: 0.9810
Epoch 35/50
17236/17236 - 2s - loss: 0.0244 - accuracy: 0.9903 - auc: 0.9994 - recall: 0.9971 - precision: 0.9838 - val_loss: 0.0366 - val_accuracy: 0.9854 - val_auc: 0.9988 - val_recall: 0.9839 - val_precision: 0.9860
Epoch 36/50
17236/17236 - 2s - loss: 0.0229 - accuracy: 0.9911 - auc: 0.9995 - recall: 0.9964 - precision: 0.9859 - val_loss: 0.0276 - val_accuracy: 0.9911 - val_auc: 0.9991 - val_recall: 0.9968 - val_precision: 0.9851
Epoch 37/50
17236/17236 - 2s - loss: 0.0232 - accuracy: 0.9914 - auc: 0.9995 - recall: 0.9970 - precision: 0.9860 - val_loss: 0.0312 - val_accuracy: 0.9885 - val_auc: 0.9991 - val_recall: 0.9882 - val_precision: 0.9882
Epoch 38/50
17236/17236 - 2s - loss: 0.0214 - accuracy: 0.9924 - auc: 0.9994 - recall: 0.9979 - precision: 0.9871 - val_loss: 0.0267 - val_accuracy: 0.9927 - val_auc: 0.9986 - val_recall: 0.9979 - val_precision: 0.9872
Epoch 39/50
17236/17236 - 2s - loss: 0.0234 - accuracy: 0.9916 - auc: 0.9994 - recall: 0.9973 - precision: 0.9862 - val_loss: 0.0257 - val_accuracy: 0.9948 - val_auc: 0.9990 - val_recall: 0.9979 - val_precision: 0.9915
Epoch 40/50
17236/17236 - 2s - loss: 0.0225 - accuracy: 0.9916 - auc: 0.9994 - recall: 0.9965 - precision: 0.9869 - val_loss: 0.0316 - val_accuracy: 0.9875 - val_auc: 0.9990 - val_recall: 0.9850 - val_precision: 0.9892
Epoch 41/50
17236/17236 - 2s - loss: 0.0217 - accuracy: 0.9916 - auc: 0.9996 - recall: 0.9969 - precision: 0.9866 - val_loss: 0.0301 - val_accuracy: 0.9916 - val_auc: 0.9991 - val_recall: 0.9903 - val_precision: 0.9925
Epoch 42/50
17236/17236 - 2s - loss: 0.0216 - accuracy: 0.9919 - auc: 0.9994 - recall: 0.9963 - precision: 0.9876 - val_loss: 0.0243 - val_accuracy: 0.9911 - val_auc: 0.9992 - val_recall: 0.9979 - val_precision: 0.9841
Epoch 43/50
17236/17236 - 2s - loss: 0.0212 - accuracy: 0.9925 - auc: 0.9995 - recall: 0.9971 - precision: 0.9881 - val_loss: 0.0298 - val_accuracy: 0.9916 - val_auc: 0.9988 - val_recall: 0.9968 - val_precision: 0.9862
Epoch 44/50
17236/17236 - 2s - loss: 0.0196 - accuracy: 0.9925 - auc: 0.9996 - recall: 0.9978 - precision: 0.9874 - val_loss: 0.0232 - val_accuracy: 0.9932 - val_auc: 0.9991 - val_recall: 0.9979 - val_precision: 0.9883
Epoch 45/50
17236/17236 - 2s - loss: 0.0203 - accuracy: 0.9927 - auc: 0.9995 - recall: 0.9970 - precision: 0.9886 - val_loss: 0.0276 - val_accuracy: 0.9932 - val_auc: 0.9989 - val_recall: 0.9989 - val_precision: 0.9873
Epoch 46/50
17236/17236 - 2s - loss: 0.0231 - accuracy: 0.9920 - auc: 0.9994 - recall: 0.9964 - precision: 0.9877 - val_loss: 0.0458 - val_accuracy: 0.9901 - val_auc: 0.9980 - val_recall: 0.9968 - val_precision: 0.9831
Epoch 47/50
17236/17236 - 2s - loss: 0.0226 - accuracy: 0.9924 - auc: 0.9994 - recall: 0.9976 - precision: 0.9874 - val_loss: 0.0315 - val_accuracy: 0.9911 - val_auc: 0.9990 - val_recall: 0.9903 - val_precision: 0.9914
Epoch 48/50
17236/17236 - 2s - loss: 0.0205 - accuracy: 0.9926 - auc: 0.9997 - recall: 0.9970 - precision: 0.9884 - val_loss: 0.0281 - val_accuracy: 0.9922 - val_auc: 0.9990 - val_recall: 0.9968 - val_precision: 0.9872
Epoch 49/50
17236/17236 - 2s - loss: 0.0182 - accuracy: 0.9932 - auc: 0.9997 - recall: 0.9975 - precision: 0.9890 - val_loss: 0.0260 - val_accuracy: 0.9932 - val_auc: 0.9992 - val_recall: 0.9979 - val_precision: 0.9883
Epoch 50/50
17236/17236 - 2s - loss: 0.0203 - accuracy: 0.9925 - auc: 0.9996 - recall: 0.9962 - precision: 0.9889 - val_loss: 0.0315 - val_accuracy: 0.9870 - val_auc: 0.9995 - val_recall: 0.9839 - val_precision: 0.9892
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
kind: 
ps-detector-attack  testset_min:-3.045436243980641
ps-detector-attack  testset_max:32.63330682674631
Metrics: 
 {'auc': 0.9373687021541747, 'accuracy': 0.9862981337113158, 'precision': 0.7018633540372671, 'recall': 0.9186991869918699, 'f1': 0.7957746478873239, 'fp': 48, 'tp': 113, 'fn': 10, 'tn': 4062, 'auprc': 0.9133019128464729, 'precision99': 0.97, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
kind: 
ps-detector-recon  trainset_min:-2.4484992515578954
ps-detector-recon  trainset_max:96.22275969699034
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Train on 12969 samples, validate on 1441 samples
Epoch 1/50
12969/12969 - 2s - loss: 0.3500 - accuracy: 0.8632 - auc_1: 0.8902 - recall_1: 0.9920 - precision_1: 0.7884 - val_loss: 0.3263 - val_accuracy: 0.8709 - val_auc_1: 0.8892 - val_recall_1: 0.9946 - val_precision_1: 0.8009
Epoch 2/50
12969/12969 - 1s - loss: 0.2987 - accuracy: 0.8778 - auc_1: 0.9021 - recall_1: 0.9961 - precision_1: 0.8051 - val_loss: 0.3246 - val_accuracy: 0.8709 - val_auc_1: 0.8897 - val_recall_1: 0.9946 - val_precision_1: 0.8009
Epoch 3/50
12969/12969 - 1s - loss: 0.2957 - accuracy: 0.8779 - auc_1: 0.9050 - recall_1: 0.9964 - precision_1: 0.8051 - val_loss: 0.3294 - val_accuracy: 0.8709 - val_auc_1: 0.8894 - val_recall_1: 0.9946 - val_precision_1: 0.8009
Epoch 4/50
12969/12969 - 1s - loss: 0.2956 - accuracy: 0.8779 - auc_1: 0.9033 - recall_1: 0.9966 - precision_1: 0.8050 - val_loss: 0.3250 - val_accuracy: 0.8716 - val_auc_1: 0.8904 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 5/50
12969/12969 - 1s - loss: 0.2941 - accuracy: 0.8779 - auc_1: 0.9057 - recall_1: 0.9969 - precision_1: 0.8049 - val_loss: 0.3303 - val_accuracy: 0.8709 - val_auc_1: 0.8897 - val_recall_1: 0.9946 - val_precision_1: 0.8009
Epoch 6/50
12969/12969 - 1s - loss: 0.2948 - accuracy: 0.8783 - auc_1: 0.9059 - recall_1: 0.9972 - precision_1: 0.8053 - val_loss: 0.3266 - val_accuracy: 0.8716 - val_auc_1: 0.8904 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 7/50
12969/12969 - 1s - loss: 0.2939 - accuracy: 0.8785 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.3274 - val_accuracy: 0.8716 - val_auc_1: 0.8899 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 8/50
12969/12969 - 1s - loss: 0.2932 - accuracy: 0.8784 - auc_1: 0.9072 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.3259 - val_accuracy: 0.8716 - val_auc_1: 0.8902 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 9/50
12969/12969 - 1s - loss: 0.2932 - accuracy: 0.8786 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3251 - val_accuracy: 0.8716 - val_auc_1: 0.8902 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 10/50
12969/12969 - 1s - loss: 0.2930 - accuracy: 0.8786 - auc_1: 0.9060 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3253 - val_accuracy: 0.8716 - val_auc_1: 0.8902 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 11/50
12969/12969 - 1s - loss: 0.2931 - accuracy: 0.8785 - auc_1: 0.9049 - recall_1: 0.9975 - precision_1: 0.8053 - val_loss: 0.3290 - val_accuracy: 0.8716 - val_auc_1: 0.8907 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 12/50
12969/12969 - 1s - loss: 0.2924 - accuracy: 0.8786 - auc_1: 0.9037 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3271 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 13/50
12969/12969 - 1s - loss: 0.2921 - accuracy: 0.8786 - auc_1: 0.9047 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3444 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 14/50
12969/12969 - 1s - loss: 0.2927 - accuracy: 0.8786 - auc_1: 0.9031 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3241 - val_accuracy: 0.8716 - val_auc_1: 0.8899 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 15/50
12969/12969 - 1s - loss: 0.2920 - accuracy: 0.8785 - auc_1: 0.9018 - recall_1: 0.9975 - precision_1: 0.8053 - val_loss: 0.3222 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 16/50
12969/12969 - 1s - loss: 0.2918 - accuracy: 0.8786 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3278 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 17/50
12969/12969 - 1s - loss: 0.2918 - accuracy: 0.8785 - auc_1: 0.9067 - recall_1: 0.9975 - precision_1: 0.8053 - val_loss: 0.3239 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 18/50
12969/12969 - 1s - loss: 0.2917 - accuracy: 0.8786 - auc_1: 0.9051 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3201 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 19/50
12969/12969 - 1s - loss: 0.2914 - accuracy: 0.8786 - auc_1: 0.9028 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3183 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 20/50
12969/12969 - 1s - loss: 0.2911 - accuracy: 0.8786 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3173 - val_accuracy: 0.8716 - val_auc_1: 0.8908 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 21/50
12969/12969 - 1s - loss: 0.2910 - accuracy: 0.8786 - auc_1: 0.9049 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3179 - val_accuracy: 0.8716 - val_auc_1: 0.8903 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 22/50
12969/12969 - 1s - loss: 0.2911 - accuracy: 0.8785 - auc_1: 0.9035 - recall_1: 0.9975 - precision_1: 0.8053 - val_loss: 0.3143 - val_accuracy: 0.8716 - val_auc_1: 0.8912 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 23/50
12969/12969 - 1s - loss: 0.2909 - accuracy: 0.8787 - auc_1: 0.9041 - recall_1: 0.9975 - precision_1: 0.8056 - val_loss: 0.3177 - val_accuracy: 0.8716 - val_auc_1: 0.8917 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 24/50
12969/12969 - 1s - loss: 0.2901 - accuracy: 0.8786 - auc_1: 0.9059 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3191 - val_accuracy: 0.8716 - val_auc_1: 0.8912 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 25/50
12969/12969 - 1s - loss: 0.2906 - accuracy: 0.8786 - auc_1: 0.9054 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3156 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 26/50
12969/12969 - 1s - loss: 0.2908 - accuracy: 0.8786 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3153 - val_accuracy: 0.8716 - val_auc_1: 0.8913 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 27/50
12969/12969 - 1s - loss: 0.2901 - accuracy: 0.8786 - auc_1: 0.9035 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3139 - val_accuracy: 0.8716 - val_auc_1: 0.8913 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 28/50
12969/12969 - 1s - loss: 0.2889 - accuracy: 0.8786 - auc_1: 0.9077 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3183 - val_accuracy: 0.8716 - val_auc_1: 0.8913 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 29/50
12969/12969 - 1s - loss: 0.2895 - accuracy: 0.8786 - auc_1: 0.9052 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3152 - val_accuracy: 0.8716 - val_auc_1: 0.8919 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 30/50
12969/12969 - 1s - loss: 0.2903 - accuracy: 0.8785 - auc_1: 0.9035 - recall_1: 0.9972 - precision_1: 0.8055 - val_loss: 0.3135 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 31/50
12969/12969 - 1s - loss: 0.2893 - accuracy: 0.8786 - auc_1: 0.9035 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3157 - val_accuracy: 0.8716 - val_auc_1: 0.8919 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 32/50
12969/12969 - 1s - loss: 0.2894 - accuracy: 0.8786 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3135 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 33/50
12969/12969 - 1s - loss: 0.2890 - accuracy: 0.8787 - auc_1: 0.9046 - recall_1: 0.9975 - precision_1: 0.8056 - val_loss: 0.3124 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 34/50
12969/12969 - 1s - loss: 0.2887 - accuracy: 0.8786 - auc_1: 0.9052 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3143 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 35/50
12969/12969 - 1s - loss: 0.2894 - accuracy: 0.8786 - auc_1: 0.9041 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3113 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 36/50
12969/12969 - 1s - loss: 0.2885 - accuracy: 0.8787 - auc_1: 0.9068 - recall_1: 0.9975 - precision_1: 0.8056 - val_loss: 0.3140 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 37/50
12969/12969 - 1s - loss: 0.2889 - accuracy: 0.8788 - auc_1: 0.9048 - recall_1: 0.9975 - precision_1: 0.8057 - val_loss: 0.3127 - val_accuracy: 0.8716 - val_auc_1: 0.8921 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 38/50
12969/12969 - 1s - loss: 0.2889 - accuracy: 0.8786 - auc_1: 0.9061 - recall_1: 0.9975 - precision_1: 0.8055 - val_loss: 0.3137 - val_accuracy: 0.8716 - val_auc_1: 0.8917 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 39/50
12969/12969 - 1s - loss: 0.2889 - accuracy: 0.8789 - auc_1: 0.9035 - recall_1: 0.9975 - precision_1: 0.8058 - val_loss: 0.3135 - val_accuracy: 0.8716 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 40/50
12969/12969 - 1s - loss: 0.2886 - accuracy: 0.8786 - auc_1: 0.9034 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.3125 - val_accuracy: 0.8716 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 41/50
12969/12969 - 1s - loss: 0.2880 - accuracy: 0.8787 - auc_1: 0.9052 - recall_1: 0.9975 - precision_1: 0.8056 - val_loss: 0.3109 - val_accuracy: 0.8716 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 42/50
12969/12969 - 1s - loss: 0.2878 - accuracy: 0.8793 - auc_1: 0.9055 - recall_1: 0.9975 - precision_1: 0.8063 - val_loss: 0.3114 - val_accuracy: 0.8716 - val_auc_1: 0.8920 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 43/50
12969/12969 - 1s - loss: 0.2884 - accuracy: 0.8787 - auc_1: 0.9053 - recall_1: 0.9975 - precision_1: 0.8056 - val_loss: 0.3102 - val_accuracy: 0.8716 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 44/50
12969/12969 - 1s - loss: 0.2868 - accuracy: 0.8799 - auc_1: 0.9051 - recall_1: 0.9972 - precision_1: 0.8074 - val_loss: 0.3102 - val_accuracy: 0.8737 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8037
Epoch 45/50
12969/12969 - 1s - loss: 0.2880 - accuracy: 0.8793 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8064 - val_loss: 0.3101 - val_accuracy: 0.8737 - val_auc_1: 0.8917 - val_recall_1: 0.9959 - val_precision_1: 0.8037
Epoch 46/50
12969/12969 - 1s - loss: 0.2870 - accuracy: 0.8801 - auc_1: 0.9068 - recall_1: 0.9975 - precision_1: 0.8074 - val_loss: 0.3105 - val_accuracy: 0.8737 - val_auc_1: 0.8914 - val_recall_1: 0.9959 - val_precision_1: 0.8037
Epoch 47/50
12969/12969 - 1s - loss: 0.2859 - accuracy: 0.8806 - auc_1: 0.9078 - recall_1: 0.9974 - precision_1: 0.8082 - val_loss: 0.3095 - val_accuracy: 0.8737 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8037
Epoch 48/50
12969/12969 - 1s - loss: 0.2869 - accuracy: 0.8799 - auc_1: 0.9058 - recall_1: 0.9975 - precision_1: 0.8072 - val_loss: 0.3111 - val_accuracy: 0.8716 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 49/50
12969/12969 - 1s - loss: 0.2860 - accuracy: 0.8806 - auc_1: 0.9065 - recall_1: 0.9975 - precision_1: 0.8081 - val_loss: 0.3109 - val_accuracy: 0.8716 - val_auc_1: 0.8927 - val_recall_1: 0.9959 - val_precision_1: 0.8011
Epoch 50/50
12969/12969 - 1s - loss: 0.2860 - accuracy: 0.8803 - auc_1: 0.9072 - recall_1: 0.9974 - precision_1: 0.8077 - val_loss: 0.3077 - val_accuracy: 0.8737 - val_auc_1: 0.8915 - val_recall_1: 0.9959 - val_precision_1: 0.8037
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
kind: 
ps-detector-recon  testset_min:-2.4484992496151756
ps-detector-recon  testset_max:28.32679285519669
Metrics: 
 {'auc': 0.9114695143002047, 'accuracy': 0.9581856839121191, 'precision': 0.9491945477075588, 'recall': 0.9957751056223595, 'f1': 0.9719270420301348, 'fp': 164, 'tp': 3064, 'fn': 13, 'tn': 992, 'auprc': 0.8919140671587674, 'precision99': 0.7000000000000001, 'recall99': 0.02}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
kind: 
ps-detector-infec  trainset_min:-2.3799714775110803
ps-detector-infec  trainset_max:140.77286670370265
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Train on 17836 samples, validate on 1982 samples
Epoch 1/50
17836/17836 - 2s - loss: 0.3811 - accuracy: 0.8487 - auc_2: 0.8952 - recall_2: 0.7858 - precision_2: 0.8977 - val_loss: 0.3191 - val_accuracy: 0.8769 - val_auc_2: 0.9198 - val_recall_2: 0.8201 - val_precision_2: 0.9333
Epoch 2/50
17836/17836 - 2s - loss: 0.3017 - accuracy: 0.8848 - auc_2: 0.9237 - recall_2: 0.8185 - precision_2: 0.9427 - val_loss: 0.2981 - val_accuracy: 0.8814 - val_auc_2: 0.9245 - val_recall_2: 0.8094 - val_precision_2: 0.9539
Epoch 3/50
17836/17836 - 2s - loss: 0.2860 - accuracy: 0.8907 - auc_2: 0.9293 - recall_2: 0.8217 - precision_2: 0.9524 - val_loss: 0.2818 - val_accuracy: 0.8890 - val_auc_2: 0.9306 - val_recall_2: 0.8172 - val_precision_2: 0.9620
Epoch 4/50
17836/17836 - 2s - loss: 0.2804 - accuracy: 0.8929 - auc_2: 0.9309 - recall_2: 0.8225 - precision_2: 0.9564 - val_loss: 0.2756 - val_accuracy: 0.8895 - val_auc_2: 0.9335 - val_recall_2: 0.8172 - val_precision_2: 0.9631
Epoch 5/50
17836/17836 - 2s - loss: 0.2767 - accuracy: 0.8947 - auc_2: 0.9309 - recall_2: 0.8233 - precision_2: 0.9595 - val_loss: 0.2778 - val_accuracy: 0.8900 - val_auc_2: 0.9330 - val_recall_2: 0.8240 - val_precision_2: 0.9569
Epoch 6/50
17836/17836 - 2s - loss: 0.2716 - accuracy: 0.8959 - auc_2: 0.9341 - recall_2: 0.8234 - precision_2: 0.9623 - val_loss: 0.2706 - val_accuracy: 0.8951 - val_auc_2: 0.9339 - val_recall_2: 0.8240 - val_precision_2: 0.9679
Epoch 7/50
17836/17836 - 2s - loss: 0.2706 - accuracy: 0.8964 - auc_2: 0.9341 - recall_2: 0.8232 - precision_2: 0.9636 - val_loss: 0.2719 - val_accuracy: 0.8935 - val_auc_2: 0.9329 - val_recall_2: 0.8201 - val_precision_2: 0.9688
Epoch 8/50
17836/17836 - 2s - loss: 0.2688 - accuracy: 0.8972 - auc_2: 0.9338 - recall_2: 0.8234 - precision_2: 0.9652 - val_loss: 0.2665 - val_accuracy: 0.8971 - val_auc_2: 0.9370 - val_recall_2: 0.8240 - val_precision_2: 0.9723
Epoch 9/50
17836/17836 - 2s - loss: 0.2657 - accuracy: 0.8980 - auc_2: 0.9350 - recall_2: 0.8231 - precision_2: 0.9672 - val_loss: 0.2617 - val_accuracy: 0.8951 - val_auc_2: 0.9369 - val_recall_2: 0.8240 - val_precision_2: 0.9679
Epoch 10/50
17836/17836 - 2s - loss: 0.2630 - accuracy: 0.8987 - auc_2: 0.9364 - recall_2: 0.8246 - precision_2: 0.9673 - val_loss: 0.2690 - val_accuracy: 0.8930 - val_auc_2: 0.9347 - val_recall_2: 0.8192 - val_precision_2: 0.9688
Epoch 11/50
17836/17836 - 2s - loss: 0.2621 - accuracy: 0.8989 - auc_2: 0.9359 - recall_2: 0.8240 - precision_2: 0.9684 - val_loss: 0.2676 - val_accuracy: 0.8961 - val_auc_2: 0.9357 - val_recall_2: 0.8240 - val_precision_2: 0.9701
Epoch 12/50
17836/17836 - 2s - loss: 0.2624 - accuracy: 0.9000 - auc_2: 0.9350 - recall_2: 0.8257 - precision_2: 0.9690 - val_loss: 0.2671 - val_accuracy: 0.8951 - val_auc_2: 0.9362 - val_recall_2: 0.8201 - val_precision_2: 0.9722
Epoch 13/50
17836/17836 - 2s - loss: 0.2614 - accuracy: 0.8990 - auc_2: 0.9374 - recall_2: 0.8234 - precision_2: 0.9693 - val_loss: 0.2661 - val_accuracy: 0.8946 - val_auc_2: 0.9362 - val_recall_2: 0.8250 - val_precision_2: 0.9657
Epoch 14/50
17836/17836 - 2s - loss: 0.2599 - accuracy: 0.9003 - auc_2: 0.9346 - recall_2: 0.8250 - precision_2: 0.9705 - val_loss: 0.2591 - val_accuracy: 0.8961 - val_auc_2: 0.9378 - val_recall_2: 0.8240 - val_precision_2: 0.9701
Epoch 15/50
17836/17836 - 2s - loss: 0.2581 - accuracy: 0.9003 - auc_2: 0.9376 - recall_2: 0.8246 - precision_2: 0.9708 - val_loss: 0.2601 - val_accuracy: 0.8966 - val_auc_2: 0.9376 - val_recall_2: 0.8240 - val_precision_2: 0.9712
Epoch 16/50
17836/17836 - 2s - loss: 0.2592 - accuracy: 0.9008 - auc_2: 0.9367 - recall_2: 0.8253 - precision_2: 0.9713 - val_loss: 0.2700 - val_accuracy: 0.8910 - val_auc_2: 0.9359 - val_recall_2: 0.8123 - val_precision_2: 0.9719
Epoch 17/50
17836/17836 - 2s - loss: 0.2574 - accuracy: 0.9008 - auc_2: 0.9357 - recall_2: 0.8257 - precision_2: 0.9709 - val_loss: 0.2606 - val_accuracy: 0.8961 - val_auc_2: 0.9362 - val_recall_2: 0.8211 - val_precision_2: 0.9733
Epoch 18/50
17836/17836 - 2s - loss: 0.2547 - accuracy: 0.9017 - auc_2: 0.9364 - recall_2: 0.8256 - precision_2: 0.9729 - val_loss: 0.2672 - val_accuracy: 0.8956 - val_auc_2: 0.9368 - val_recall_2: 0.8231 - val_precision_2: 0.9700
Epoch 19/50
17836/17836 - 2s - loss: 0.2552 - accuracy: 0.9023 - auc_2: 0.9373 - recall_2: 0.8265 - precision_2: 0.9734 - val_loss: 0.2602 - val_accuracy: 0.8976 - val_auc_2: 0.9379 - val_recall_2: 0.8231 - val_precision_2: 0.9745
Epoch 20/50
17836/17836 - 2s - loss: 0.2534 - accuracy: 0.9019 - auc_2: 0.9385 - recall_2: 0.8261 - precision_2: 0.9728 - val_loss: 0.2543 - val_accuracy: 0.8966 - val_auc_2: 0.9383 - val_recall_2: 0.8250 - val_precision_2: 0.9701
Epoch 21/50
17836/17836 - 2s - loss: 0.2527 - accuracy: 0.9029 - auc_2: 0.9374 - recall_2: 0.8269 - precision_2: 0.9744 - val_loss: 0.2551 - val_accuracy: 0.8996 - val_auc_2: 0.9395 - val_recall_2: 0.8260 - val_precision_2: 0.9758
Epoch 22/50
17836/17836 - 2s - loss: 0.2510 - accuracy: 0.9032 - auc_2: 0.9400 - recall_2: 0.8264 - precision_2: 0.9757 - val_loss: 0.2525 - val_accuracy: 0.8986 - val_auc_2: 0.9390 - val_recall_2: 0.8260 - val_precision_2: 0.9735
Epoch 23/50
17836/17836 - 2s - loss: 0.2493 - accuracy: 0.9034 - auc_2: 0.9383 - recall_2: 0.8266 - precision_2: 0.9758 - val_loss: 0.2573 - val_accuracy: 0.8986 - val_auc_2: 0.9389 - val_recall_2: 0.8260 - val_precision_2: 0.9735
Epoch 24/50
17836/17836 - 2s - loss: 0.2534 - accuracy: 0.9022 - auc_2: 0.9380 - recall_2: 0.8258 - precision_2: 0.9739 - val_loss: 0.2543 - val_accuracy: 0.8981 - val_auc_2: 0.9390 - val_recall_2: 0.8260 - val_precision_2: 0.9724
Epoch 25/50
17836/17836 - 2s - loss: 0.2484 - accuracy: 0.9037 - auc_2: 0.9375 - recall_2: 0.8265 - precision_2: 0.9766 - val_loss: 0.2552 - val_accuracy: 0.9001 - val_auc_2: 0.9389 - val_recall_2: 0.8260 - val_precision_2: 0.9769
Epoch 26/50
17836/17836 - 2s - loss: 0.2471 - accuracy: 0.9048 - auc_2: 0.9386 - recall_2: 0.8273 - precision_2: 0.9783 - val_loss: 0.2524 - val_accuracy: 0.8986 - val_auc_2: 0.9392 - val_recall_2: 0.8260 - val_precision_2: 0.9735
Epoch 27/50
17836/17836 - 2s - loss: 0.2504 - accuracy: 0.9034 - auc_2: 0.9374 - recall_2: 0.8261 - precision_2: 0.9763 - val_loss: 0.2525 - val_accuracy: 0.8991 - val_auc_2: 0.9393 - val_recall_2: 0.8250 - val_precision_2: 0.9757
Epoch 28/50
17836/17836 - 2s - loss: 0.2462 - accuracy: 0.9054 - auc_2: 0.9392 - recall_2: 0.8275 - precision_2: 0.9794 - val_loss: 0.2514 - val_accuracy: 0.8991 - val_auc_2: 0.9384 - val_recall_2: 0.8231 - val_precision_2: 0.9779
Epoch 29/50
17836/17836 - 2s - loss: 0.2469 - accuracy: 0.9044 - auc_2: 0.9386 - recall_2: 0.8265 - precision_2: 0.9783 - val_loss: 0.2489 - val_accuracy: 0.9001 - val_auc_2: 0.9394 - val_recall_2: 0.8250 - val_precision_2: 0.9780
Epoch 30/50
17836/17836 - 2s - loss: 0.2487 - accuracy: 0.9036 - auc_2: 0.9383 - recall_2: 0.8264 - precision_2: 0.9766 - val_loss: 0.2487 - val_accuracy: 0.9006 - val_auc_2: 0.9401 - val_recall_2: 0.8260 - val_precision_2: 0.9780
Epoch 31/50
17836/17836 - 2s - loss: 0.2454 - accuracy: 0.9049 - auc_2: 0.9374 - recall_2: 0.8267 - precision_2: 0.9792 - val_loss: 0.2475 - val_accuracy: 0.9011 - val_auc_2: 0.9397 - val_recall_2: 0.8250 - val_precision_2: 0.9803
Epoch 32/50
17836/17836 - 2s - loss: 0.2446 - accuracy: 0.9056 - auc_2: 0.9390 - recall_2: 0.8273 - precision_2: 0.9801 - val_loss: 0.2504 - val_accuracy: 0.9001 - val_auc_2: 0.9400 - val_recall_2: 0.8260 - val_precision_2: 0.9769
Epoch 33/50
17836/17836 - 2s - loss: 0.2456 - accuracy: 0.9046 - auc_2: 0.9399 - recall_2: 0.8259 - precision_2: 0.9794 - val_loss: 0.2486 - val_accuracy: 0.8996 - val_auc_2: 0.9402 - val_recall_2: 0.8260 - val_precision_2: 0.9758
Epoch 34/50
17836/17836 - 2s - loss: 0.2463 - accuracy: 0.9029 - auc_2: 0.9403 - recall_2: 0.8260 - precision_2: 0.9753 - val_loss: 0.2567 - val_accuracy: 0.8976 - val_auc_2: 0.9385 - val_recall_2: 0.8221 - val_precision_2: 0.9756
Epoch 35/50
17836/17836 - 2s - loss: 0.2451 - accuracy: 0.9042 - auc_2: 0.9398 - recall_2: 0.8253 - precision_2: 0.9792 - val_loss: 0.2570 - val_accuracy: 0.8971 - val_auc_2: 0.9391 - val_recall_2: 0.8250 - val_precision_2: 0.9712
Epoch 36/50
17836/17836 - 2s - loss: 0.2443 - accuracy: 0.9046 - auc_2: 0.9391 - recall_2: 0.8266 - precision_2: 0.9787 - val_loss: 0.2513 - val_accuracy: 0.9001 - val_auc_2: 0.9396 - val_recall_2: 0.8260 - val_precision_2: 0.9769
Epoch 37/50
17836/17836 - 2s - loss: 0.2446 - accuracy: 0.9052 - auc_2: 0.9393 - recall_2: 0.8269 - precision_2: 0.9796 - val_loss: 0.2551 - val_accuracy: 0.8996 - val_auc_2: 0.9387 - val_recall_2: 0.8260 - val_precision_2: 0.9758
Epoch 38/50
17836/17836 - 2s - loss: 0.2426 - accuracy: 0.9059 - auc_2: 0.9397 - recall_2: 0.8273 - precision_2: 0.9809 - val_loss: 0.2461 - val_accuracy: 0.9001 - val_auc_2: 0.9400 - val_recall_2: 0.8260 - val_precision_2: 0.9769
Epoch 39/50
17836/17836 - 1s - loss: 0.2421 - accuracy: 0.9060 - auc_2: 0.9391 - recall_2: 0.8269 - precision_2: 0.9816 - val_loss: 0.2710 - val_accuracy: 0.8930 - val_auc_2: 0.9346 - val_recall_2: 0.8094 - val_precision_2: 0.9799
Epoch 40/50
17836/17836 - 1s - loss: 0.2434 - accuracy: 0.9055 - auc_2: 0.9407 - recall_2: 0.8268 - precision_2: 0.9805 - val_loss: 0.2496 - val_accuracy: 0.9006 - val_auc_2: 0.9398 - val_recall_2: 0.8260 - val_precision_2: 0.9780
Epoch 41/50
17836/17836 - 1s - loss: 0.2406 - accuracy: 0.9064 - auc_2: 0.9397 - recall_2: 0.8279 - precision_2: 0.9812 - val_loss: 0.2475 - val_accuracy: 0.9021 - val_auc_2: 0.9401 - val_recall_2: 0.8260 - val_precision_2: 0.9814
Epoch 42/50
17836/17836 - 1s - loss: 0.2414 - accuracy: 0.9059 - auc_2: 0.9394 - recall_2: 0.8270 - precision_2: 0.9810 - val_loss: 0.2461 - val_accuracy: 0.9016 - val_auc_2: 0.9403 - val_recall_2: 0.8260 - val_precision_2: 0.9803
Epoch 43/50
17836/17836 - 1s - loss: 0.2425 - accuracy: 0.9059 - auc_2: 0.9405 - recall_2: 0.8265 - precision_2: 0.9817 - val_loss: 0.2484 - val_accuracy: 0.9001 - val_auc_2: 0.9396 - val_recall_2: 0.8231 - val_precision_2: 0.9802
Epoch 44/50
17836/17836 - 1s - loss: 0.2430 - accuracy: 0.9047 - auc_2: 0.9412 - recall_2: 0.8259 - precision_2: 0.9797 - val_loss: 0.2492 - val_accuracy: 0.9001 - val_auc_2: 0.9405 - val_recall_2: 0.8260 - val_precision_2: 0.9769
Epoch 45/50
17836/17836 - 1s - loss: 0.2441 - accuracy: 0.9059 - auc_2: 0.9399 - recall_2: 0.8275 - precision_2: 0.9805 - val_loss: 0.2488 - val_accuracy: 0.9011 - val_auc_2: 0.9399 - val_recall_2: 0.8260 - val_precision_2: 0.9791
Epoch 46/50
17836/17836 - 1s - loss: 0.2412 - accuracy: 0.9063 - auc_2: 0.9408 - recall_2: 0.8275 - precision_2: 0.9816 - val_loss: 0.2458 - val_accuracy: 0.9006 - val_auc_2: 0.9408 - val_recall_2: 0.8250 - val_precision_2: 0.9791
Epoch 47/50
17836/17836 - 1s - loss: 0.2420 - accuracy: 0.9059 - auc_2: 0.9401 - recall_2: 0.8275 - precision_2: 0.9805 - val_loss: 0.2475 - val_accuracy: 0.9006 - val_auc_2: 0.9401 - val_recall_2: 0.8250 - val_precision_2: 0.9791
Epoch 48/50
17836/17836 - 1s - loss: 0.2420 - accuracy: 0.9053 - auc_2: 0.9404 - recall_2: 0.8269 - precision_2: 0.9799 - val_loss: 0.2586 - val_accuracy: 0.8971 - val_auc_2: 0.9368 - val_recall_2: 0.8240 - val_precision_2: 0.9723
Epoch 49/50
17836/17836 - 1s - loss: 0.2451 - accuracy: 0.9049 - auc_2: 0.9380 - recall_2: 0.8258 - precision_2: 0.9802 - val_loss: 0.2520 - val_accuracy: 0.8996 - val_auc_2: 0.9387 - val_recall_2: 0.8250 - val_precision_2: 0.9769
Epoch 50/50
17836/17836 - 1s - loss: 0.2414 - accuracy: 0.9060 - auc_2: 0.9392 - recall_2: 0.8271 - precision_2: 0.9813 - val_loss: 0.2453 - val_accuracy: 0.9016 - val_auc_2: 0.9410 - val_recall_2: 0.8260 - val_precision_2: 0.9803
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
kind: 
ps-detector-infec  testset_min:-1.7222021363244926
ps-detector-infec  testset_max:31.46267630066733
Metrics: 
 {'auc': 0.6335132573475666, 'accuracy': 0.9534609024332624, 'precision': 0.776255707762557, 'recall': 0.5345911949685535, 'f1': 0.633147113594041, 'fp': 49, 'tp': 170, 'fn': 148, 'tn': 3866, 'auprc': 0.3991735323782755, 'precision99': 0.93, 'recall99': 0.0}
******************Retrain Vanilla Per-Step Detector******************
----------------------------------
Retrain ps-detector-infec detector
----------------------------------
cle_testset_x.shape: (4233, 41)
cle_testset_y.shape: (4233,)
cle_trainset_x.shape: (19818, 41)
cle_trainset_y.shape: (19818,)

 round_index: 0
------------------
0-th train seq2seq
------------------
proportion of infection events tagged by ps-detector-attack detector:  0.0374911696437582
proportion of infection events tagged by ps-detector-recon detector:  0.4804218387324654
proportion of infection events tagged by ps-detector-infec detector:  0.4224947017862549
proportion of events estimated to be benign :  0.07129881925522252
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Train on 15847 samples, validate on 3962 samples
Epoch 1/30
15847/15847 - 5s - loss: 0.0731 - accuracy: 0.9879 - auc_3: 0.9951 - recall_3: 0.9896 - precision_3: 0.9862 - val_loss: 0.0386 - val_accuracy: 0.9926 - val_auc_3: 0.9967 - val_recall_3: 0.9923 - val_precision_3: 0.9926
Epoch 2/30
15847/15847 - 4s - loss: 0.0328 - accuracy: 0.9934 - auc_3: 0.9969 - recall_3: 0.9940 - precision_3: 0.9928 - val_loss: 0.0997 - val_accuracy: 0.9609 - val_auc_3: 0.9968 - val_recall_3: 0.9250 - val_precision_3: 0.9953
Epoch 3/30
15847/15847 - 4s - loss: 0.0300 - accuracy: 0.9933 - auc_3: 0.9975 - recall_3: 0.9933 - precision_3: 0.9934 - val_loss: 0.0313 - val_accuracy: 0.9929 - val_auc_3: 0.9972 - val_recall_3: 0.9927 - val_precision_3: 0.9928
Epoch 4/30
15847/15847 - 4s - loss: 0.0287 - accuracy: 0.9938 - auc_3: 0.9974 - recall_3: 0.9936 - precision_3: 0.9940 - val_loss: 0.0308 - val_accuracy: 0.9933 - val_auc_3: 0.9979 - val_recall_3: 0.9910 - val_precision_3: 0.9954
Epoch 5/30
15847/15847 - 4s - loss: 0.0290 - accuracy: 0.9935 - auc_3: 0.9975 - recall_3: 0.9933 - precision_3: 0.9938 - val_loss: 0.0307 - val_accuracy: 0.9930 - val_auc_3: 0.9974 - val_recall_3: 0.9926 - val_precision_3: 0.9932
Epoch 6/30
15847/15847 - 4s - loss: 0.0286 - accuracy: 0.9939 - auc_3: 0.9974 - recall_3: 0.9934 - precision_3: 0.9945 - val_loss: 0.0403 - val_accuracy: 0.9918 - val_auc_3: 0.9974 - val_recall_3: 0.9892 - val_precision_3: 0.9942
Epoch 7/30
15847/15847 - 4s - loss: 0.0276 - accuracy: 0.9938 - auc_3: 0.9978 - recall_3: 0.9928 - precision_3: 0.9948 - val_loss: 0.0355 - val_accuracy: 0.9931 - val_auc_3: 0.9978 - val_recall_3: 0.9907 - val_precision_3: 0.9952
Epoch 8/30
15847/15847 - 4s - loss: 0.0270 - accuracy: 0.9938 - auc_3: 0.9978 - recall_3: 0.9931 - precision_3: 0.9946 - val_loss: 0.0311 - val_accuracy: 0.9935 - val_auc_3: 0.9985 - val_recall_3: 0.9909 - val_precision_3: 0.9959
Epoch 9/30
15847/15847 - 4s - loss: 0.0260 - accuracy: 0.9942 - auc_3: 0.9980 - recall_3: 0.9931 - precision_3: 0.9954 - val_loss: 0.0290 - val_accuracy: 0.9933 - val_auc_3: 0.9985 - val_recall_3: 0.9920 - val_precision_3: 0.9943
Epoch 10/30
15847/15847 - 4s - loss: 0.0249 - accuracy: 0.9940 - auc_3: 0.9983 - recall_3: 0.9929 - precision_3: 0.9951 - val_loss: 0.0278 - val_accuracy: 0.9936 - val_auc_3: 0.9986 - val_recall_3: 0.9908 - val_precision_3: 0.9962
Epoch 11/30
15847/15847 - 4s - loss: 0.0254 - accuracy: 0.9941 - auc_3: 0.9981 - recall_3: 0.9931 - precision_3: 0.9951 - val_loss: 0.0270 - val_accuracy: 0.9934 - val_auc_3: 0.9982 - val_recall_3: 0.9912 - val_precision_3: 0.9953
Epoch 12/30
15847/15847 - 4s - loss: 0.0263 - accuracy: 0.9937 - auc_3: 0.9982 - recall_3: 0.9928 - precision_3: 0.9946 - val_loss: 0.0439 - val_accuracy: 0.9933 - val_auc_3: 0.9985 - val_recall_3: 0.9897 - val_precision_3: 0.9967
Epoch 13/30
15847/15847 - 4s - loss: 0.0250 - accuracy: 0.9939 - auc_3: 0.9983 - recall_3: 0.9934 - precision_3: 0.9945 - val_loss: 0.0298 - val_accuracy: 0.9936 - val_auc_3: 0.9985 - val_recall_3: 0.9907 - val_precision_3: 0.9962
Epoch 14/30
15847/15847 - 4s - loss: 0.0260 - accuracy: 0.9939 - auc_3: 0.9983 - recall_3: 0.9931 - precision_3: 0.9947 - val_loss: 0.0423 - val_accuracy: 0.9933 - val_auc_3: 0.9984 - val_recall_3: 0.9920 - val_precision_3: 0.9943
Epoch 15/30
15847/15847 - 4s - loss: 0.0253 - accuracy: 0.9939 - auc_3: 0.9982 - recall_3: 0.9928 - precision_3: 0.9951 - val_loss: 0.0426 - val_accuracy: 0.9935 - val_auc_3: 0.9986 - val_recall_3: 0.9900 - val_precision_3: 0.9968
Epoch 16/30
15847/15847 - 4s - loss: 0.0260 - accuracy: 0.9940 - auc_3: 0.9982 - recall_3: 0.9932 - precision_3: 0.9949 - val_loss: 0.0465 - val_accuracy: 0.9934 - val_auc_3: 0.9985 - val_recall_3: 0.9896 - val_precision_3: 0.9969
Epoch 17/30
15847/15847 - 5s - loss: 0.0249 - accuracy: 0.9940 - auc_3: 0.9983 - recall_3: 0.9930 - precision_3: 0.9950 - val_loss: 0.0392 - val_accuracy: 0.9933 - val_auc_3: 0.9979 - val_recall_3: 0.9913 - val_precision_3: 0.9950
Epoch 18/30
15847/15847 - 5s - loss: 0.0246 - accuracy: 0.9941 - auc_3: 0.9984 - recall_3: 0.9932 - precision_3: 0.9951 - val_loss: 0.0790 - val_accuracy: 0.9935 - val_auc_3: 0.9986 - val_recall_3: 0.9898 - val_precision_3: 0.9969
Epoch 19/30
15847/15847 - 5s - loss: 0.0253 - accuracy: 0.9938 - auc_3: 0.9983 - recall_3: 0.9928 - precision_3: 0.9948 - val_loss: 0.0593 - val_accuracy: 0.9926 - val_auc_3: 0.9984 - val_recall_3: 0.9900 - val_precision_3: 0.9950
Epoch 20/30
15847/15847 - 5s - loss: 0.0246 - accuracy: 0.9940 - auc_3: 0.9984 - recall_3: 0.9930 - precision_3: 0.9951 - val_loss: 0.0650 - val_accuracy: 0.9917 - val_auc_3: 0.9984 - val_recall_3: 0.9863 - val_precision_3: 0.9969
Epoch 21/30
15847/15847 - 5s - loss: 0.0256 - accuracy: 0.9938 - auc_3: 0.9985 - recall_3: 0.9929 - precision_3: 0.9947 - val_loss: 0.0314 - val_accuracy: 0.9935 - val_auc_3: 0.9981 - val_recall_3: 0.9912 - val_precision_3: 0.9957
Epoch 22/30
15847/15847 - 5s - loss: 0.0241 - accuracy: 0.9939 - auc_3: 0.9985 - recall_3: 0.9928 - precision_3: 0.9950 - val_loss: 0.0475 - val_accuracy: 0.9936 - val_auc_3: 0.9985 - val_recall_3: 0.9907 - val_precision_3: 0.9962
Epoch 23/30
15847/15847 - 5s - loss: 0.0243 - accuracy: 0.9940 - auc_3: 0.9984 - recall_3: 0.9931 - precision_3: 0.9950 - val_loss: 0.0438 - val_accuracy: 0.9936 - val_auc_3: 0.9983 - val_recall_3: 0.9910 - val_precision_3: 0.9960
Epoch 24/30
15847/15847 - 5s - loss: 0.0241 - accuracy: 0.9941 - auc_3: 0.9985 - recall_3: 0.9928 - precision_3: 0.9953 - val_loss: 0.0507 - val_accuracy: 0.9935 - val_auc_3: 0.9980 - val_recall_3: 0.9909 - val_precision_3: 0.9960
Epoch 25/30
15847/15847 - 5s - loss: 0.0253 - accuracy: 0.9939 - auc_3: 0.9983 - recall_3: 0.9927 - precision_3: 0.9952 - val_loss: 0.0310 - val_accuracy: 0.9936 - val_auc_3: 0.9987 - val_recall_3: 0.9910 - val_precision_3: 0.9960
Epoch 26/30
15847/15847 - 5s - loss: 0.0308 - accuracy: 0.9930 - auc_3: 0.9979 - recall_3: 0.9929 - precision_3: 0.9931 - val_loss: 0.0434 - val_accuracy: 0.9908 - val_auc_3: 0.9984 - val_recall_3: 0.9857 - val_precision_3: 0.9956
Epoch 27/30
15847/15847 - 5s - loss: 0.0266 - accuracy: 0.9936 - auc_3: 0.9981 - recall_3: 0.9937 - precision_3: 0.9935 - val_loss: 0.0684 - val_accuracy: 0.9899 - val_auc_3: 0.9983 - val_recall_3: 0.9826 - val_precision_3: 0.9969
Epoch 28/30
15847/15847 - 5s - loss: 0.0254 - accuracy: 0.9936 - auc_3: 0.9983 - recall_3: 0.9930 - precision_3: 0.9943 - val_loss: 0.2497 - val_accuracy: 0.9257 - val_auc_3: 0.9975 - val_recall_3: 0.8502 - val_precision_3: 0.9989
Epoch 29/30
15847/15847 - 5s - loss: 0.0245 - accuracy: 0.9941 - auc_3: 0.9985 - recall_3: 0.9930 - precision_3: 0.9952 - val_loss: 0.0369 - val_accuracy: 0.9933 - val_auc_3: 0.9985 - val_recall_3: 0.9892 - val_precision_3: 0.9972
Epoch 30/30
15847/15847 - 4s - loss: 0.0239 - accuracy: 0.9941 - auc_3: 0.9985 - recall_3: 0.9930 - precision_3: 0.9953 - val_loss: 0.1014 - val_accuracy: 0.9893 - val_auc_3: 0.9985 - val_recall_3: 0.9805 - val_precision_3: 0.9979
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/tensorflow/python/keras/engine/training.py:2325: UserWarning: `Model.state_updates` will be removed in a future version. This property should not be used in TensorFlow 2.0, as `updates` are applied automatically.
  warnings.warn('`Model.state_updates` will be removed in a future version. '
----------------------------------------
0-th trained seq2seq predict test events
----------------------------------------
proportion of infection events tagged by ps-detector-attack detector:  0.03803449090479565
proportion of infection events tagged by ps-detector-recon detector:  0.7625797306874557
proportion of infection events tagged by ps-detector-infec detector:  0.0517363571934798
proportion of events estimated to be benign :  0.1566265060240964
Permute truncated is False
Use prob embedding is False
---------------------------------------------------
0-th trained per-step detector predict test windows
---------------------------------------------------
retrain_cle_mal_testset_x.shape: (189, 41)
retrain_cle_mal_testset_y.shape: (189,)
retrain_cle_mal_testset_y: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1]
retrain_cle_ben_testset_x.shape: (30, 41)
retrain_cle_ben_testset_y.shape: (30,)
retrain_cle_ben_testset_y: [0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
retrain_cle_testset_x.shape: (219, 41)
retrain_cle_testset_y.shape: (219,)
retrain_cle_testset_y: [1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1
 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0]
--------------------------------------------------------------------
Measureing ps-detector-infec detector performance on clean test data
--------------------------------------------------------------------
kind: 
ps-detector-infec  testset_min:-1.7222021363244926
ps-detector-infec  testset_max:31.46267630066733
Metrics on clean testset: 
 {'auc': 0.6335132573475666, 'accuracy': 0.9534609024332624, 'precision': 0.776255707762557, 'recall': 0.5345911949685535, 'f1': 0.633147113594041, 'fp': 49, 'tp': 170, 'fn': 148, 'tn': 3866, 'auprc': 0.3991735323782755, 'precision99': 0.93, 'recall99': 0.0}
--------------------------------------------------------------------------------------------------------------
Generate only adversarial mailicious exapmples based white-box ps-detector-infec detector with clean test data
--------------------------------------------------------------------------------------------------------------
kind: 
ps-detector-infec  cle_testset_min:-1.7222021363244926
ps-detector-infec  cle_testset_max:31.46267630066733
cle_testset_x.shape: (4233, 41)
cle_testset_y.shape: (4233,)
cle_testset_y[:10]: [0. 0. 0. 0. 0. 0. 0. 0. 0. 0.]
condition.shape: (4233,)
condition[:10]: [False False False False False False False False False False]
malicious_cle_testset_y.shape: (318,)
cond.shape: (4233, 1)
cond.shape: (4233, 41)
malicious_cle_testset_x.shape: (13038,)
malicious_cle_testset_x.shape: (318, 41)
malicious_cle_testset_x.shape: (318, 1, 41)
eps=1.0,eps_step=0.5,max_iter=20
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A2023-05-16 17:54:03.151538: W tensorflow/c/c_api.cc:326] Operation '{name:'lstm_4/while' id:3147 op device:{} def:{{{node lstm_4/while}} = While[T=[DT_INT32, DT_INT32, DT_INT32, DT_VARIANT, DT_FLOAT, DT_FLOAT, DT_INT32, DT_VARIANT, DT_RESOURCE, DT_RESOURCE, DT_RESOURCE, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT, DT_VARIANT], _lower_using_switch_merge=true, _num_original_outputs=45, _read_only_resource_inputs=[8, 9, 10], body=lstm_4_while_body_4870[], cond=lstm_4_while_cond_4869[], output_shapes=[[], [], [], [], [?,128], [?,128], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], [], []], parallel_iterations=32](lstm_4/while/loop_counter, lstm_4/while/maximum_iterations, lstm_4/time, lstm_4/TensorArrayV2_1, lstm_4/zeros, lstm_4/zeros_1, lstm_4/strided_slice_1, lstm_4/TensorArrayUnstack/TensorListFromTensor, lstm_4/lstm_cell_4/kernel, lstm_4/lstm_cell_4/recurrent_kernel, lstm_4/lstm_cell_4/bias, lstm_4/while/EmptyTensorList, lstm_4/while/EmptyTensorList_1, lstm_4/while/EmptyTensorList_2, lstm_4/while/EmptyTensorList_3, lstm_4/while/EmptyTensorList_4, lstm_4/while/EmptyTensorList_5, lstm_4/while/EmptyTensorList_6, lstm_4/while/EmptyTensorList_7, lstm_4/while/EmptyTensorList_8, lstm_4/while/EmptyTensorList_9, lstm_4/while/EmptyTensorList_10, lstm_4/while/EmptyTensorList_11, lstm_4/while/EmptyTensorList_12, lstm_4/while/EmptyTensorList_13, lstm_4/while/EmptyTensorList_14, lstm_4/while/EmptyTensorList_15, lstm_4/while/EmptyTensorList_16, lstm_4/while/EmptyTensorList_17, lstm_4/while/EmptyTensorList_18, lstm_4/while/EmptyTensorList_19, lstm_4/while/EmptyTensorList_20, lstm_4/while/EmptyTensorList_21, lstm_4/while/EmptyTensorList_22, lstm_4/while/EmptyTensorList_23, lstm_4/while/EmptyTensorList_24, lstm_4/while/EmptyTensorList_25, lstm_4/while/EmptyTensorList_26, lstm_4/while/EmptyTensorList_27, lstm_4/while/EmptyTensorList_28, lstm_4/while/EmptyTensorList_29, lstm_4/while/EmptyTensorList_30, lstm_4/while/EmptyTensorList_31, lstm_4/while/EmptyTensorList_32, lstm_4/while/EmptyTensorList_33)}}' was changed by setting attribute after it was run by a session. This mutation will have no effect, and will trigger an error in the future. Either don't modify nodes after running them or create a new session.

PGD - Iterations:   5%|▌         | 1/20 [00:00<00:11,  1.64it/s][A
                                                                [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00,  1.48it/s]PGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00,  1.48it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.39it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.90it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.22it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.31it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.17it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 13.91it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.24it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.73it/s]
PGD - Random Initializations:   0%|          | 0/1 [00:00<?, ?it/s]
PGD - Iterations:   0%|          | 0/20 [00:00<?, ?it/s][A
                                                        [APGD - Random Initializations: 100%|██████████| 1/1 [00:00<00:00, 14.46it/s]
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_ranking.py:1009: UndefinedMetricWarning: No negative samples in y_true, false positive value should be meaningless
  warnings.warn(
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/sklearn/metrics/_classification.py:1334: UndefinedMetricWarning: Precision is ill-defined and being set to 0.0 due to no predicted samples. Use `zero_division` parameter to control this behavior.
  _warn_prf(average, modifier, msg_start, len(result))
/home/huan1932/IoTDataGenerate/data_preprocess/models/lstm.py:197: RuntimeWarning: invalid value encountered in long_scalars
  precision = (tp)/(tp+fp)
adv_testset_x.shape: (318, 1, 41)
adv_testset_y.shape: (318,)
adv_testset_x.shape: (318, 41)
adv_test_examples.shape: (318, 41)
adv_test_labels.shape: (318,)
--------------------------------------------------------------------------
Measureing ps-detector-infec detector performance on adversarial test data
--------------------------------------------------------------------------
kind: 
ps-detector-infec  testset_min:-71.39714050292969
ps-detector-infec  testset_max:990.8682250976562
Metrics on adversarial testset: 
 {'auc': nan, 'accuracy': 0.0, 'precision': nan, 'recall': 0.0, 'f1': nan, 'fp': 0, 'tp': 0, 'fn': 318, 'tn': 0, 'auprc': 1.0, 'precision99': 0.0, 'recall99': 0.0}
--------------------------------------------------------------
0-th trained seq2seq predict adversarial malicious test events
--------------------------------------------------------------
proportion of infection events tagged by ps-detector-attack detector:  0.0031446540880503146
proportion of infection events tagged by ps-detector-recon detector:  0.8459119496855346
proportion of infection events tagged by ps-detector-infec detector:  0.0
proportion of events estimated to be benign :  0.1509433962264151
Permute truncated is False
Use prob embedding is False
-------------------------------------------------------------------------
0-th trained per-step detector predict adversarial malicious test windows
-------------------------------------------------------------------------
preds_detector.shape: (318,)
retrain_adv_mal_testset_x.shape: (0,)
retrain_adv_mal_testset_y.shape: (0,)
retrain_adv_ben_testset_x.shape: (0,)
retrain_adv_ben_testset_y.shape: (0,)
Traceback (most recent call last):
  File "stdtrain-retrain-maggie-20230516.py", line 479, in <module>
    retrain_testset_x = np.concatenate((retrain_cle_testset_x,retrain_adv_mal_testset_x))
  File "<__array_function__ internals>", line 5, in concatenate
ValueError: all the input arrays must have same number of dimensions, but the array at index 0 has 2 dimension(s) and the array at index 1 has 1 dimension(s)
