2023-05-08 00:09:35.848199: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:09:36.454608: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:09:36.455157: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-08 00:09:36.482036: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.482213: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:09:36.482231: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:09:36.484274: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:09:36.484306: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:09:36.499194: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:09:36.499337: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:09:36.500119: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:09:36.500541: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:09:36.500636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:09:36.500721: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.500912: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.501051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:09:36.501244: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-08 00:09:36.502776: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:09:36.502852: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.503001: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:09:36.503016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:09:36.503027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:09:36.503036: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:09:36.503045: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:09:36.503067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:09:36.503077: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:09:36.503085: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:09:36.503094: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:09:36.503134: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.503304: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.503434: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:09:36.503457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:09:36.774284: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-08 00:09:36.774322: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-08 00:09:36.774328: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-08 00:09:36.774547: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.774744: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.774909: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:09:36.775054: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 433 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-08 00:09:36.876224: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-08 00:09:36.876732: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-08 00:09:37.966628: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:09:38.282947: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.285289: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.287906: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.289297: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.290756: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.295194: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.296164: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.297116: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.301670: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.302623: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.304320: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.305758: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.307289: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.308822: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.311966: E tensorflow/stream_executor/cuda/cuda_blas.cc:226] failed to create cublas handle: CUBLAS_STATUS_NOT_INITIALIZED
2023-05-08 00:09:38.312009: W tensorflow/stream_executor/stream.cc:1455] attempting to perform BLAS operation using StreamExecutor without BLAS support
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
Traceback (most recent call last):
  File "relabel_train.py", line 117, in <module>
    detector.learning(features_len, train_examples, train_labels, kind='', epochs=args.ps_epochs, patience=args.patience)
  File "/home/huan1932/IoTDataGenerate/data_preprocess/models/lstm.py", line 93, in learning
    self.classifier[kind].save(f'/home/huan1932/IoTDataGenerate/data_preprocess/result/model/vanilla_{self.get_name()}-{kind}_detector.h5')
AttributeError: 'NoneType' object has no attribute 'save'
2023-05-08 00:16:47.879162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:16:48.487520: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:16:48.488039: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-08 00:16:48.519888: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.520219: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:16:48.520262: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:16:48.522744: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:16:48.522775: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:16:48.537773: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:16:48.537918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:16:48.538702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:16:48.539139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:16:48.539226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:16:48.539310: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.539503: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.539644: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:16:48.539812: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-08 00:16:48.541357: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:16:48.541454: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.541624: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:16:48.541645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:16:48.541660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:16:48.541673: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:16:48.541684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:16:48.541696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:16:48.541707: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:16:48.541718: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:16:48.541730: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:16:48.541780: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.541974: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.542120: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:16:48.542148: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:16:48.815613: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-08 00:16:48.815654: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-08 00:16:48.815660: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-08 00:16:48.815897: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.816109: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.816277: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:16:48.816423: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22414 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-08 00:16:49.038033: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-08 00:16:49.038937: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-08 00:16:50.135178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:16:50.568208: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:16:50.575047: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
539/539 - 5s - loss: 0.1311 - accuracy: 0.9563 - auc: 0.9903 - recall: 0.9600 - precision: 0.9532 - val_loss: 0.0846 - val_accuracy: 0.9687 - val_auc: 0.9949 - val_recall: 0.9904 - val_precision: 0.9478
Epoch 2/50
539/539 - 3s - loss: 0.0634 - accuracy: 0.9757 - auc: 0.9970 - recall: 0.9858 - precision: 0.9664 - val_loss: 0.0724 - val_accuracy: 0.9723 - val_auc: 0.9954 - val_recall: 0.9818 - val_precision: 0.9623
Epoch 3/50
539/539 - 3s - loss: 0.0556 - accuracy: 0.9803 - auc: 0.9974 - recall: 0.9906 - precision: 0.9707 - val_loss: 0.0495 - val_accuracy: 0.9817 - val_auc: 0.9978 - val_recall: 0.9893 - val_precision: 0.9737
Epoch 4/50
539/539 - 3s - loss: 0.0518 - accuracy: 0.9806 - auc: 0.9978 - recall: 0.9902 - precision: 0.9716 - val_loss: 0.0539 - val_accuracy: 0.9786 - val_auc: 0.9981 - val_recall: 0.9829 - val_precision: 0.9735
Epoch 5/50
539/539 - 3s - loss: 0.0501 - accuracy: 0.9814 - auc: 0.9978 - recall: 0.9904 - precision: 0.9729 - val_loss: 0.0440 - val_accuracy: 0.9817 - val_auc: 0.9985 - val_recall: 0.9936 - val_precision: 0.9697
Epoch 6/50
539/539 - 3s - loss: 0.0463 - accuracy: 0.9821 - auc: 0.9983 - recall: 0.9918 - precision: 0.9731 - val_loss: 0.0424 - val_accuracy: 0.9833 - val_auc: 0.9989 - val_recall: 0.9904 - val_precision: 0.9758
Epoch 7/50
539/539 - 3s - loss: 0.0452 - accuracy: 0.9820 - auc: 0.9984 - recall: 0.9910 - precision: 0.9736 - val_loss: 0.0396 - val_accuracy: 0.9864 - val_auc: 0.9989 - val_recall: 0.9925 - val_precision: 0.9799
Epoch 8/50
539/539 - 3s - loss: 0.0448 - accuracy: 0.9828 - auc: 0.9984 - recall: 0.9912 - precision: 0.9748 - val_loss: 0.0416 - val_accuracy: 0.9807 - val_auc: 0.9988 - val_recall: 0.9840 - val_precision: 0.9766
Epoch 9/50
539/539 - 3s - loss: 0.0422 - accuracy: 0.9839 - auc: 0.9985 - recall: 0.9928 - precision: 0.9754 - val_loss: 0.0418 - val_accuracy: 0.9823 - val_auc: 0.9987 - val_recall: 0.9904 - val_precision: 0.9737
Epoch 10/50
539/539 - 3s - loss: 0.0434 - accuracy: 0.9834 - auc: 0.9984 - recall: 0.9927 - precision: 0.9747 - val_loss: 0.0400 - val_accuracy: 0.9859 - val_auc: 0.9989 - val_recall: 0.9914 - val_precision: 0.9799
Epoch 11/50
539/539 - 3s - loss: 0.0418 - accuracy: 0.9839 - auc: 0.9986 - recall: 0.9926 - precision: 0.9758 - val_loss: 0.0434 - val_accuracy: 0.9817 - val_auc: 0.9985 - val_recall: 0.9925 - val_precision: 0.9707
Epoch 12/50
539/539 - 3s - loss: 0.0412 - accuracy: 0.9845 - auc: 0.9985 - recall: 0.9932 - precision: 0.9763 - val_loss: 0.0364 - val_accuracy: 0.9864 - val_auc: 0.9991 - val_recall: 0.9957 - val_precision: 0.9769
Epoch 13/50
539/539 - 3s - loss: 0.0396 - accuracy: 0.9844 - auc: 0.9987 - recall: 0.9927 - precision: 0.9765 - val_loss: 0.0428 - val_accuracy: 0.9823 - val_auc: 0.9987 - val_recall: 0.9904 - val_precision: 0.9737
Epoch 14/50
539/539 - 3s - loss: 0.0388 - accuracy: 0.9845 - auc: 0.9988 - recall: 0.9928 - precision: 0.9767 - val_loss: 0.0415 - val_accuracy: 0.9843 - val_auc: 0.9988 - val_recall: 0.9936 - val_precision: 0.9748
Epoch 15/50
539/539 - 3s - loss: 0.0371 - accuracy: 0.9861 - auc: 0.9988 - recall: 0.9942 - precision: 0.9785 - val_loss: 0.0370 - val_accuracy: 0.9859 - val_auc: 0.9990 - val_recall: 0.9914 - val_precision: 0.9799
Epoch 16/50
539/539 - 3s - loss: 0.0366 - accuracy: 0.9858 - auc: 0.9989 - recall: 0.9933 - precision: 0.9787 - val_loss: 0.0370 - val_accuracy: 0.9864 - val_auc: 0.9989 - val_recall: 0.9904 - val_precision: 0.9820
Epoch 17/50
539/539 - 3s - loss: 0.0359 - accuracy: 0.9866 - auc: 0.9990 - recall: 0.9943 - precision: 0.9793 - val_loss: 0.0526 - val_accuracy: 0.9828 - val_auc: 0.9984 - val_recall: 0.9947 - val_precision: 0.9708
Epoch 18/50
539/539 - 3s - loss: 0.0353 - accuracy: 0.9862 - auc: 0.9989 - recall: 0.9939 - precision: 0.9790 - val_loss: 0.0321 - val_accuracy: 0.9885 - val_auc: 0.9994 - val_recall: 0.9989 - val_precision: 0.9780
Epoch 19/50
539/539 - 3s - loss: 0.0333 - accuracy: 0.9872 - auc: 0.9991 - recall: 0.9953 - precision: 0.9795 - val_loss: 0.0466 - val_accuracy: 0.9828 - val_auc: 0.9981 - val_recall: 0.9861 - val_precision: 0.9788
Epoch 20/50
539/539 - 3s - loss: 0.0331 - accuracy: 0.9872 - auc: 0.9991 - recall: 0.9933 - precision: 0.9815 - val_loss: 0.0344 - val_accuracy: 0.9854 - val_auc: 0.9991 - val_recall: 0.9882 - val_precision: 0.9819
Epoch 21/50
539/539 - 3s - loss: 0.0316 - accuracy: 0.9885 - auc: 0.9992 - recall: 0.9947 - precision: 0.9826 - val_loss: 0.0331 - val_accuracy: 0.9880 - val_auc: 0.9991 - val_recall: 0.9957 - val_precision: 0.9800
Epoch 22/50
539/539 - 3s - loss: 0.0314 - accuracy: 0.9881 - auc: 0.9992 - recall: 0.9943 - precision: 0.9822 - val_loss: 0.0287 - val_accuracy: 0.9880 - val_auc: 0.9994 - val_recall: 0.9904 - val_precision: 0.9851
Epoch 23/50
539/539 - 3s - loss: 0.0328 - accuracy: 0.9879 - auc: 0.9990 - recall: 0.9944 - precision: 0.9817 - val_loss: 0.0348 - val_accuracy: 0.9859 - val_auc: 0.9992 - val_recall: 0.9957 - val_precision: 0.9759
Epoch 24/50
539/539 - 3s - loss: 0.0310 - accuracy: 0.9884 - auc: 0.9993 - recall: 0.9946 - precision: 0.9825 - val_loss: 0.0398 - val_accuracy: 0.9854 - val_auc: 0.9976 - val_recall: 0.9893 - val_precision: 0.9809
Epoch 25/50
539/539 - 3s - loss: 0.0293 - accuracy: 0.9892 - auc: 0.9992 - recall: 0.9943 - precision: 0.9842 - val_loss: 0.0451 - val_accuracy: 0.9859 - val_auc: 0.9979 - val_recall: 0.9968 - val_precision: 0.9749
Epoch 26/50
539/539 - 3s - loss: 0.0303 - accuracy: 0.9884 - auc: 0.9991 - recall: 0.9939 - precision: 0.9832 - val_loss: 0.0296 - val_accuracy: 0.9880 - val_auc: 0.9994 - val_recall: 0.9957 - val_precision: 0.9800
Epoch 27/50
539/539 - 3s - loss: 0.0287 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9953 - precision: 0.9842 - val_loss: 0.0304 - val_accuracy: 0.9870 - val_auc: 0.9994 - val_recall: 0.9925 - val_precision: 0.9810
Epoch 28/50
539/539 - 3s - loss: 0.0282 - accuracy: 0.9903 - auc: 0.9993 - recall: 0.9955 - precision: 0.9852 - val_loss: 0.0393 - val_accuracy: 0.9849 - val_auc: 0.9991 - val_recall: 0.9840 - val_precision: 0.9850
Epoch 29/50
539/539 - 3s - loss: 0.0283 - accuracy: 0.9897 - auc: 0.9993 - recall: 0.9955 - precision: 0.9842 - val_loss: 0.0274 - val_accuracy: 0.9906 - val_auc: 0.9993 - val_recall: 0.9957 - val_precision: 0.9852
Epoch 30/50
539/539 - 3s - loss: 0.0275 - accuracy: 0.9903 - auc: 0.9993 - recall: 0.9950 - precision: 0.9857 - val_loss: 0.0278 - val_accuracy: 0.9880 - val_auc: 0.9995 - val_recall: 0.9914 - val_precision: 0.9841
Epoch 31/50
539/539 - 3s - loss: 0.0285 - accuracy: 0.9894 - auc: 0.9992 - recall: 0.9950 - precision: 0.9840 - val_loss: 0.0363 - val_accuracy: 0.9854 - val_auc: 0.9987 - val_recall: 0.9882 - val_precision: 0.9819
Epoch 32/50
539/539 - 3s - loss: 0.0278 - accuracy: 0.9903 - auc: 0.9993 - recall: 0.9950 - precision: 0.9857 - val_loss: 0.0325 - val_accuracy: 0.9885 - val_auc: 0.9991 - val_recall: 0.9936 - val_precision: 0.9831
Epoch 33/50
539/539 - 3s - loss: 0.0274 - accuracy: 0.9900 - auc: 0.9993 - recall: 0.9946 - precision: 0.9856 - val_loss: 0.0357 - val_accuracy: 0.9906 - val_auc: 0.9983 - val_recall: 0.9957 - val_precision: 0.9852
Epoch 34/50
539/539 - 3s - loss: 0.0276 - accuracy: 0.9902 - auc: 0.9992 - recall: 0.9961 - precision: 0.9846 - val_loss: 0.0447 - val_accuracy: 0.9838 - val_auc: 0.9982 - val_recall: 0.9818 - val_precision: 0.9850
Epoch 35/50
539/539 - 3s - loss: 0.0283 - accuracy: 0.9905 - auc: 0.9991 - recall: 0.9957 - precision: 0.9855 - val_loss: 0.0317 - val_accuracy: 0.9896 - val_auc: 0.9989 - val_recall: 0.9914 - val_precision: 0.9872
Epoch 36/50
539/539 - 3s - loss: 0.0281 - accuracy: 0.9898 - auc: 0.9992 - recall: 0.9950 - precision: 0.9848 - val_loss: 0.0334 - val_accuracy: 0.9922 - val_auc: 0.9989 - val_recall: 0.9989 - val_precision: 0.9852
Epoch 37/50
539/539 - 3s - loss: 0.0262 - accuracy: 0.9908 - auc: 0.9993 - recall: 0.9956 - precision: 0.9862 - val_loss: 0.0334 - val_accuracy: 0.9875 - val_auc: 0.9993 - val_recall: 0.9850 - val_precision: 0.9893
Epoch 38/50
539/539 - 3s - loss: 0.0258 - accuracy: 0.9908 - auc: 0.9992 - recall: 0.9957 - precision: 0.9860 - val_loss: 0.0861 - val_accuracy: 0.9776 - val_auc: 0.9944 - val_recall: 0.9647 - val_precision: 0.9890
Epoch 39/50
539/539 - 3s - loss: 0.0276 - accuracy: 0.9897 - auc: 0.9993 - recall: 0.9947 - precision: 0.9850 - val_loss: 0.0227 - val_accuracy: 0.9906 - val_auc: 0.9997 - val_recall: 1.0000 - val_precision: 0.9811
Epoch 40/50
539/539 - 3s - loss: 0.0239 - accuracy: 0.9918 - auc: 0.9995 - recall: 0.9969 - precision: 0.9868 - val_loss: 0.0250 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9936 - val_precision: 0.9894
Epoch 41/50
539/539 - 3s - loss: 0.0258 - accuracy: 0.9903 - auc: 0.9994 - recall: 0.9953 - precision: 0.9854 - val_loss: 0.0267 - val_accuracy: 0.9890 - val_auc: 0.9991 - val_recall: 0.9904 - val_precision: 0.9872
Epoch 42/50
539/539 - 3s - loss: 0.0264 - accuracy: 0.9902 - auc: 0.9993 - recall: 0.9956 - precision: 0.9850 - val_loss: 0.0259 - val_accuracy: 0.9916 - val_auc: 0.9991 - val_recall: 0.9957 - val_precision: 0.9873
Epoch 43/50
539/539 - 3s - loss: 0.0277 - accuracy: 0.9904 - auc: 0.9991 - recall: 0.9955 - precision: 0.9856 - val_loss: 0.0305 - val_accuracy: 0.9890 - val_auc: 0.9991 - val_recall: 0.9925 - val_precision: 0.9851
Epoch 44/50
539/539 - 3s - loss: 0.0244 - accuracy: 0.9916 - auc: 0.9995 - recall: 0.9966 - precision: 0.9867 - val_loss: 0.0306 - val_accuracy: 0.9901 - val_auc: 0.9990 - val_recall: 0.9925 - val_precision: 0.9872
Epoch 45/50
539/539 - 3s - loss: 0.0255 - accuracy: 0.9908 - auc: 0.9993 - recall: 0.9957 - precision: 0.9860 - val_loss: 0.0254 - val_accuracy: 0.9932 - val_auc: 0.9993 - val_recall: 0.9936 - val_precision: 0.9925
Epoch 46/50
539/539 - 3s - loss: 0.0243 - accuracy: 0.9918 - auc: 0.9994 - recall: 0.9966 - precision: 0.9872 - val_loss: 0.0301 - val_accuracy: 0.9906 - val_auc: 0.9990 - val_recall: 0.9925 - val_precision: 0.9883
Epoch 47/50
539/539 - 3s - loss: 0.0232 - accuracy: 0.9921 - auc: 0.9994 - recall: 0.9964 - precision: 0.9878 - val_loss: 0.0269 - val_accuracy: 0.9911 - val_auc: 0.9992 - val_recall: 0.9957 - val_precision: 0.9862
Epoch 48/50
539/539 - 3s - loss: 0.0233 - accuracy: 0.9917 - auc: 0.9994 - recall: 0.9966 - precision: 0.9869 - val_loss: 0.0233 - val_accuracy: 0.9927 - val_auc: 0.9992 - val_recall: 0.9957 - val_precision: 0.9894
Epoch 49/50
539/539 - 3s - loss: 0.0228 - accuracy: 0.9919 - auc: 0.9994 - recall: 0.9963 - precision: 0.9877 - val_loss: 0.0325 - val_accuracy: 0.9896 - val_auc: 0.9995 - val_recall: 0.9893 - val_precision: 0.9893
Epoch 50/50
539/539 - 3s - loss: 0.0236 - accuracy: 0.9918 - auc: 0.9994 - recall: 0.9956 - precision: 0.9882 - val_loss: 0.0275 - val_accuracy: 0.9932 - val_auc: 0.9991 - val_recall: 0.9989 - val_precision: 0.9873
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
Metrics: 
 {'auc': 0.9321405257848201, 'accuracy': 0.9848806992676589, 'precision': 0.6766467065868264, 'recall': 0.9186991869918699, 'f1': 0.7793103448275861, 'fp': 54, 'tp': 113, 'fn': 10, 'tn': 4056, 'auprc': 0.8996063071876403, 'precision99': 0.97, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
406/406 - 3s - loss: 0.3485 - accuracy: 0.8660 - auc_1: 0.8913 - recall_1: 0.9892 - precision_1: 0.7936 - val_loss: 0.3009 - val_accuracy: 0.8765 - val_auc_1: 0.9033 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 2/50
406/406 - 2s - loss: 0.3003 - accuracy: 0.8772 - auc_1: 0.9012 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2984 - val_accuracy: 0.8765 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 3/50
406/406 - 2s - loss: 0.2987 - accuracy: 0.8772 - auc_1: 0.9026 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2984 - val_accuracy: 0.8772 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 4/50
406/406 - 2s - loss: 0.2980 - accuracy: 0.8772 - auc_1: 0.9054 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2984 - val_accuracy: 0.8765 - val_auc_1: 0.9033 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 5/50
406/406 - 2s - loss: 0.2979 - accuracy: 0.8772 - auc_1: 0.9043 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.3004 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 6/50
406/406 - 2s - loss: 0.2966 - accuracy: 0.8773 - auc_1: 0.9030 - recall_1: 0.9963 - precision_1: 0.8048 - val_loss: 0.2997 - val_accuracy: 0.8765 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 7/50
406/406 - 2s - loss: 0.2957 - accuracy: 0.8777 - auc_1: 0.9020 - recall_1: 0.9969 - precision_1: 0.8050 - val_loss: 0.2984 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 8/50
406/406 - 2s - loss: 0.2956 - accuracy: 0.8778 - auc_1: 0.9027 - recall_1: 0.9972 - precision_1: 0.8050 - val_loss: 0.2973 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 9/50
406/406 - 2s - loss: 0.2948 - accuracy: 0.8779 - auc_1: 0.9040 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2960 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 10/50
406/406 - 2s - loss: 0.2946 - accuracy: 0.8779 - auc_1: 0.9028 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2953 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 11/50
406/406 - 2s - loss: 0.2949 - accuracy: 0.8779 - auc_1: 0.9024 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2991 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 12/50
406/406 - 2s - loss: 0.2947 - accuracy: 0.8780 - auc_1: 0.9019 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2977 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 13/50
406/406 - 2s - loss: 0.2943 - accuracy: 0.8779 - auc_1: 0.9016 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 14/50
406/406 - 2s - loss: 0.2929 - accuracy: 0.8779 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2995 - val_accuracy: 0.8772 - val_auc_1: 0.9031 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 15/50
406/406 - 2s - loss: 0.2933 - accuracy: 0.8780 - auc_1: 0.9042 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2979 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 16/50
406/406 - 2s - loss: 0.2933 - accuracy: 0.8779 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2951 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 17/50
406/406 - 2s - loss: 0.2937 - accuracy: 0.8781 - auc_1: 0.9017 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2958 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 18/50
406/406 - 2s - loss: 0.2936 - accuracy: 0.8776 - auc_1: 0.9043 - recall_1: 0.9972 - precision_1: 0.8047 - val_loss: 0.2972 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 19/50
406/406 - 2s - loss: 0.2923 - accuracy: 0.8779 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2951 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 20/50
406/406 - 2s - loss: 0.2927 - accuracy: 0.8780 - auc_1: 0.9027 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2979 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 21/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8779 - auc_1: 0.9039 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2954 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 22/50
406/406 - 2s - loss: 0.2920 - accuracy: 0.8779 - auc_1: 0.9031 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 23/50
406/406 - 2s - loss: 0.2930 - accuracy: 0.8779 - auc_1: 0.9034 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2943 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 24/50
406/406 - 2s - loss: 0.2922 - accuracy: 0.8776 - auc_1: 0.9028 - recall_1: 0.9972 - precision_1: 0.8048 - val_loss: 0.2944 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 25/50
406/406 - 2s - loss: 0.2927 - accuracy: 0.8779 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2953 - val_accuracy: 0.8772 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 26/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8780 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 27/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8780 - auc_1: 0.9039 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2932 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 28/50
406/406 - 2s - loss: 0.2915 - accuracy: 0.8780 - auc_1: 0.9055 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 29/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8779 - auc_1: 0.9048 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2940 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 30/50
406/406 - 2s - loss: 0.2912 - accuracy: 0.8782 - auc_1: 0.9062 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2969 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 31/50
406/406 - 2s - loss: 0.2917 - accuracy: 0.8779 - auc_1: 0.9027 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2944 - val_accuracy: 0.8772 - val_auc_1: 0.9026 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 32/50
406/406 - 2s - loss: 0.2912 - accuracy: 0.8779 - auc_1: 0.9054 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2943 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 33/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8782 - auc_1: 0.9050 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2940 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 34/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8779 - auc_1: 0.9052 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2969 - val_accuracy: 0.8772 - val_auc_1: 0.9026 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 35/50
406/406 - 2s - loss: 0.2906 - accuracy: 0.8782 - auc_1: 0.9033 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 36/50
406/406 - 2s - loss: 0.2907 - accuracy: 0.8781 - auc_1: 0.9050 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2927 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 37/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8782 - auc_1: 0.9046 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2918 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 38/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8781 - auc_1: 0.9036 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 39/50
406/406 - 2s - loss: 0.2905 - accuracy: 0.8779 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2925 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 40/50
406/406 - 2s - loss: 0.2900 - accuracy: 0.8783 - auc_1: 0.9063 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2942 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 41/50
406/406 - 2s - loss: 0.2903 - accuracy: 0.8782 - auc_1: 0.9026 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2904 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 42/50
406/406 - 2s - loss: 0.2899 - accuracy: 0.8786 - auc_1: 0.9057 - recall_1: 0.9974 - precision_1: 0.8059 - val_loss: 0.2929 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 43/50
406/406 - 2s - loss: 0.2895 - accuracy: 0.8789 - auc_1: 0.9038 - recall_1: 0.9975 - precision_1: 0.8062 - val_loss: 0.2901 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 44/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8782 - auc_1: 0.9054 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2933 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 45/50
406/406 - 2s - loss: 0.2898 - accuracy: 0.8780 - auc_1: 0.9035 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2966 - val_accuracy: 0.8772 - val_auc_1: 0.9041 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 46/50
406/406 - 2s - loss: 0.2896 - accuracy: 0.8783 - auc_1: 0.9069 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2911 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 47/50
406/406 - 2s - loss: 0.2885 - accuracy: 0.8793 - auc_1: 0.9023 - recall_1: 0.9975 - precision_1: 0.8067 - val_loss: 0.2884 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 48/50
406/406 - 2s - loss: 0.2889 - accuracy: 0.8796 - auc_1: 0.9052 - recall_1: 0.9975 - precision_1: 0.8071 - val_loss: 0.2931 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 49/50
406/406 - 2s - loss: 0.2885 - accuracy: 0.8793 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8068 - val_loss: 0.2904 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 50/50
406/406 - 2s - loss: 0.2885 - accuracy: 0.8794 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8070 - val_loss: 0.2896 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.9139735823213417, 'accuracy': 0.9593668792818332, 'precision': 0.9506670803599131, 'recall': 0.9957751056223595, 'f1': 0.9726984126984127, 'fp': 159, 'tp': 3064, 'fn': 13, 'tn': 997, 'auprc': 0.8941543557452801, 'precision99': 0.76, 'recall99': 0.74}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
558/558 - 4s - loss: 0.3813 - accuracy: 0.8533 - auc_2: 0.8955 - recall_2: 0.8027 - precision_2: 0.8933 - val_loss: 0.3113 - val_accuracy: 0.8870 - val_auc_2: 0.9226 - val_recall_2: 0.8169 - val_precision_2: 0.9481
Epoch 2/50
558/558 - 3s - loss: 0.3003 - accuracy: 0.8855 - auc_2: 0.9253 - recall_2: 0.8196 - precision_2: 0.9442 - val_loss: 0.2877 - val_accuracy: 0.8935 - val_auc_2: 0.9284 - val_recall_2: 0.8179 - val_precision_2: 0.9617
Epoch 3/50
558/558 - 3s - loss: 0.2835 - accuracy: 0.8920 - auc_2: 0.9302 - recall_2: 0.8216 - precision_2: 0.9563 - val_loss: 0.2737 - val_accuracy: 0.8946 - val_auc_2: 0.9326 - val_recall_2: 0.8220 - val_precision_2: 0.9596
Epoch 4/50
558/558 - 3s - loss: 0.2796 - accuracy: 0.8927 - auc_2: 0.9323 - recall_2: 0.8218 - precision_2: 0.9579 - val_loss: 0.2721 - val_accuracy: 0.8951 - val_auc_2: 0.9310 - val_recall_2: 0.8260 - val_precision_2: 0.9564
Epoch 5/50
558/558 - 3s - loss: 0.2743 - accuracy: 0.8945 - auc_2: 0.9323 - recall_2: 0.8224 - precision_2: 0.9611 - val_loss: 0.2740 - val_accuracy: 0.8951 - val_auc_2: 0.9323 - val_recall_2: 0.8260 - val_precision_2: 0.9564
Epoch 6/50
558/558 - 3s - loss: 0.2699 - accuracy: 0.8958 - auc_2: 0.9362 - recall_2: 0.8237 - precision_2: 0.9628 - val_loss: 0.2674 - val_accuracy: 0.8981 - val_auc_2: 0.9321 - val_recall_2: 0.8260 - val_precision_2: 0.9632
Epoch 7/50
558/558 - 3s - loss: 0.2676 - accuracy: 0.8964 - auc_2: 0.9355 - recall_2: 0.8228 - precision_2: 0.9652 - val_loss: 0.2622 - val_accuracy: 0.9016 - val_auc_2: 0.9345 - val_recall_2: 0.8250 - val_precision_2: 0.9724
Epoch 8/50
558/558 - 3s - loss: 0.2672 - accuracy: 0.8976 - auc_2: 0.9340 - recall_2: 0.8239 - precision_2: 0.9666 - val_loss: 0.2615 - val_accuracy: 0.8971 - val_auc_2: 0.9342 - val_recall_2: 0.8260 - val_precision_2: 0.9609
Epoch 9/50
558/558 - 3s - loss: 0.2645 - accuracy: 0.8976 - auc_2: 0.9347 - recall_2: 0.8228 - precision_2: 0.9677 - val_loss: 0.2645 - val_accuracy: 0.8956 - val_auc_2: 0.9343 - val_recall_2: 0.8230 - val_precision_2: 0.9608
Epoch 10/50
558/558 - 3s - loss: 0.2625 - accuracy: 0.8984 - auc_2: 0.9358 - recall_2: 0.8241 - precision_2: 0.9681 - val_loss: 0.2601 - val_accuracy: 0.8991 - val_auc_2: 0.9347 - val_recall_2: 0.8260 - val_precision_2: 0.9655
Epoch 11/50
558/558 - 3s - loss: 0.2621 - accuracy: 0.8992 - auc_2: 0.9349 - recall_2: 0.8242 - precision_2: 0.9698 - val_loss: 0.2591 - val_accuracy: 0.9006 - val_auc_2: 0.9356 - val_recall_2: 0.8260 - val_precision_2: 0.9690
Epoch 12/50
558/558 - 3s - loss: 0.2597 - accuracy: 0.8998 - auc_2: 0.9373 - recall_2: 0.8250 - precision_2: 0.9702 - val_loss: 0.2788 - val_accuracy: 0.8961 - val_auc_2: 0.9302 - val_recall_2: 0.8260 - val_precision_2: 0.9587
Epoch 13/50
558/558 - 3s - loss: 0.2595 - accuracy: 0.8996 - auc_2: 0.9366 - recall_2: 0.8240 - precision_2: 0.9710 - val_loss: 0.2654 - val_accuracy: 0.8961 - val_auc_2: 0.9341 - val_recall_2: 0.8250 - val_precision_2: 0.9598
Epoch 14/50
558/558 - 3s - loss: 0.2577 - accuracy: 0.9001 - auc_2: 0.9377 - recall_2: 0.8249 - precision_2: 0.9712 - val_loss: 0.2610 - val_accuracy: 0.8986 - val_auc_2: 0.9356 - val_recall_2: 0.8260 - val_precision_2: 0.9644
Epoch 15/50
558/558 - 3s - loss: 0.2580 - accuracy: 0.9005 - auc_2: 0.9358 - recall_2: 0.8253 - precision_2: 0.9716 - val_loss: 0.2580 - val_accuracy: 0.9016 - val_auc_2: 0.9355 - val_recall_2: 0.8260 - val_precision_2: 0.9713
Epoch 16/50
558/558 - 3s - loss: 0.2552 - accuracy: 0.9007 - auc_2: 0.9381 - recall_2: 0.8252 - precision_2: 0.9722 - val_loss: 0.2567 - val_accuracy: 0.8986 - val_auc_2: 0.9354 - val_recall_2: 0.8149 - val_precision_2: 0.9768
Epoch 17/50
558/558 - 3s - loss: 0.2538 - accuracy: 0.9015 - auc_2: 0.9367 - recall_2: 0.8253 - precision_2: 0.9738 - val_loss: 0.2763 - val_accuracy: 0.8900 - val_auc_2: 0.9333 - val_recall_2: 0.7976 - val_precision_2: 0.9763
Epoch 18/50
558/558 - 3s - loss: 0.2542 - accuracy: 0.9012 - auc_2: 0.9378 - recall_2: 0.8250 - precision_2: 0.9736 - val_loss: 0.2510 - val_accuracy: 0.9036 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9760
Epoch 19/50
558/558 - 3s - loss: 0.2520 - accuracy: 0.9019 - auc_2: 0.9390 - recall_2: 0.8257 - precision_2: 0.9744 - val_loss: 0.2677 - val_accuracy: 0.8996 - val_auc_2: 0.9342 - val_recall_2: 0.8179 - val_precision_2: 0.9757
Epoch 20/50
558/558 - 3s - loss: 0.2549 - accuracy: 0.9012 - auc_2: 0.9372 - recall_2: 0.8246 - precision_2: 0.9739 - val_loss: 0.2650 - val_accuracy: 0.9001 - val_auc_2: 0.9343 - val_recall_2: 0.8210 - val_precision_2: 0.9735
Epoch 21/50
558/558 - 3s - loss: 0.2514 - accuracy: 0.9018 - auc_2: 0.9381 - recall_2: 0.8246 - precision_2: 0.9755 - val_loss: 0.2540 - val_accuracy: 0.9051 - val_auc_2: 0.9365 - val_recall_2: 0.8240 - val_precision_2: 0.9818
Epoch 22/50
558/558 - 3s - loss: 0.2497 - accuracy: 0.9022 - auc_2: 0.9394 - recall_2: 0.8249 - precision_2: 0.9760 - val_loss: 0.2492 - val_accuracy: 0.9057 - val_auc_2: 0.9375 - val_recall_2: 0.8260 - val_precision_2: 0.9807
Epoch 23/50
558/558 - 3s - loss: 0.2504 - accuracy: 0.9023 - auc_2: 0.9382 - recall_2: 0.8257 - precision_2: 0.9754 - val_loss: 0.2593 - val_accuracy: 0.9026 - val_auc_2: 0.9361 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 24/50
558/558 - 3s - loss: 0.2495 - accuracy: 0.9031 - auc_2: 0.9399 - recall_2: 0.8259 - precision_2: 0.9769 - val_loss: 0.2563 - val_accuracy: 0.8996 - val_auc_2: 0.9351 - val_recall_2: 0.8260 - val_precision_2: 0.9667
Epoch 25/50
558/558 - 3s - loss: 0.2484 - accuracy: 0.9032 - auc_2: 0.9401 - recall_2: 0.8255 - precision_2: 0.9777 - val_loss: 0.2503 - val_accuracy: 0.9057 - val_auc_2: 0.9391 - val_recall_2: 0.8230 - val_precision_2: 0.9842
Epoch 26/50
558/558 - 3s - loss: 0.2481 - accuracy: 0.9033 - auc_2: 0.9391 - recall_2: 0.8258 - precision_2: 0.9775 - val_loss: 0.2545 - val_accuracy: 0.9021 - val_auc_2: 0.9364 - val_recall_2: 0.8260 - val_precision_2: 0.9725
Epoch 27/50
558/558 - 3s - loss: 0.2476 - accuracy: 0.9036 - auc_2: 0.9403 - recall_2: 0.8255 - precision_2: 0.9786 - val_loss: 0.2533 - val_accuracy: 0.9041 - val_auc_2: 0.9374 - val_recall_2: 0.8250 - val_precision_2: 0.9783
Epoch 28/50
558/558 - 3s - loss: 0.2479 - accuracy: 0.9041 - auc_2: 0.9401 - recall_2: 0.8268 - precision_2: 0.9783 - val_loss: 0.2759 - val_accuracy: 0.8875 - val_auc_2: 0.9358 - val_recall_2: 0.7904 - val_precision_2: 0.9786
Epoch 29/50
558/558 - 3s - loss: 0.2458 - accuracy: 0.9047 - auc_2: 0.9398 - recall_2: 0.8268 - precision_2: 0.9796 - val_loss: 0.2532 - val_accuracy: 0.9026 - val_auc_2: 0.9371 - val_recall_2: 0.8220 - val_precision_2: 0.9782
Epoch 30/50
558/558 - 3s - loss: 0.2473 - accuracy: 0.9036 - auc_2: 0.9388 - recall_2: 0.8253 - precision_2: 0.9786 - val_loss: 0.2567 - val_accuracy: 0.9036 - val_auc_2: 0.9362 - val_recall_2: 0.8260 - val_precision_2: 0.9760
Epoch 31/50
558/558 - 3s - loss: 0.2461 - accuracy: 0.9046 - auc_2: 0.9387 - recall_2: 0.8270 - precision_2: 0.9790 - val_loss: 0.2515 - val_accuracy: 0.9057 - val_auc_2: 0.9383 - val_recall_2: 0.8250 - val_precision_2: 0.9818
Epoch 32/50
558/558 - 3s - loss: 0.2447 - accuracy: 0.9044 - auc_2: 0.9405 - recall_2: 0.8267 - precision_2: 0.9789 - val_loss: 0.2460 - val_accuracy: 0.9051 - val_auc_2: 0.9383 - val_recall_2: 0.8250 - val_precision_2: 0.9807
Epoch 33/50
558/558 - 3s - loss: 0.2471 - accuracy: 0.9038 - auc_2: 0.9374 - recall_2: 0.8257 - precision_2: 0.9789 - val_loss: 0.2508 - val_accuracy: 0.9062 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 34/50
558/558 - 3s - loss: 0.2454 - accuracy: 0.9045 - auc_2: 0.9408 - recall_2: 0.8267 - precision_2: 0.9792 - val_loss: 0.2484 - val_accuracy: 0.9046 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 35/50
558/558 - 3s - loss: 0.2442 - accuracy: 0.9042 - auc_2: 0.9413 - recall_2: 0.8266 - precision_2: 0.9788 - val_loss: 0.2449 - val_accuracy: 0.9072 - val_auc_2: 0.9381 - val_recall_2: 0.8250 - val_precision_2: 0.9854
Epoch 36/50
558/558 - 3s - loss: 0.2448 - accuracy: 0.9037 - auc_2: 0.9404 - recall_2: 0.8252 - precision_2: 0.9790 - val_loss: 0.2496 - val_accuracy: 0.9062 - val_auc_2: 0.9381 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 37/50
558/558 - 3s - loss: 0.2495 - accuracy: 0.9042 - auc_2: 0.9389 - recall_2: 0.8269 - precision_2: 0.9784 - val_loss: 0.2442 - val_accuracy: 0.9077 - val_auc_2: 0.9384 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 38/50
558/558 - 3s - loss: 0.2443 - accuracy: 0.9048 - auc_2: 0.9401 - recall_2: 0.8268 - precision_2: 0.9798 - val_loss: 0.2563 - val_accuracy: 0.9046 - val_auc_2: 0.9384 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 39/50
558/558 - 3s - loss: 0.2459 - accuracy: 0.9044 - auc_2: 0.9384 - recall_2: 0.8269 - precision_2: 0.9788 - val_loss: 0.2610 - val_accuracy: 0.9041 - val_auc_2: 0.9364 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 40/50
558/558 - 3s - loss: 0.2439 - accuracy: 0.9050 - auc_2: 0.9403 - recall_2: 0.8272 - precision_2: 0.9798 - val_loss: 0.2439 - val_accuracy: 0.9067 - val_auc_2: 0.9386 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 41/50
558/558 - 3s - loss: 0.2442 - accuracy: 0.9041 - auc_2: 0.9408 - recall_2: 0.8278 - precision_2: 0.9770 - val_loss: 0.2476 - val_accuracy: 0.9077 - val_auc_2: 0.9387 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 42/50
558/558 - 3s - loss: 0.2425 - accuracy: 0.9043 - auc_2: 0.9415 - recall_2: 0.8258 - precision_2: 0.9798 - val_loss: 0.2459 - val_accuracy: 0.9062 - val_auc_2: 0.9385 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 43/50
558/558 - 3s - loss: 0.2421 - accuracy: 0.9052 - auc_2: 0.9408 - recall_2: 0.8267 - precision_2: 0.9810 - val_loss: 0.2395 - val_accuracy: 0.9082 - val_auc_2: 0.9398 - val_recall_2: 0.8250 - val_precision_2: 0.9878
Epoch 44/50
558/558 - 3s - loss: 0.2414 - accuracy: 0.9056 - auc_2: 0.9417 - recall_2: 0.8270 - precision_2: 0.9814 - val_loss: 0.2619 - val_accuracy: 0.9041 - val_auc_2: 0.9348 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 45/50
558/558 - 3s - loss: 0.2429 - accuracy: 0.9054 - auc_2: 0.9399 - recall_2: 0.8275 - precision_2: 0.9804 - val_loss: 0.2464 - val_accuracy: 0.9067 - val_auc_2: 0.9382 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 46/50
558/558 - 3s - loss: 0.2410 - accuracy: 0.9056 - auc_2: 0.9415 - recall_2: 0.8274 - precision_2: 0.9811 - val_loss: 0.2452 - val_accuracy: 0.9082 - val_auc_2: 0.9402 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 47/50
558/558 - 3s - loss: 0.2405 - accuracy: 0.9056 - auc_2: 0.9389 - recall_2: 0.8267 - precision_2: 0.9818 - val_loss: 0.2376 - val_accuracy: 0.9087 - val_auc_2: 0.9404 - val_recall_2: 0.8260 - val_precision_2: 0.9878
Epoch 48/50
558/558 - 3s - loss: 0.2407 - accuracy: 0.9050 - auc_2: 0.9397 - recall_2: 0.8271 - precision_2: 0.9800 - val_loss: 0.2385 - val_accuracy: 0.9087 - val_auc_2: 0.9404 - val_recall_2: 0.8260 - val_precision_2: 0.9878
Epoch 49/50
558/558 - 3s - loss: 0.2394 - accuracy: 0.9058 - auc_2: 0.9422 - recall_2: 0.8269 - precision_2: 0.9819 - val_loss: 0.2428 - val_accuracy: 0.9072 - val_auc_2: 0.9390 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 50/50
558/558 - 3s - loss: 0.2383 - accuracy: 0.9060 - auc_2: 0.9429 - recall_2: 0.8275 - precision_2: 0.9819 - val_loss: 0.2520 - val_accuracy: 0.9057 - val_auc_2: 0.9374 - val_recall_2: 0.8260 - val_precision_2: 0.9807
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.6089953974794573, 'accuracy': 0.952752185211434, 'precision': 0.8041237113402062, 'recall': 0.49056603773584906, 'f1': 0.609375, 'fp': 38, 'tp': 156, 'fn': 162, 'tn': 3877, 'auprc': 0.37870522807399265, 'precision99': 0.61, 'recall99': 0.0}
Traceback (most recent call last):
  File "relabel_train.py", line 124, in <module>
    raise Exception("maggie stop here!")
Exception: maggie stop here!
2023-05-08 00:30:44.929304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:30:45.534188: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:30:45.534645: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-08 00:30:45.563512: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.563809: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:30:45.563850: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:30:45.566216: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:30:45.566248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:30:45.581376: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:30:45.581527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:30:45.582325: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:30:45.582763: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:30:45.582861: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:30:45.582947: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.583137: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.583275: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:30:45.583447: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-08 00:30:45.585141: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 00:30:45.585216: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.585361: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 00:30:45.585378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:30:45.585390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:30:45.585400: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:30:45.585409: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 00:30:45.585418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 00:30:45.585427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 00:30:45.585436: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 00:30:45.585444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 00:30:45.585484: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.585649: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.585781: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 00:30:45.585807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 00:30:45.848217: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-08 00:30:45.848255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-08 00:30:45.848261: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-08 00:30:45.848471: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.848673: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.848838: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 00:30:45.848980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22414 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-08 00:30:46.083278: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-08 00:30:46.084152: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-08 00:30:47.173130: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 00:30:47.605137: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 00:30:47.611987: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
539/539 - 5s - loss: 0.1310 - accuracy: 0.9564 - auc: 0.9902 - recall: 0.9602 - precision: 0.9531 - val_loss: 0.0832 - val_accuracy: 0.9687 - val_auc: 0.9949 - val_recall: 0.9904 - val_precision: 0.9478
Epoch 2/50
539/539 - 3s - loss: 0.0636 - accuracy: 0.9755 - auc: 0.9970 - recall: 0.9855 - precision: 0.9662 - val_loss: 0.0715 - val_accuracy: 0.9734 - val_auc: 0.9956 - val_recall: 0.9829 - val_precision: 0.9633
Epoch 3/50
539/539 - 3s - loss: 0.0555 - accuracy: 0.9804 - auc: 0.9974 - recall: 0.9907 - precision: 0.9707 - val_loss: 0.0496 - val_accuracy: 0.9812 - val_auc: 0.9978 - val_recall: 0.9882 - val_precision: 0.9737
Epoch 4/50
539/539 - 3s - loss: 0.0513 - accuracy: 0.9809 - auc: 0.9978 - recall: 0.9905 - precision: 0.9720 - val_loss: 0.0532 - val_accuracy: 0.9791 - val_auc: 0.9980 - val_recall: 0.9818 - val_precision: 0.9756
Epoch 5/50
539/539 - 3s - loss: 0.0495 - accuracy: 0.9814 - auc: 0.9979 - recall: 0.9906 - precision: 0.9728 - val_loss: 0.0443 - val_accuracy: 0.9817 - val_auc: 0.9985 - val_recall: 0.9947 - val_precision: 0.9688
Epoch 6/50
539/539 - 3s - loss: 0.0463 - accuracy: 0.9820 - auc: 0.9982 - recall: 0.9916 - precision: 0.9730 - val_loss: 0.0423 - val_accuracy: 0.9833 - val_auc: 0.9988 - val_recall: 0.9914 - val_precision: 0.9748
Epoch 7/50
539/539 - 3s - loss: 0.0450 - accuracy: 0.9820 - auc: 0.9983 - recall: 0.9914 - precision: 0.9732 - val_loss: 0.0397 - val_accuracy: 0.9864 - val_auc: 0.9989 - val_recall: 0.9925 - val_precision: 0.9799
Epoch 8/50
539/539 - 3s - loss: 0.0447 - accuracy: 0.9828 - auc: 0.9984 - recall: 0.9911 - precision: 0.9750 - val_loss: 0.0417 - val_accuracy: 0.9817 - val_auc: 0.9989 - val_recall: 0.9850 - val_precision: 0.9777
Epoch 9/50
539/539 - 3s - loss: 0.0424 - accuracy: 0.9838 - auc: 0.9986 - recall: 0.9929 - precision: 0.9752 - val_loss: 0.0402 - val_accuracy: 0.9838 - val_auc: 0.9988 - val_recall: 0.9893 - val_precision: 0.9778
Epoch 10/50
539/539 - 3s - loss: 0.0449 - accuracy: 0.9833 - auc: 0.9983 - recall: 0.9925 - precision: 0.9747 - val_loss: 0.0407 - val_accuracy: 0.9859 - val_auc: 0.9988 - val_recall: 0.9914 - val_precision: 0.9799
Epoch 11/50
539/539 - 3s - loss: 0.0421 - accuracy: 0.9837 - auc: 0.9986 - recall: 0.9922 - precision: 0.9756 - val_loss: 0.0432 - val_accuracy: 0.9817 - val_auc: 0.9984 - val_recall: 0.9914 - val_precision: 0.9717
Epoch 12/50
539/539 - 3s - loss: 0.0406 - accuracy: 0.9845 - auc: 0.9986 - recall: 0.9932 - precision: 0.9762 - val_loss: 0.0377 - val_accuracy: 0.9849 - val_auc: 0.9989 - val_recall: 0.9925 - val_precision: 0.9768
Epoch 13/50
539/539 - 3s - loss: 0.0399 - accuracy: 0.9842 - auc: 0.9987 - recall: 0.9922 - precision: 0.9766 - val_loss: 0.0439 - val_accuracy: 0.9843 - val_auc: 0.9985 - val_recall: 0.9914 - val_precision: 0.9768
Epoch 14/50
539/539 - 3s - loss: 0.0392 - accuracy: 0.9844 - auc: 0.9988 - recall: 0.9931 - precision: 0.9762 - val_loss: 0.0407 - val_accuracy: 0.9854 - val_auc: 0.9988 - val_recall: 0.9925 - val_precision: 0.9779
Epoch 15/50
539/539 - 3s - loss: 0.0378 - accuracy: 0.9858 - auc: 0.9988 - recall: 0.9942 - precision: 0.9779 - val_loss: 0.0378 - val_accuracy: 0.9843 - val_auc: 0.9990 - val_recall: 0.9904 - val_precision: 0.9778
Epoch 16/50
539/539 - 3s - loss: 0.0369 - accuracy: 0.9856 - auc: 0.9989 - recall: 0.9931 - precision: 0.9784 - val_loss: 0.0365 - val_accuracy: 0.9880 - val_auc: 0.9989 - val_recall: 0.9968 - val_precision: 0.9790
Epoch 17/50
539/539 - 3s - loss: 0.0361 - accuracy: 0.9860 - auc: 0.9989 - recall: 0.9939 - precision: 0.9785 - val_loss: 0.0493 - val_accuracy: 0.9828 - val_auc: 0.9985 - val_recall: 0.9947 - val_precision: 0.9708
Epoch 18/50
539/539 - 3s - loss: 0.0356 - accuracy: 0.9860 - auc: 0.9990 - recall: 0.9935 - precision: 0.9789 - val_loss: 0.0360 - val_accuracy: 0.9859 - val_auc: 0.9992 - val_recall: 1.0000 - val_precision: 0.9719
Epoch 19/50
539/539 - 3s - loss: 0.0341 - accuracy: 0.9874 - auc: 0.9990 - recall: 0.9958 - precision: 0.9794 - val_loss: 0.0442 - val_accuracy: 0.9833 - val_auc: 0.9983 - val_recall: 0.9861 - val_precision: 0.9798
Epoch 20/50
539/539 - 3s - loss: 0.0337 - accuracy: 0.9869 - auc: 0.9991 - recall: 0.9929 - precision: 0.9811 - val_loss: 0.0330 - val_accuracy: 0.9854 - val_auc: 0.9993 - val_recall: 0.9893 - val_precision: 0.9809
Epoch 21/50
539/539 - 3s - loss: 0.0326 - accuracy: 0.9879 - auc: 0.9991 - recall: 0.9947 - precision: 0.9814 - val_loss: 0.0342 - val_accuracy: 0.9875 - val_auc: 0.9990 - val_recall: 0.9957 - val_precision: 0.9790
Epoch 22/50
539/539 - 3s - loss: 0.0338 - accuracy: 0.9874 - auc: 0.9991 - recall: 0.9953 - precision: 0.9798 - val_loss: 0.0347 - val_accuracy: 0.9859 - val_auc: 0.9991 - val_recall: 0.9850 - val_precision: 0.9861
Epoch 23/50
539/539 - 3s - loss: 0.0323 - accuracy: 0.9879 - auc: 0.9991 - recall: 0.9948 - precision: 0.9814 - val_loss: 0.0341 - val_accuracy: 0.9864 - val_auc: 0.9991 - val_recall: 0.9957 - val_precision: 0.9769
Epoch 24/50
539/539 - 3s - loss: 0.0321 - accuracy: 0.9881 - auc: 0.9992 - recall: 0.9950 - precision: 0.9815 - val_loss: 0.0339 - val_accuracy: 0.9859 - val_auc: 0.9991 - val_recall: 0.9872 - val_precision: 0.9840
Epoch 25/50
539/539 - 3s - loss: 0.0302 - accuracy: 0.9888 - auc: 0.9992 - recall: 0.9947 - precision: 0.9832 - val_loss: 0.0356 - val_accuracy: 0.9875 - val_auc: 0.9992 - val_recall: 0.9989 - val_precision: 0.9760
Epoch 26/50
539/539 - 3s - loss: 0.0315 - accuracy: 0.9880 - auc: 0.9991 - recall: 0.9938 - precision: 0.9825 - val_loss: 0.0349 - val_accuracy: 0.9864 - val_auc: 0.9990 - val_recall: 0.9947 - val_precision: 0.9779
Epoch 27/50
539/539 - 3s - loss: 0.0303 - accuracy: 0.9887 - auc: 0.9992 - recall: 0.9951 - precision: 0.9826 - val_loss: 0.0291 - val_accuracy: 0.9880 - val_auc: 0.9993 - val_recall: 0.9914 - val_precision: 0.9841
Epoch 28/50
539/539 - 3s - loss: 0.0287 - accuracy: 0.9898 - auc: 0.9992 - recall: 0.9951 - precision: 0.9848 - val_loss: 0.0398 - val_accuracy: 0.9843 - val_auc: 0.9990 - val_recall: 0.9850 - val_precision: 0.9829
Epoch 29/50
539/539 - 3s - loss: 0.0313 - accuracy: 0.9887 - auc: 0.9991 - recall: 0.9949 - precision: 0.9827 - val_loss: 0.0291 - val_accuracy: 0.9885 - val_auc: 0.9994 - val_recall: 0.9925 - val_precision: 0.9841
Epoch 30/50
539/539 - 3s - loss: 0.0284 - accuracy: 0.9894 - auc: 0.9993 - recall: 0.9949 - precision: 0.9842 - val_loss: 0.0292 - val_accuracy: 0.9875 - val_auc: 0.9994 - val_recall: 0.9925 - val_precision: 0.9820
Epoch 31/50
539/539 - 3s - loss: 0.0282 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9961 - precision: 0.9834 - val_loss: 0.0300 - val_accuracy: 0.9864 - val_auc: 0.9993 - val_recall: 0.9893 - val_precision: 0.9830
Epoch 32/50
539/539 - 3s - loss: 0.0275 - accuracy: 0.9892 - auc: 0.9993 - recall: 0.9940 - precision: 0.9846 - val_loss: 0.0263 - val_accuracy: 0.9885 - val_auc: 0.9996 - val_recall: 0.9925 - val_precision: 0.9841
Epoch 33/50
539/539 - 3s - loss: 0.0267 - accuracy: 0.9895 - auc: 0.9994 - recall: 0.9953 - precision: 0.9840 - val_loss: 0.0287 - val_accuracy: 0.9906 - val_auc: 0.9993 - val_recall: 0.9936 - val_precision: 0.9872
Epoch 34/50
539/539 - 3s - loss: 0.0267 - accuracy: 0.9900 - auc: 0.9993 - recall: 0.9959 - precision: 0.9842 - val_loss: 0.0383 - val_accuracy: 0.9854 - val_auc: 0.9993 - val_recall: 0.9829 - val_precision: 0.9871
Epoch 35/50
539/539 - 3s - loss: 0.0273 - accuracy: 0.9908 - auc: 0.9993 - recall: 0.9969 - precision: 0.9849 - val_loss: 0.0272 - val_accuracy: 0.9870 - val_auc: 0.9995 - val_recall: 0.9914 - val_precision: 0.9820
Epoch 36/50
539/539 - 3s - loss: 0.0268 - accuracy: 0.9901 - auc: 0.9993 - recall: 0.9955 - precision: 0.9849 - val_loss: 0.0290 - val_accuracy: 0.9906 - val_auc: 0.9989 - val_recall: 0.9989 - val_precision: 0.9821
Epoch 37/50
539/539 - 3s - loss: 0.0259 - accuracy: 0.9904 - auc: 0.9995 - recall: 0.9951 - precision: 0.9858 - val_loss: 0.0329 - val_accuracy: 0.9870 - val_auc: 0.9993 - val_recall: 0.9861 - val_precision: 0.9872
Epoch 38/50
539/539 - 3s - loss: 0.0271 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9947 - precision: 0.9848 - val_loss: 0.0257 - val_accuracy: 0.9901 - val_auc: 0.9995 - val_recall: 1.0000 - val_precision: 0.9801
Epoch 39/50
539/539 - 3s - loss: 0.0277 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9955 - precision: 0.9840 - val_loss: 0.0229 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9989 - val_precision: 0.9842
Epoch 40/50
539/539 - 3s - loss: 0.0231 - accuracy: 0.9914 - auc: 0.9996 - recall: 0.9962 - precision: 0.9867 - val_loss: 0.0234 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9957 - val_precision: 0.9873
Epoch 41/50
539/539 - 3s - loss: 0.0250 - accuracy: 0.9897 - auc: 0.9995 - recall: 0.9949 - precision: 0.9847 - val_loss: 0.0255 - val_accuracy: 0.9885 - val_auc: 0.9996 - val_recall: 0.9893 - val_precision: 0.9872
Epoch 42/50
539/539 - 3s - loss: 0.0255 - accuracy: 0.9901 - auc: 0.9994 - recall: 0.9955 - precision: 0.9849 - val_loss: 0.0235 - val_accuracy: 0.9906 - val_auc: 0.9996 - val_recall: 0.9968 - val_precision: 0.9842
Epoch 43/50
539/539 - 3s - loss: 0.0258 - accuracy: 0.9904 - auc: 0.9993 - recall: 0.9949 - precision: 0.9860 - val_loss: 0.0249 - val_accuracy: 0.9880 - val_auc: 0.9996 - val_recall: 0.9925 - val_precision: 0.9831
Epoch 44/50
539/539 - 3s - loss: 0.0263 - accuracy: 0.9896 - auc: 0.9994 - recall: 0.9948 - precision: 0.9845 - val_loss: 0.0269 - val_accuracy: 0.9901 - val_auc: 0.9993 - val_recall: 0.9925 - val_precision: 0.9872
Epoch 45/50
539/539 - 3s - loss: 0.0241 - accuracy: 0.9913 - auc: 0.9994 - recall: 0.9963 - precision: 0.9865 - val_loss: 0.0210 - val_accuracy: 0.9911 - val_auc: 0.9998 - val_recall: 0.9914 - val_precision: 0.9904
Epoch 46/50
539/539 - 3s - loss: 0.0234 - accuracy: 0.9912 - auc: 0.9995 - recall: 0.9964 - precision: 0.9863 - val_loss: 0.0283 - val_accuracy: 0.9875 - val_auc: 0.9995 - val_recall: 0.9872 - val_precision: 0.9872
Epoch 47/50
539/539 - 3s - loss: 0.0238 - accuracy: 0.9918 - auc: 0.9994 - recall: 0.9963 - precision: 0.9874 - val_loss: 0.0269 - val_accuracy: 0.9875 - val_auc: 0.9995 - val_recall: 0.9936 - val_precision: 0.9810
Epoch 48/50
539/539 - 3s - loss: 0.0223 - accuracy: 0.9918 - auc: 0.9996 - recall: 0.9966 - precision: 0.9870 - val_loss: 0.0202 - val_accuracy: 0.9937 - val_auc: 0.9997 - val_recall: 0.9989 - val_precision: 0.9884
Epoch 49/50
539/539 - 3s - loss: 0.0227 - accuracy: 0.9914 - auc: 0.9995 - recall: 0.9956 - precision: 0.9874 - val_loss: 0.0368 - val_accuracy: 0.9870 - val_auc: 0.9984 - val_recall: 0.9861 - val_precision: 0.9872
Epoch 50/50
539/539 - 3s - loss: 0.0218 - accuracy: 0.9920 - auc: 0.9995 - recall: 0.9965 - precision: 0.9876 - val_loss: 0.0186 - val_accuracy: 0.9937 - val_auc: 0.9997 - val_recall: 0.9957 - val_precision: 0.9915
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
Metrics: 
 {'auc': 0.9342709631475875, 'accuracy': 0.984644460193716, 'precision': 0.6726190476190477, 'recall': 0.9186991869918699, 'f1': 0.7766323024054983, 'fp': 55, 'tp': 113, 'fn': 10, 'tn': 4055, 'auprc': 0.9137830072909074, 'precision99': 0.99, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
406/406 - 3s - loss: 0.3485 - accuracy: 0.8660 - auc_1: 0.8913 - recall_1: 0.9892 - precision_1: 0.7936 - val_loss: 0.3009 - val_accuracy: 0.8765 - val_auc_1: 0.9033 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 2/50
406/406 - 2s - loss: 0.3004 - accuracy: 0.8772 - auc_1: 0.9013 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2985 - val_accuracy: 0.8765 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 3/50
406/406 - 2s - loss: 0.2988 - accuracy: 0.8772 - auc_1: 0.9026 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2983 - val_accuracy: 0.8772 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 4/50
406/406 - 2s - loss: 0.2979 - accuracy: 0.8772 - auc_1: 0.9051 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2983 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 5/50
406/406 - 2s - loss: 0.2975 - accuracy: 0.8772 - auc_1: 0.9046 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.3007 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 6/50
406/406 - 2s - loss: 0.2965 - accuracy: 0.8775 - auc_1: 0.9029 - recall_1: 0.9966 - precision_1: 0.8049 - val_loss: 0.2997 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 7/50
406/406 - 2s - loss: 0.2959 - accuracy: 0.8777 - auc_1: 0.9018 - recall_1: 0.9969 - precision_1: 0.8050 - val_loss: 0.2983 - val_accuracy: 0.8765 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 8/50
406/406 - 2s - loss: 0.2958 - accuracy: 0.8778 - auc_1: 0.9019 - recall_1: 0.9972 - precision_1: 0.8050 - val_loss: 0.2972 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 9/50
406/406 - 2s - loss: 0.2949 - accuracy: 0.8779 - auc_1: 0.9036 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2965 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 10/50
406/406 - 2s - loss: 0.2946 - accuracy: 0.8779 - auc_1: 0.9026 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2953 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 11/50
406/406 - 2s - loss: 0.2945 - accuracy: 0.8779 - auc_1: 0.9026 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2986 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 12/50
406/406 - 2s - loss: 0.2944 - accuracy: 0.8779 - auc_1: 0.9031 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2965 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 13/50
406/406 - 2s - loss: 0.2939 - accuracy: 0.8779 - auc_1: 0.9015 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9034 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 14/50
406/406 - 2s - loss: 0.2929 - accuracy: 0.8780 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2996 - val_accuracy: 0.8772 - val_auc_1: 0.9031 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 15/50
406/406 - 2s - loss: 0.2936 - accuracy: 0.8779 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2984 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 16/50
406/406 - 2s - loss: 0.2933 - accuracy: 0.8779 - auc_1: 0.9032 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2960 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 17/50
406/406 - 2s - loss: 0.2933 - accuracy: 0.8779 - auc_1: 0.9019 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 18/50
406/406 - 2s - loss: 0.2923 - accuracy: 0.8779 - auc_1: 0.9045 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2971 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 19/50
406/406 - 2s - loss: 0.2923 - accuracy: 0.8779 - auc_1: 0.9044 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2950 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 20/50
406/406 - 2s - loss: 0.2926 - accuracy: 0.8779 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2983 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 21/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8780 - auc_1: 0.9037 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2948 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 22/50
406/406 - 2s - loss: 0.2919 - accuracy: 0.8780 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2955 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 23/50
406/406 - 2s - loss: 0.2928 - accuracy: 0.8779 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2950 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 24/50
406/406 - 2s - loss: 0.2922 - accuracy: 0.8779 - auc_1: 0.9025 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2949 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 25/50
406/406 - 2s - loss: 0.2926 - accuracy: 0.8779 - auc_1: 0.9035 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 26/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8779 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2969 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 27/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8780 - auc_1: 0.9034 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2929 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 28/50
406/406 - 2s - loss: 0.2917 - accuracy: 0.8780 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2939 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 29/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8779 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2942 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 30/50
406/406 - 2s - loss: 0.2913 - accuracy: 0.8780 - auc_1: 0.9058 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2960 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 31/50
406/406 - 2s - loss: 0.2913 - accuracy: 0.8779 - auc_1: 0.9031 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2941 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 32/50
406/406 - 2s - loss: 0.2905 - accuracy: 0.8782 - auc_1: 0.9059 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2928 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 33/50
406/406 - 2s - loss: 0.2904 - accuracy: 0.8782 - auc_1: 0.9056 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2938 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 34/50
406/406 - 2s - loss: 0.2912 - accuracy: 0.8779 - auc_1: 0.9056 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2973 - val_accuracy: 0.8772 - val_auc_1: 0.9044 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 35/50
406/406 - 2s - loss: 0.2905 - accuracy: 0.8782 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 36/50
406/406 - 2s - loss: 0.2910 - accuracy: 0.8782 - auc_1: 0.9041 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2950 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 37/50
406/406 - 2s - loss: 0.2906 - accuracy: 0.8782 - auc_1: 0.9033 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2910 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 38/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8782 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2942 - val_accuracy: 0.8772 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 39/50
406/406 - 2s - loss: 0.2899 - accuracy: 0.8782 - auc_1: 0.9040 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2908 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 40/50
406/406 - 2s - loss: 0.2893 - accuracy: 0.8790 - auc_1: 0.9057 - recall_1: 0.9974 - precision_1: 0.8065 - val_loss: 0.2942 - val_accuracy: 0.8772 - val_auc_1: 0.9041 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 41/50
406/406 - 2s - loss: 0.2905 - accuracy: 0.8783 - auc_1: 0.9039 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2904 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 42/50
406/406 - 2s - loss: 0.2892 - accuracy: 0.8789 - auc_1: 0.9063 - recall_1: 0.9974 - precision_1: 0.8064 - val_loss: 0.2927 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 43/50
406/406 - 2s - loss: 0.2900 - accuracy: 0.8786 - auc_1: 0.9041 - recall_1: 0.9974 - precision_1: 0.8059 - val_loss: 0.2936 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 44/50
406/406 - 2s - loss: 0.2898 - accuracy: 0.8782 - auc_1: 0.9051 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2929 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 45/50
406/406 - 2s - loss: 0.2888 - accuracy: 0.8794 - auc_1: 0.9031 - recall_1: 0.9974 - precision_1: 0.8070 - val_loss: 0.2945 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 46/50
406/406 - 2s - loss: 0.2907 - accuracy: 0.8782 - auc_1: 0.9042 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2933 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 47/50
406/406 - 2s - loss: 0.2894 - accuracy: 0.8785 - auc_1: 0.9022 - recall_1: 0.9974 - precision_1: 0.8058 - val_loss: 0.2890 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 48/50
406/406 - 2s - loss: 0.2890 - accuracy: 0.8796 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8072 - val_loss: 0.2933 - val_accuracy: 0.8772 - val_auc_1: 0.9045 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 49/50
406/406 - 2s - loss: 0.2886 - accuracy: 0.8791 - auc_1: 0.9042 - recall_1: 0.9972 - precision_1: 0.8067 - val_loss: 0.2928 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 50/50
406/406 - 2s - loss: 0.2888 - accuracy: 0.8791 - auc_1: 0.9016 - recall_1: 0.9975 - precision_1: 0.8065 - val_loss: 0.2893 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.9303269148375097, 'accuracy': 0.9648003779825183, 'precision': 0.9575, 'recall': 0.9957751056223595, 'f1': 0.9762625458021349, 'fp': 136, 'tp': 3064, 'fn': 13, 'tn': 1020, 'auprc': 0.9207334072378356, 'precision99': 0.75, 'recall99': 0.76}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
558/558 - 4s - loss: 0.3814 - accuracy: 0.8531 - auc_2: 0.8954 - recall_2: 0.8025 - precision_2: 0.8931 - val_loss: 0.3100 - val_accuracy: 0.8870 - val_auc_2: 0.9228 - val_recall_2: 0.8179 - val_precision_2: 0.9470
Epoch 2/50
558/558 - 3s - loss: 0.3007 - accuracy: 0.8859 - auc_2: 0.9251 - recall_2: 0.8201 - precision_2: 0.9446 - val_loss: 0.2869 - val_accuracy: 0.8935 - val_auc_2: 0.9294 - val_recall_2: 0.8189 - val_precision_2: 0.9606
Epoch 3/50
558/558 - 3s - loss: 0.2836 - accuracy: 0.8920 - auc_2: 0.9303 - recall_2: 0.8220 - precision_2: 0.9561 - val_loss: 0.2730 - val_accuracy: 0.8956 - val_auc_2: 0.9320 - val_recall_2: 0.8250 - val_precision_2: 0.9586
Epoch 4/50
558/558 - 3s - loss: 0.2794 - accuracy: 0.8926 - auc_2: 0.9325 - recall_2: 0.8218 - precision_2: 0.9576 - val_loss: 0.2721 - val_accuracy: 0.8956 - val_auc_2: 0.9309 - val_recall_2: 0.8260 - val_precision_2: 0.9575
Epoch 5/50
558/558 - 3s - loss: 0.2742 - accuracy: 0.8943 - auc_2: 0.9321 - recall_2: 0.8220 - precision_2: 0.9611 - val_loss: 0.2714 - val_accuracy: 0.8951 - val_auc_2: 0.9325 - val_recall_2: 0.8260 - val_precision_2: 0.9564
Epoch 6/50
558/558 - 3s - loss: 0.2701 - accuracy: 0.8958 - auc_2: 0.9364 - recall_2: 0.8232 - precision_2: 0.9632 - val_loss: 0.2679 - val_accuracy: 0.8971 - val_auc_2: 0.9319 - val_recall_2: 0.8260 - val_precision_2: 0.9609
Epoch 7/50
558/558 - 3s - loss: 0.2670 - accuracy: 0.8966 - auc_2: 0.9356 - recall_2: 0.8229 - precision_2: 0.9653 - val_loss: 0.2623 - val_accuracy: 0.9031 - val_auc_2: 0.9339 - val_recall_2: 0.8250 - val_precision_2: 0.9759
Epoch 8/50
558/558 - 3s - loss: 0.2672 - accuracy: 0.8974 - auc_2: 0.9341 - recall_2: 0.8234 - precision_2: 0.9666 - val_loss: 0.2610 - val_accuracy: 0.8986 - val_auc_2: 0.9346 - val_recall_2: 0.8260 - val_precision_2: 0.9644
Epoch 9/50
558/558 - 3s - loss: 0.2643 - accuracy: 0.8974 - auc_2: 0.9346 - recall_2: 0.8228 - precision_2: 0.9673 - val_loss: 0.2637 - val_accuracy: 0.8961 - val_auc_2: 0.9347 - val_recall_2: 0.8230 - val_precision_2: 0.9620
Epoch 10/50
558/558 - 3s - loss: 0.2628 - accuracy: 0.8982 - auc_2: 0.9358 - recall_2: 0.8238 - precision_2: 0.9681 - val_loss: 0.2585 - val_accuracy: 0.8991 - val_auc_2: 0.9349 - val_recall_2: 0.8260 - val_precision_2: 0.9655
Epoch 11/50
558/558 - 3s - loss: 0.2618 - accuracy: 0.8996 - auc_2: 0.9351 - recall_2: 0.8242 - precision_2: 0.9708 - val_loss: 0.2589 - val_accuracy: 0.9001 - val_auc_2: 0.9353 - val_recall_2: 0.8260 - val_precision_2: 0.9678
Epoch 12/50
558/558 - 3s - loss: 0.2596 - accuracy: 0.8997 - auc_2: 0.9374 - recall_2: 0.8247 - precision_2: 0.9705 - val_loss: 0.2761 - val_accuracy: 0.8971 - val_auc_2: 0.9309 - val_recall_2: 0.8260 - val_precision_2: 0.9609
Epoch 13/50
558/558 - 3s - loss: 0.2592 - accuracy: 0.8998 - auc_2: 0.9370 - recall_2: 0.8243 - precision_2: 0.9710 - val_loss: 0.2666 - val_accuracy: 0.8966 - val_auc_2: 0.9339 - val_recall_2: 0.8250 - val_precision_2: 0.9609
Epoch 14/50
558/558 - 3s - loss: 0.2574 - accuracy: 0.9005 - auc_2: 0.9375 - recall_2: 0.8252 - precision_2: 0.9718 - val_loss: 0.2591 - val_accuracy: 0.9001 - val_auc_2: 0.9354 - val_recall_2: 0.8260 - val_precision_2: 0.9678
Epoch 15/50
558/558 - 3s - loss: 0.2562 - accuracy: 0.9012 - auc_2: 0.9365 - recall_2: 0.8253 - precision_2: 0.9732 - val_loss: 0.2567 - val_accuracy: 0.9026 - val_auc_2: 0.9353 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 16/50
558/558 - 3s - loss: 0.2547 - accuracy: 0.9008 - auc_2: 0.9381 - recall_2: 0.8251 - precision_2: 0.9725 - val_loss: 0.2567 - val_accuracy: 0.8986 - val_auc_2: 0.9352 - val_recall_2: 0.8149 - val_precision_2: 0.9768
Epoch 17/50
558/558 - 3s - loss: 0.2532 - accuracy: 0.9021 - auc_2: 0.9370 - recall_2: 0.8258 - precision_2: 0.9747 - val_loss: 0.2845 - val_accuracy: 0.8840 - val_auc_2: 0.9283 - val_recall_2: 0.7843 - val_precision_2: 0.9772
Epoch 18/50
558/558 - 3s - loss: 0.2534 - accuracy: 0.9018 - auc_2: 0.9377 - recall_2: 0.8256 - precision_2: 0.9742 - val_loss: 0.2532 - val_accuracy: 0.9051 - val_auc_2: 0.9375 - val_recall_2: 0.8260 - val_precision_2: 0.9795
Epoch 19/50
558/558 - 3s - loss: 0.2518 - accuracy: 0.9019 - auc_2: 0.9392 - recall_2: 0.8255 - precision_2: 0.9747 - val_loss: 0.2670 - val_accuracy: 0.8996 - val_auc_2: 0.9349 - val_recall_2: 0.8189 - val_precision_2: 0.9746
Epoch 20/50
558/558 - 3s - loss: 0.2548 - accuracy: 0.9015 - auc_2: 0.9367 - recall_2: 0.8248 - precision_2: 0.9746 - val_loss: 0.2562 - val_accuracy: 0.9031 - val_auc_2: 0.9371 - val_recall_2: 0.8230 - val_precision_2: 0.9782
Epoch 21/50
558/558 - 3s - loss: 0.2507 - accuracy: 0.9015 - auc_2: 0.9386 - recall_2: 0.8244 - precision_2: 0.9748 - val_loss: 0.2538 - val_accuracy: 0.9057 - val_auc_2: 0.9363 - val_recall_2: 0.8250 - val_precision_2: 0.9818
Epoch 22/50
558/558 - 3s - loss: 0.2489 - accuracy: 0.9024 - auc_2: 0.9400 - recall_2: 0.8247 - precision_2: 0.9766 - val_loss: 0.2498 - val_accuracy: 0.9046 - val_auc_2: 0.9374 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 23/50
558/558 - 3s - loss: 0.2493 - accuracy: 0.9023 - auc_2: 0.9385 - recall_2: 0.8255 - precision_2: 0.9755 - val_loss: 0.2598 - val_accuracy: 0.9031 - val_auc_2: 0.9365 - val_recall_2: 0.8260 - val_precision_2: 0.9748
Epoch 24/50
558/558 - 3s - loss: 0.2496 - accuracy: 0.9030 - auc_2: 0.9395 - recall_2: 0.8255 - precision_2: 0.9772 - val_loss: 0.2538 - val_accuracy: 0.9031 - val_auc_2: 0.9352 - val_recall_2: 0.8260 - val_precision_2: 0.9748
Epoch 25/50
558/558 - 3s - loss: 0.2472 - accuracy: 0.9035 - auc_2: 0.9407 - recall_2: 0.8257 - precision_2: 0.9781 - val_loss: 0.2486 - val_accuracy: 0.9041 - val_auc_2: 0.9383 - val_recall_2: 0.8210 - val_precision_2: 0.9829
Epoch 26/50
558/558 - 3s - loss: 0.2476 - accuracy: 0.9035 - auc_2: 0.9395 - recall_2: 0.8253 - precision_2: 0.9784 - val_loss: 0.2553 - val_accuracy: 0.9026 - val_auc_2: 0.9368 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 27/50
558/558 - 3s - loss: 0.2466 - accuracy: 0.9040 - auc_2: 0.9404 - recall_2: 0.8258 - precision_2: 0.9791 - val_loss: 0.2558 - val_accuracy: 0.9041 - val_auc_2: 0.9371 - val_recall_2: 0.8250 - val_precision_2: 0.9783
Epoch 28/50
558/558 - 3s - loss: 0.2471 - accuracy: 0.9043 - auc_2: 0.9402 - recall_2: 0.8267 - precision_2: 0.9788 - val_loss: 0.2680 - val_accuracy: 0.8925 - val_auc_2: 0.9376 - val_recall_2: 0.7965 - val_precision_2: 0.9837
Epoch 29/50
558/558 - 3s - loss: 0.2449 - accuracy: 0.9050 - auc_2: 0.9404 - recall_2: 0.8270 - precision_2: 0.9800 - val_loss: 0.2524 - val_accuracy: 0.9021 - val_auc_2: 0.9368 - val_recall_2: 0.8220 - val_precision_2: 0.9770
Epoch 30/50
558/558 - 3s - loss: 0.2456 - accuracy: 0.9042 - auc_2: 0.9391 - recall_2: 0.8262 - precision_2: 0.9792 - val_loss: 0.2475 - val_accuracy: 0.9057 - val_auc_2: 0.9381 - val_recall_2: 0.8260 - val_precision_2: 0.9807
Epoch 31/50
558/558 - 3s - loss: 0.2453 - accuracy: 0.9046 - auc_2: 0.9391 - recall_2: 0.8270 - precision_2: 0.9790 - val_loss: 0.2473 - val_accuracy: 0.9067 - val_auc_2: 0.9385 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 32/50
558/558 - 3s - loss: 0.2446 - accuracy: 0.9046 - auc_2: 0.9403 - recall_2: 0.8268 - precision_2: 0.9794 - val_loss: 0.2499 - val_accuracy: 0.9051 - val_auc_2: 0.9377 - val_recall_2: 0.8260 - val_precision_2: 0.9795
Epoch 33/50
558/558 - 3s - loss: 0.2464 - accuracy: 0.9044 - auc_2: 0.9380 - recall_2: 0.8265 - precision_2: 0.9792 - val_loss: 0.2461 - val_accuracy: 0.9067 - val_auc_2: 0.9386 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 34/50
558/558 - 3s - loss: 0.2447 - accuracy: 0.9048 - auc_2: 0.9410 - recall_2: 0.8265 - precision_2: 0.9802 - val_loss: 0.2477 - val_accuracy: 0.9067 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 35/50
558/558 - 3s - loss: 0.2440 - accuracy: 0.9045 - auc_2: 0.9414 - recall_2: 0.8267 - precision_2: 0.9792 - val_loss: 0.2452 - val_accuracy: 0.9067 - val_auc_2: 0.9385 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 36/50
558/558 - 3s - loss: 0.2438 - accuracy: 0.9047 - auc_2: 0.9411 - recall_2: 0.8262 - precision_2: 0.9803 - val_loss: 0.2493 - val_accuracy: 0.9046 - val_auc_2: 0.9377 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 37/50
558/558 - 3s - loss: 0.2425 - accuracy: 0.9051 - auc_2: 0.9405 - recall_2: 0.8270 - precision_2: 0.9803 - val_loss: 0.2466 - val_accuracy: 0.9072 - val_auc_2: 0.9388 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 38/50
558/558 - 3s - loss: 0.2431 - accuracy: 0.9051 - auc_2: 0.9407 - recall_2: 0.8265 - precision_2: 0.9810 - val_loss: 0.2546 - val_accuracy: 0.9046 - val_auc_2: 0.9383 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 39/50
558/558 - 3s - loss: 0.2442 - accuracy: 0.9045 - auc_2: 0.9388 - recall_2: 0.8260 - precision_2: 0.9801 - val_loss: 0.2501 - val_accuracy: 0.9067 - val_auc_2: 0.9375 - val_recall_2: 0.8250 - val_precision_2: 0.9842
Epoch 40/50
558/558 - 3s - loss: 0.2422 - accuracy: 0.9058 - auc_2: 0.9405 - recall_2: 0.8276 - precision_2: 0.9811 - val_loss: 0.2449 - val_accuracy: 0.9051 - val_auc_2: 0.9384 - val_recall_2: 0.8250 - val_precision_2: 0.9807
Epoch 41/50
558/558 - 3s - loss: 0.2417 - accuracy: 0.9052 - auc_2: 0.9411 - recall_2: 0.8274 - precision_2: 0.9801 - val_loss: 0.2441 - val_accuracy: 0.9072 - val_auc_2: 0.9389 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 42/50
558/558 - 3s - loss: 0.2424 - accuracy: 0.9050 - auc_2: 0.9416 - recall_2: 0.8261 - precision_2: 0.9810 - val_loss: 0.2448 - val_accuracy: 0.9072 - val_auc_2: 0.9375 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 43/50
558/558 - 3s - loss: 0.2408 - accuracy: 0.9058 - auc_2: 0.9415 - recall_2: 0.8274 - precision_2: 0.9815 - val_loss: 0.2434 - val_accuracy: 0.9062 - val_auc_2: 0.9387 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 44/50
558/558 - 3s - loss: 0.2408 - accuracy: 0.9059 - auc_2: 0.9419 - recall_2: 0.8275 - precision_2: 0.9817 - val_loss: 0.2599 - val_accuracy: 0.9072 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 45/50
558/558 - 3s - loss: 0.2438 - accuracy: 0.9051 - auc_2: 0.9393 - recall_2: 0.8270 - precision_2: 0.9802 - val_loss: 0.2430 - val_accuracy: 0.9082 - val_auc_2: 0.9392 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 46/50
558/558 - 3s - loss: 0.2393 - accuracy: 0.9064 - auc_2: 0.9418 - recall_2: 0.8277 - precision_2: 0.9824 - val_loss: 0.2440 - val_accuracy: 0.9082 - val_auc_2: 0.9397 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 47/50
558/558 - 3s - loss: 0.2431 - accuracy: 0.9049 - auc_2: 0.9388 - recall_2: 0.8266 - precision_2: 0.9803 - val_loss: 0.2406 - val_accuracy: 0.9082 - val_auc_2: 0.9395 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 48/50
558/558 - 3s - loss: 0.2412 - accuracy: 0.9059 - auc_2: 0.9395 - recall_2: 0.8276 - precision_2: 0.9815 - val_loss: 0.2415 - val_accuracy: 0.9082 - val_auc_2: 0.9396 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 49/50
558/558 - 3s - loss: 0.2400 - accuracy: 0.9058 - auc_2: 0.9423 - recall_2: 0.8269 - precision_2: 0.9819 - val_loss: 0.2509 - val_accuracy: 0.9072 - val_auc_2: 0.9382 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 50/50
558/558 - 3s - loss: 0.2400 - accuracy: 0.9056 - auc_2: 0.9429 - recall_2: 0.8269 - precision_2: 0.9816 - val_loss: 0.2538 - val_accuracy: 0.9057 - val_auc_2: 0.9370 - val_recall_2: 0.8260 - val_precision_2: 0.9807
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
Metrics: 
 {'auc': 0.6082556206173643, 'accuracy': 0.9534609024332624, 'precision': 0.8040201005025126, 'recall': 0.5031446540880503, 'f1': 0.6189555125725339, 'fp': 39, 'tp': 160, 'fn': 158, 'tn': 3876, 'auprc': 0.3900686428277874, 'precision99': 0.86, 'recall99': 0.0}
Traceback (most recent call last):
  File "relabel_train.py", line 124, in <module>
    raise Exception("maggie stop here!")
Exception: maggie stop here!
