2023-05-08 03:09:26.585759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:09:27.189270: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 03:09:27.189808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-08 03:09:27.219054: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.219231: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 03:09:27.219248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:09:27.221503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:09:27.221536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:09:27.236870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 03:09:27.237022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 03:09:27.237844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 03:09:27.238281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 03:09:27.238379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 03:09:27.238469: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.238665: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.238805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 03:09:27.238992: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-08 03:09:27.240463: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 03:09:27.240543: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.240698: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 03:09:27.240721: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:09:27.240732: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:09:27.240741: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:09:27.240750: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 03:09:27.240767: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 03:09:27.240776: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 03:09:27.240785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 03:09:27.240794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 03:09:27.240836: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.241003: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.241135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 03:09:27.241159: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:09:27.511787: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-08 03:09:27.511826: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-08 03:09:27.511832: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-08 03:09:27.512059: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.512259: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.512430: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:09:27.512578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22414 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-08 03:09:27.739019: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-08 03:09:27.739996: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-08 03:09:28.811870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:09:29.245696: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:09:29.251957: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
ps-detector-attack  dataset_min:-3.0454362462748454
ps-detector-attack  dataset_max:138.38713813073164
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
539/539 - 4s - loss: 0.1309 - accuracy: 0.9564 - auc: 0.9903 - recall: 0.9600 - precision: 0.9534 - val_loss: 0.0849 - val_accuracy: 0.9682 - val_auc: 0.9947 - val_recall: 0.9904 - val_precision: 0.9468
Epoch 2/50
539/539 - 3s - loss: 0.0634 - accuracy: 0.9758 - auc: 0.9970 - recall: 0.9862 - precision: 0.9662 - val_loss: 0.0700 - val_accuracy: 0.9739 - val_auc: 0.9957 - val_recall: 0.9818 - val_precision: 0.9653
Epoch 3/50
539/539 - 3s - loss: 0.0554 - accuracy: 0.9804 - auc: 0.9974 - recall: 0.9907 - precision: 0.9709 - val_loss: 0.0482 - val_accuracy: 0.9812 - val_auc: 0.9983 - val_recall: 0.9893 - val_precision: 0.9727
Epoch 4/50
539/539 - 3s - loss: 0.0518 - accuracy: 0.9807 - auc: 0.9978 - recall: 0.9903 - precision: 0.9718 - val_loss: 0.0530 - val_accuracy: 0.9786 - val_auc: 0.9981 - val_recall: 0.9818 - val_precision: 0.9745
Epoch 5/50
539/539 - 3s - loss: 0.0498 - accuracy: 0.9815 - auc: 0.9978 - recall: 0.9909 - precision: 0.9727 - val_loss: 0.0443 - val_accuracy: 0.9817 - val_auc: 0.9984 - val_recall: 0.9947 - val_precision: 0.9688
Epoch 6/50
539/539 - 3s - loss: 0.0464 - accuracy: 0.9818 - auc: 0.9983 - recall: 0.9914 - precision: 0.9729 - val_loss: 0.0425 - val_accuracy: 0.9843 - val_auc: 0.9989 - val_recall: 0.9882 - val_precision: 0.9799
Epoch 7/50
539/539 - 3s - loss: 0.0451 - accuracy: 0.9820 - auc: 0.9983 - recall: 0.9916 - precision: 0.9731 - val_loss: 0.0398 - val_accuracy: 0.9864 - val_auc: 0.9989 - val_recall: 0.9925 - val_precision: 0.9799
Epoch 8/50
539/539 - 3s - loss: 0.0449 - accuracy: 0.9829 - auc: 0.9984 - recall: 0.9913 - precision: 0.9751 - val_loss: 0.0427 - val_accuracy: 0.9817 - val_auc: 0.9988 - val_recall: 0.9861 - val_precision: 0.9767
Epoch 9/50
539/539 - 3s - loss: 0.0427 - accuracy: 0.9835 - auc: 0.9985 - recall: 0.9928 - precision: 0.9748 - val_loss: 0.0416 - val_accuracy: 0.9828 - val_auc: 0.9986 - val_recall: 0.9904 - val_precision: 0.9747
Epoch 10/50
539/539 - 3s - loss: 0.0437 - accuracy: 0.9833 - auc: 0.9983 - recall: 0.9924 - precision: 0.9749 - val_loss: 0.0419 - val_accuracy: 0.9838 - val_auc: 0.9987 - val_recall: 0.9925 - val_precision: 0.9748
Epoch 11/50
539/539 - 3s - loss: 0.0416 - accuracy: 0.9838 - auc: 0.9986 - recall: 0.9924 - precision: 0.9758 - val_loss: 0.0481 - val_accuracy: 0.9807 - val_auc: 0.9983 - val_recall: 0.9893 - val_precision: 0.9716
Epoch 12/50
539/539 - 3s - loss: 0.0413 - accuracy: 0.9845 - auc: 0.9986 - recall: 0.9935 - precision: 0.9759 - val_loss: 0.0354 - val_accuracy: 0.9875 - val_auc: 0.9990 - val_recall: 0.9957 - val_precision: 0.9790
Epoch 13/50
539/539 - 3s - loss: 0.0399 - accuracy: 0.9840 - auc: 0.9987 - recall: 0.9919 - precision: 0.9765 - val_loss: 0.0427 - val_accuracy: 0.9838 - val_auc: 0.9987 - val_recall: 0.9914 - val_precision: 0.9758
Epoch 14/50
539/539 - 3s - loss: 0.0392 - accuracy: 0.9841 - auc: 0.9987 - recall: 0.9931 - precision: 0.9757 - val_loss: 0.0407 - val_accuracy: 0.9843 - val_auc: 0.9988 - val_recall: 0.9925 - val_precision: 0.9758
Epoch 15/50
539/539 - 3s - loss: 0.0379 - accuracy: 0.9853 - auc: 0.9988 - recall: 0.9936 - precision: 0.9773 - val_loss: 0.0339 - val_accuracy: 0.9864 - val_auc: 0.9993 - val_recall: 0.9914 - val_precision: 0.9810
Epoch 16/50
539/539 - 3s - loss: 0.0365 - accuracy: 0.9860 - auc: 0.9989 - recall: 0.9936 - precision: 0.9787 - val_loss: 0.0341 - val_accuracy: 0.9890 - val_auc: 0.9991 - val_recall: 0.9979 - val_precision: 0.9800
Epoch 17/50
539/539 - 3s - loss: 0.0359 - accuracy: 0.9867 - auc: 0.9990 - recall: 0.9944 - precision: 0.9793 - val_loss: 0.0523 - val_accuracy: 0.9823 - val_auc: 0.9985 - val_recall: 0.9947 - val_precision: 0.9698
Epoch 18/50
539/539 - 3s - loss: 0.0354 - accuracy: 0.9863 - auc: 0.9989 - recall: 0.9936 - precision: 0.9794 - val_loss: 0.0333 - val_accuracy: 0.9885 - val_auc: 0.9993 - val_recall: 1.0000 - val_precision: 0.9770
Epoch 19/50
539/539 - 3s - loss: 0.0338 - accuracy: 0.9875 - auc: 0.9990 - recall: 0.9957 - precision: 0.9796 - val_loss: 0.0453 - val_accuracy: 0.9833 - val_auc: 0.9983 - val_recall: 0.9872 - val_precision: 0.9788
Epoch 20/50
539/539 - 3s - loss: 0.0336 - accuracy: 0.9868 - auc: 0.9991 - recall: 0.9931 - precision: 0.9808 - val_loss: 0.0335 - val_accuracy: 0.9843 - val_auc: 0.9993 - val_recall: 0.9861 - val_precision: 0.9819
Epoch 21/50
539/539 - 3s - loss: 0.0319 - accuracy: 0.9884 - auc: 0.9991 - recall: 0.9955 - precision: 0.9816 - val_loss: 0.0364 - val_accuracy: 0.9875 - val_auc: 0.9990 - val_recall: 0.9957 - val_precision: 0.9790
Epoch 22/50
539/539 - 3s - loss: 0.0322 - accuracy: 0.9878 - auc: 0.9992 - recall: 0.9948 - precision: 0.9812 - val_loss: 0.0319 - val_accuracy: 0.9885 - val_auc: 0.9992 - val_recall: 0.9914 - val_precision: 0.9851
Epoch 23/50
539/539 - 3s - loss: 0.0324 - accuracy: 0.9879 - auc: 0.9991 - recall: 0.9948 - precision: 0.9813 - val_loss: 0.0342 - val_accuracy: 0.9864 - val_auc: 0.9990 - val_recall: 0.9936 - val_precision: 0.9789
Epoch 24/50
539/539 - 3s - loss: 0.0321 - accuracy: 0.9884 - auc: 0.9990 - recall: 0.9950 - precision: 0.9821 - val_loss: 0.0358 - val_accuracy: 0.9849 - val_auc: 0.9990 - val_recall: 0.9882 - val_precision: 0.9809
Epoch 25/50
539/539 - 3s - loss: 0.0313 - accuracy: 0.9890 - auc: 0.9991 - recall: 0.9948 - precision: 0.9834 - val_loss: 0.0381 - val_accuracy: 0.9864 - val_auc: 0.9991 - val_recall: 0.9989 - val_precision: 0.9739
Epoch 26/50
539/539 - 3s - loss: 0.0304 - accuracy: 0.9882 - auc: 0.9992 - recall: 0.9940 - precision: 0.9827 - val_loss: 0.0328 - val_accuracy: 0.9880 - val_auc: 0.9992 - val_recall: 0.9957 - val_precision: 0.9800
Epoch 27/50
539/539 - 3s - loss: 0.0297 - accuracy: 0.9890 - auc: 0.9993 - recall: 0.9946 - precision: 0.9836 - val_loss: 0.0275 - val_accuracy: 0.9880 - val_auc: 0.9995 - val_recall: 0.9936 - val_precision: 0.9820
Epoch 28/50
539/539 - 3s - loss: 0.0292 - accuracy: 0.9894 - auc: 0.9992 - recall: 0.9950 - precision: 0.9840 - val_loss: 0.0384 - val_accuracy: 0.9843 - val_auc: 0.9989 - val_recall: 0.9850 - val_precision: 0.9829
Epoch 29/50
539/539 - 3s - loss: 0.0295 - accuracy: 0.9893 - auc: 0.9992 - recall: 0.9951 - precision: 0.9838 - val_loss: 0.0311 - val_accuracy: 0.9901 - val_auc: 0.9991 - val_recall: 0.9947 - val_precision: 0.9852
Epoch 30/50
539/539 - 3s - loss: 0.0292 - accuracy: 0.9898 - auc: 0.9992 - recall: 0.9956 - precision: 0.9843 - val_loss: 0.0286 - val_accuracy: 0.9880 - val_auc: 0.9995 - val_recall: 0.9947 - val_precision: 0.9810
Epoch 31/50
539/539 - 3s - loss: 0.0282 - accuracy: 0.9894 - auc: 0.9992 - recall: 0.9957 - precision: 0.9834 - val_loss: 0.0307 - val_accuracy: 0.9875 - val_auc: 0.9992 - val_recall: 0.9904 - val_precision: 0.9841
Epoch 32/50
539/539 - 3s - loss: 0.0282 - accuracy: 0.9897 - auc: 0.9993 - recall: 0.9956 - precision: 0.9840 - val_loss: 0.0275 - val_accuracy: 0.9890 - val_auc: 0.9996 - val_recall: 0.9936 - val_precision: 0.9841
Epoch 33/50
539/539 - 3s - loss: 0.0266 - accuracy: 0.9903 - auc: 0.9994 - recall: 0.9964 - precision: 0.9843 - val_loss: 0.0283 - val_accuracy: 0.9890 - val_auc: 0.9993 - val_recall: 0.9936 - val_precision: 0.9841
Epoch 34/50
539/539 - 3s - loss: 0.0270 - accuracy: 0.9901 - auc: 0.9993 - recall: 0.9961 - precision: 0.9844 - val_loss: 0.0369 - val_accuracy: 0.9864 - val_auc: 0.9993 - val_recall: 0.9861 - val_precision: 0.9861
Epoch 35/50
539/539 - 3s - loss: 0.0265 - accuracy: 0.9907 - auc: 0.9994 - recall: 0.9968 - precision: 0.9848 - val_loss: 0.0336 - val_accuracy: 0.9859 - val_auc: 0.9991 - val_recall: 0.9914 - val_precision: 0.9799
Epoch 36/50
539/539 - 2s - loss: 0.0288 - accuracy: 0.9900 - auc: 0.9992 - recall: 0.9956 - precision: 0.9846 - val_loss: 0.0290 - val_accuracy: 0.9901 - val_auc: 0.9993 - val_recall: 0.9989 - val_precision: 0.9811
Epoch 37/50
539/539 - 3s - loss: 0.0256 - accuracy: 0.9906 - auc: 0.9995 - recall: 0.9957 - precision: 0.9857 - val_loss: 0.0331 - val_accuracy: 0.9875 - val_auc: 0.9993 - val_recall: 0.9861 - val_precision: 0.9882
Epoch 38/50
539/539 - 3s - loss: 0.0258 - accuracy: 0.9903 - auc: 0.9993 - recall: 0.9953 - precision: 0.9854 - val_loss: 0.0214 - val_accuracy: 0.9916 - val_auc: 0.9998 - val_recall: 0.9989 - val_precision: 0.9842
Epoch 39/50
539/539 - 3s - loss: 0.0255 - accuracy: 0.9898 - auc: 0.9995 - recall: 0.9951 - precision: 0.9847 - val_loss: 0.0228 - val_accuracy: 0.9922 - val_auc: 0.9996 - val_recall: 1.0000 - val_precision: 0.9842
Epoch 40/50
539/539 - 3s - loss: 0.0250 - accuracy: 0.9909 - auc: 0.9994 - recall: 0.9963 - precision: 0.9858 - val_loss: 0.0217 - val_accuracy: 0.9922 - val_auc: 0.9997 - val_recall: 0.9957 - val_precision: 0.9883
Epoch 41/50
539/539 - 3s - loss: 0.0272 - accuracy: 0.9899 - auc: 0.9993 - recall: 0.9951 - precision: 0.9849 - val_loss: 0.0382 - val_accuracy: 0.9859 - val_auc: 0.9992 - val_recall: 0.9914 - val_precision: 0.9799
Epoch 42/50
539/539 - 3s - loss: 0.0273 - accuracy: 0.9906 - auc: 0.9992 - recall: 0.9966 - precision: 0.9848 - val_loss: 0.0221 - val_accuracy: 0.9922 - val_auc: 0.9997 - val_recall: 0.9957 - val_precision: 0.9883
Epoch 43/50
539/539 - 3s - loss: 0.0272 - accuracy: 0.9909 - auc: 0.9992 - recall: 0.9964 - precision: 0.9856 - val_loss: 0.0258 - val_accuracy: 0.9880 - val_auc: 0.9996 - val_recall: 0.9925 - val_precision: 0.9831
Epoch 44/50
539/539 - 3s - loss: 0.0271 - accuracy: 0.9907 - auc: 0.9993 - recall: 0.9962 - precision: 0.9853 - val_loss: 0.0231 - val_accuracy: 0.9911 - val_auc: 0.9995 - val_recall: 0.9936 - val_precision: 0.9883
Epoch 45/50
539/539 - 3s - loss: 0.0256 - accuracy: 0.9908 - auc: 0.9994 - recall: 0.9964 - precision: 0.9855 - val_loss: 0.0200 - val_accuracy: 0.9932 - val_auc: 0.9998 - val_recall: 0.9936 - val_precision: 0.9925
Epoch 46/50
539/539 - 2s - loss: 0.0261 - accuracy: 0.9912 - auc: 0.9994 - recall: 0.9962 - precision: 0.9864 - val_loss: 0.0236 - val_accuracy: 0.9901 - val_auc: 0.9996 - val_recall: 0.9904 - val_precision: 0.9893
Epoch 47/50
539/539 - 3s - loss: 0.0254 - accuracy: 0.9911 - auc: 0.9994 - recall: 0.9966 - precision: 0.9858 - val_loss: 0.0202 - val_accuracy: 0.9922 - val_auc: 0.9997 - val_recall: 0.9968 - val_precision: 0.9873
Epoch 48/50
539/539 - 3s - loss: 0.0244 - accuracy: 0.9911 - auc: 0.9995 - recall: 0.9966 - precision: 0.9857 - val_loss: 0.0216 - val_accuracy: 0.9922 - val_auc: 0.9997 - val_recall: 0.9968 - val_precision: 0.9873
Epoch 49/50
539/539 - 3s - loss: 0.0246 - accuracy: 0.9912 - auc: 0.9994 - recall: 0.9961 - precision: 0.9865 - val_loss: 0.0276 - val_accuracy: 0.9875 - val_auc: 0.9995 - val_recall: 0.9872 - val_precision: 0.9872
Epoch 50/50
539/539 - 3s - loss: 0.0246 - accuracy: 0.9917 - auc: 0.9993 - recall: 0.9970 - precision: 0.9866 - val_loss: 0.0204 - val_accuracy: 0.9937 - val_auc: 0.9997 - val_recall: 0.9989 - val_precision: 0.9884
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
ps-detector-attack  testset_min:-3.045436243980641
ps-detector-attack  testset_max:32.63330682674631
Metrics: 
 {'auc': 0.9344944909303106, 'accuracy': 0.9829907866761163, 'precision': 0.6457142857142857, 'recall': 0.9186991869918699, 'f1': 0.7583892617449665, 'fp': 62, 'tp': 113, 'fn': 10, 'tn': 4048, 'auprc': 0.89925700224448, 'precision99': 0.96, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
ps-detector-recon  dataset_min:-2.4484992515578954
ps-detector-recon  dataset_max:96.22275969699034
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
406/406 - 3s - loss: 0.3485 - accuracy: 0.8660 - auc_1: 0.8913 - recall_1: 0.9892 - precision_1: 0.7936 - val_loss: 0.3009 - val_accuracy: 0.8765 - val_auc_1: 0.9033 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 2/50
406/406 - 2s - loss: 0.3004 - accuracy: 0.8772 - auc_1: 0.9012 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2984 - val_accuracy: 0.8765 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 3/50
406/406 - 2s - loss: 0.2988 - accuracy: 0.8772 - auc_1: 0.9026 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2986 - val_accuracy: 0.8772 - val_auc_1: 0.9037 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 4/50
406/406 - 2s - loss: 0.2977 - accuracy: 0.8772 - auc_1: 0.9056 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2983 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 5/50
406/406 - 2s - loss: 0.2976 - accuracy: 0.8772 - auc_1: 0.9045 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.3003 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 6/50
406/406 - 2s - loss: 0.2966 - accuracy: 0.8773 - auc_1: 0.9029 - recall_1: 0.9963 - precision_1: 0.8048 - val_loss: 0.2989 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 7/50
406/406 - 2s - loss: 0.2957 - accuracy: 0.8777 - auc_1: 0.9022 - recall_1: 0.9969 - precision_1: 0.8050 - val_loss: 0.2985 - val_accuracy: 0.8765 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 8/50
406/406 - 2s - loss: 0.2960 - accuracy: 0.8778 - auc_1: 0.9013 - recall_1: 0.9972 - precision_1: 0.8050 - val_loss: 0.2972 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 9/50
406/406 - 2s - loss: 0.2950 - accuracy: 0.8779 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2962 - val_accuracy: 0.8772 - val_auc_1: 0.9031 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 10/50
406/406 - 2s - loss: 0.2949 - accuracy: 0.8779 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2951 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 11/50
406/406 - 2s - loss: 0.2947 - accuracy: 0.8779 - auc_1: 0.9022 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2980 - val_accuracy: 0.8772 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 12/50
406/406 - 2s - loss: 0.2941 - accuracy: 0.8780 - auc_1: 0.9032 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2971 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 13/50
406/406 - 2s - loss: 0.2941 - accuracy: 0.8779 - auc_1: 0.9011 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 14/50
406/406 - 2s - loss: 0.2928 - accuracy: 0.8780 - auc_1: 0.9046 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2999 - val_accuracy: 0.8772 - val_auc_1: 0.9031 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 15/50
406/406 - 2s - loss: 0.2934 - accuracy: 0.8779 - auc_1: 0.9037 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2978 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 16/50
406/406 - 2s - loss: 0.2937 - accuracy: 0.8779 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2959 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 17/50
406/406 - 2s - loss: 0.2937 - accuracy: 0.8780 - auc_1: 0.9014 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2961 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 18/50
406/406 - 2s - loss: 0.2926 - accuracy: 0.8777 - auc_1: 0.9045 - recall_1: 0.9974 - precision_1: 0.8048 - val_loss: 0.2968 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 19/50
406/406 - 2s - loss: 0.2923 - accuracy: 0.8779 - auc_1: 0.9046 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2951 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 20/50
406/406 - 2s - loss: 0.2928 - accuracy: 0.8779 - auc_1: 0.9027 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2987 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 21/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8779 - auc_1: 0.9035 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2952 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 22/50
406/406 - 2s - loss: 0.2919 - accuracy: 0.8779 - auc_1: 0.9032 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2955 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 23/50
406/406 - 2s - loss: 0.2927 - accuracy: 0.8779 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2943 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 24/50
406/406 - 2s - loss: 0.2918 - accuracy: 0.8779 - auc_1: 0.9028 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2949 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 25/50
406/406 - 2s - loss: 0.2925 - accuracy: 0.8779 - auc_1: 0.9043 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 26/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8779 - auc_1: 0.9050 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2970 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 27/50
406/406 - 2s - loss: 0.2919 - accuracy: 0.8779 - auc_1: 0.9032 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2939 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 28/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8780 - auc_1: 0.9053 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2932 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 29/50
406/406 - 2s - loss: 0.2915 - accuracy: 0.8779 - auc_1: 0.9048 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2937 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 30/50
406/406 - 2s - loss: 0.2910 - accuracy: 0.8779 - auc_1: 0.9058 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 31/50
406/406 - 2s - loss: 0.2912 - accuracy: 0.8781 - auc_1: 0.9036 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2940 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 32/50
406/406 - 2s - loss: 0.2910 - accuracy: 0.8779 - auc_1: 0.9056 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2943 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 33/50
406/406 - 2s - loss: 0.2910 - accuracy: 0.8779 - auc_1: 0.9046 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2946 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 34/50
406/406 - 2s - loss: 0.2917 - accuracy: 0.8779 - auc_1: 0.9054 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2974 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 35/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8781 - auc_1: 0.9024 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2943 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 36/50
406/406 - 2s - loss: 0.2910 - accuracy: 0.8781 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2956 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 37/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8781 - auc_1: 0.9035 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2915 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 38/50
406/406 - 2s - loss: 0.2912 - accuracy: 0.8782 - auc_1: 0.9037 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2944 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 39/50
406/406 - 2s - loss: 0.2906 - accuracy: 0.8779 - auc_1: 0.9034 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2923 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 40/50
406/406 - 2s - loss: 0.2902 - accuracy: 0.8781 - auc_1: 0.9066 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2944 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 41/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8780 - auc_1: 0.9033 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2912 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 42/50
406/406 - 2s - loss: 0.2896 - accuracy: 0.8783 - auc_1: 0.9066 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2938 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 43/50
406/406 - 2s - loss: 0.2900 - accuracy: 0.8784 - auc_1: 0.9030 - recall_1: 0.9974 - precision_1: 0.8057 - val_loss: 0.2902 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 44/50
406/406 - 2s - loss: 0.2905 - accuracy: 0.8782 - auc_1: 0.9045 - recall_1: 0.9974 - precision_1: 0.8055 - val_loss: 0.2932 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 45/50
406/406 - 2s - loss: 0.2901 - accuracy: 0.8782 - auc_1: 0.9030 - recall_1: 0.9975 - precision_1: 0.8054 - val_loss: 0.2942 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 46/50
406/406 - 2s - loss: 0.2890 - accuracy: 0.8791 - auc_1: 0.9062 - recall_1: 0.9974 - precision_1: 0.8066 - val_loss: 0.2894 - val_accuracy: 0.8806 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 47/50
406/406 - 2s - loss: 0.2890 - accuracy: 0.8789 - auc_1: 0.9022 - recall_1: 0.9974 - precision_1: 0.8064 - val_loss: 0.2887 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 48/50
406/406 - 2s - loss: 0.2889 - accuracy: 0.8800 - auc_1: 0.9045 - recall_1: 0.9975 - precision_1: 0.8077 - val_loss: 0.2920 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 49/50
406/406 - 2s - loss: 0.2890 - accuracy: 0.8793 - auc_1: 0.9043 - recall_1: 0.9972 - precision_1: 0.8069 - val_loss: 0.2931 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 50/50
406/406 - 2s - loss: 0.2897 - accuracy: 0.8785 - auc_1: 0.9025 - recall_1: 0.9974 - precision_1: 0.8058 - val_loss: 0.2923 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
ps-detector-recon  testset_min:-2.4484992496151756
ps-detector-recon  testset_max:28.32679285519669
Metrics: 
 {'auc': 0.9263332538658853, 'accuracy': 0.959603118355776, 'precision': 0.9509621353196772, 'recall': 0.9957751056223595, 'f1': 0.9728528337831401, 'fp': 158, 'tp': 3064, 'fn': 13, 'tn': 998, 'auprc': 0.9127180504426968, 'precision99': 0.76, 'recall99': 0.77}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
ps-detector-infec  dataset_min:-2.3799714775110803
ps-detector-infec  dataset_max:140.77286670370265
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
558/558 - 4s - loss: 0.3814 - accuracy: 0.8533 - auc_2: 0.8954 - recall_2: 0.8027 - precision_2: 0.8933 - val_loss: 0.3106 - val_accuracy: 0.8875 - val_auc_2: 0.9226 - val_recall_2: 0.8179 - val_precision_2: 0.9481
Epoch 2/50
558/558 - 3s - loss: 0.3005 - accuracy: 0.8857 - auc_2: 0.9253 - recall_2: 0.8201 - precision_2: 0.9442 - val_loss: 0.2886 - val_accuracy: 0.8940 - val_auc_2: 0.9285 - val_recall_2: 0.8189 - val_precision_2: 0.9618
Epoch 3/50
558/558 - 3s - loss: 0.2833 - accuracy: 0.8924 - auc_2: 0.9303 - recall_2: 0.8227 - precision_2: 0.9562 - val_loss: 0.2731 - val_accuracy: 0.8951 - val_auc_2: 0.9323 - val_recall_2: 0.8240 - val_precision_2: 0.9586
Epoch 4/50
558/558 - 3s - loss: 0.2793 - accuracy: 0.8927 - auc_2: 0.9324 - recall_2: 0.8215 - precision_2: 0.9581 - val_loss: 0.2713 - val_accuracy: 0.8940 - val_auc_2: 0.9315 - val_recall_2: 0.8260 - val_precision_2: 0.9542
Epoch 5/50
558/558 - 3s - loss: 0.2742 - accuracy: 0.8945 - auc_2: 0.9323 - recall_2: 0.8224 - precision_2: 0.9611 - val_loss: 0.2744 - val_accuracy: 0.8961 - val_auc_2: 0.9324 - val_recall_2: 0.8260 - val_precision_2: 0.9587
Epoch 6/50
558/558 - 3s - loss: 0.2705 - accuracy: 0.8955 - auc_2: 0.9364 - recall_2: 0.8232 - precision_2: 0.9627 - val_loss: 0.2662 - val_accuracy: 0.8986 - val_auc_2: 0.9329 - val_recall_2: 0.8260 - val_precision_2: 0.9644
Epoch 7/50
558/558 - 3s - loss: 0.2672 - accuracy: 0.8969 - auc_2: 0.9356 - recall_2: 0.8234 - precision_2: 0.9655 - val_loss: 0.2619 - val_accuracy: 0.9031 - val_auc_2: 0.9342 - val_recall_2: 0.8250 - val_precision_2: 0.9759
Epoch 8/50
558/558 - 3s - loss: 0.2672 - accuracy: 0.8976 - auc_2: 0.9340 - recall_2: 0.8239 - precision_2: 0.9666 - val_loss: 0.2610 - val_accuracy: 0.8986 - val_auc_2: 0.9346 - val_recall_2: 0.8260 - val_precision_2: 0.9644
Epoch 9/50
558/558 - 3s - loss: 0.2645 - accuracy: 0.8975 - auc_2: 0.9344 - recall_2: 0.8224 - precision_2: 0.9678 - val_loss: 0.2634 - val_accuracy: 0.8956 - val_auc_2: 0.9347 - val_recall_2: 0.8230 - val_precision_2: 0.9608
Epoch 10/50
558/558 - 3s - loss: 0.2631 - accuracy: 0.8985 - auc_2: 0.9356 - recall_2: 0.8240 - precision_2: 0.9684 - val_loss: 0.2607 - val_accuracy: 0.8996 - val_auc_2: 0.9346 - val_recall_2: 0.8260 - val_precision_2: 0.9667
Epoch 11/50
558/558 - 3s - loss: 0.2621 - accuracy: 0.8995 - auc_2: 0.9348 - recall_2: 0.8242 - precision_2: 0.9705 - val_loss: 0.2608 - val_accuracy: 0.9006 - val_auc_2: 0.9353 - val_recall_2: 0.8260 - val_precision_2: 0.9690
Epoch 12/50
558/558 - 3s - loss: 0.2597 - accuracy: 0.8999 - auc_2: 0.9374 - recall_2: 0.8250 - precision_2: 0.9705 - val_loss: 0.2788 - val_accuracy: 0.8971 - val_auc_2: 0.9299 - val_recall_2: 0.8260 - val_precision_2: 0.9609
Epoch 13/50
558/558 - 3s - loss: 0.2600 - accuracy: 0.8997 - auc_2: 0.9370 - recall_2: 0.8247 - precision_2: 0.9705 - val_loss: 0.2657 - val_accuracy: 0.8961 - val_auc_2: 0.9340 - val_recall_2: 0.8250 - val_precision_2: 0.9598
Epoch 14/50
558/558 - 3s - loss: 0.2579 - accuracy: 0.9003 - auc_2: 0.9375 - recall_2: 0.8253 - precision_2: 0.9710 - val_loss: 0.2597 - val_accuracy: 0.9006 - val_auc_2: 0.9358 - val_recall_2: 0.8260 - val_precision_2: 0.9690
Epoch 15/50
558/558 - 3s - loss: 0.2580 - accuracy: 0.9003 - auc_2: 0.9359 - recall_2: 0.8248 - precision_2: 0.9718 - val_loss: 0.2584 - val_accuracy: 0.9016 - val_auc_2: 0.9352 - val_recall_2: 0.8260 - val_precision_2: 0.9713
Epoch 16/50
558/558 - 3s - loss: 0.2555 - accuracy: 0.9008 - auc_2: 0.9381 - recall_2: 0.8251 - precision_2: 0.9724 - val_loss: 0.2559 - val_accuracy: 0.8986 - val_auc_2: 0.9367 - val_recall_2: 0.8149 - val_precision_2: 0.9768
Epoch 17/50
558/558 - 3s - loss: 0.2541 - accuracy: 0.9016 - auc_2: 0.9369 - recall_2: 0.8252 - precision_2: 0.9742 - val_loss: 0.2839 - val_accuracy: 0.8845 - val_auc_2: 0.9272 - val_recall_2: 0.7864 - val_precision_2: 0.9760
Epoch 18/50
558/558 - 3s - loss: 0.2542 - accuracy: 0.9012 - auc_2: 0.9378 - recall_2: 0.8247 - precision_2: 0.9739 - val_loss: 0.2523 - val_accuracy: 0.9041 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 19/50
558/558 - 3s - loss: 0.2523 - accuracy: 0.9021 - auc_2: 0.9393 - recall_2: 0.8259 - precision_2: 0.9745 - val_loss: 0.2703 - val_accuracy: 0.8991 - val_auc_2: 0.9321 - val_recall_2: 0.8179 - val_precision_2: 0.9745
Epoch 20/50
558/558 - 3s - loss: 0.2546 - accuracy: 0.9013 - auc_2: 0.9369 - recall_2: 0.8249 - precision_2: 0.9738 - val_loss: 0.2612 - val_accuracy: 0.9001 - val_auc_2: 0.9356 - val_recall_2: 0.8210 - val_precision_2: 0.9735
Epoch 21/50
558/558 - 3s - loss: 0.2501 - accuracy: 0.9024 - auc_2: 0.9377 - recall_2: 0.8251 - precision_2: 0.9761 - val_loss: 0.2553 - val_accuracy: 0.9046 - val_auc_2: 0.9368 - val_recall_2: 0.8240 - val_precision_2: 0.9806
Epoch 22/50
558/558 - 3s - loss: 0.2494 - accuracy: 0.9025 - auc_2: 0.9392 - recall_2: 0.8251 - precision_2: 0.9764 - val_loss: 0.2505 - val_accuracy: 0.9046 - val_auc_2: 0.9371 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 23/50
558/558 - 3s - loss: 0.2499 - accuracy: 0.9022 - auc_2: 0.9388 - recall_2: 0.8253 - precision_2: 0.9755 - val_loss: 0.2603 - val_accuracy: 0.9026 - val_auc_2: 0.9362 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 24/50
558/558 - 3s - loss: 0.2504 - accuracy: 0.9028 - auc_2: 0.9389 - recall_2: 0.8257 - precision_2: 0.9765 - val_loss: 0.2546 - val_accuracy: 0.9021 - val_auc_2: 0.9352 - val_recall_2: 0.8260 - val_precision_2: 0.9725
Epoch 25/50
558/558 - 3s - loss: 0.2491 - accuracy: 0.9030 - auc_2: 0.9397 - recall_2: 0.8253 - precision_2: 0.9773 - val_loss: 0.2458 - val_accuracy: 0.9062 - val_auc_2: 0.9388 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 26/50
558/558 - 3s - loss: 0.2495 - accuracy: 0.9028 - auc_2: 0.9391 - recall_2: 0.8249 - precision_2: 0.9774 - val_loss: 0.2514 - val_accuracy: 0.9026 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 27/50
558/558 - 3s - loss: 0.2467 - accuracy: 0.9040 - auc_2: 0.9404 - recall_2: 0.8257 - precision_2: 0.9791 - val_loss: 0.2576 - val_accuracy: 0.9046 - val_auc_2: 0.9375 - val_recall_2: 0.8250 - val_precision_2: 0.9795
Epoch 28/50
558/558 - 3s - loss: 0.2474 - accuracy: 0.9040 - auc_2: 0.9402 - recall_2: 0.8263 - precision_2: 0.9785 - val_loss: 0.2657 - val_accuracy: 0.8930 - val_auc_2: 0.9371 - val_recall_2: 0.8016 - val_precision_2: 0.9789
Epoch 29/50
558/558 - 3s - loss: 0.2459 - accuracy: 0.9045 - auc_2: 0.9403 - recall_2: 0.8265 - precision_2: 0.9796 - val_loss: 0.2544 - val_accuracy: 0.9021 - val_auc_2: 0.9369 - val_recall_2: 0.8210 - val_precision_2: 0.9782
Epoch 30/50
558/558 - 3s - loss: 0.2469 - accuracy: 0.9038 - auc_2: 0.9391 - recall_2: 0.8256 - precision_2: 0.9789 - val_loss: 0.2522 - val_accuracy: 0.9036 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9760
Epoch 31/50
558/558 - 3s - loss: 0.2463 - accuracy: 0.9038 - auc_2: 0.9388 - recall_2: 0.8267 - precision_2: 0.9777 - val_loss: 0.2492 - val_accuracy: 0.9057 - val_auc_2: 0.9386 - val_recall_2: 0.8240 - val_precision_2: 0.9830
Epoch 32/50
558/558 - 3s - loss: 0.2457 - accuracy: 0.9042 - auc_2: 0.9404 - recall_2: 0.8265 - precision_2: 0.9788 - val_loss: 0.2447 - val_accuracy: 0.9062 - val_auc_2: 0.9383 - val_recall_2: 0.8250 - val_precision_2: 0.9830
Epoch 33/50
558/558 - 3s - loss: 0.2458 - accuracy: 0.9042 - auc_2: 0.9383 - recall_2: 0.8259 - precision_2: 0.9794 - val_loss: 0.2474 - val_accuracy: 0.9072 - val_auc_2: 0.9381 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 34/50
558/558 - 3s - loss: 0.2456 - accuracy: 0.9041 - auc_2: 0.9407 - recall_2: 0.8257 - precision_2: 0.9795 - val_loss: 0.2499 - val_accuracy: 0.9041 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 35/50
558/558 - 3s - loss: 0.2446 - accuracy: 0.9043 - auc_2: 0.9411 - recall_2: 0.8263 - precision_2: 0.9792 - val_loss: 0.2473 - val_accuracy: 0.9062 - val_auc_2: 0.9379 - val_recall_2: 0.8250 - val_precision_2: 0.9830
Epoch 36/50
558/558 - 3s - loss: 0.2442 - accuracy: 0.9042 - auc_2: 0.9405 - recall_2: 0.8258 - precision_2: 0.9795 - val_loss: 0.2495 - val_accuracy: 0.9046 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 37/50
558/558 - 3s - loss: 0.2440 - accuracy: 0.9047 - auc_2: 0.9399 - recall_2: 0.8271 - precision_2: 0.9793 - val_loss: 0.2443 - val_accuracy: 0.9077 - val_auc_2: 0.9385 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 38/50
558/558 - 3s - loss: 0.2430 - accuracy: 0.9051 - auc_2: 0.9409 - recall_2: 0.8269 - precision_2: 0.9803 - val_loss: 0.2564 - val_accuracy: 0.9046 - val_auc_2: 0.9379 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 39/50
558/558 - 3s - loss: 0.2446 - accuracy: 0.9041 - auc_2: 0.9387 - recall_2: 0.8259 - precision_2: 0.9791 - val_loss: 0.2513 - val_accuracy: 0.9046 - val_auc_2: 0.9377 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 40/50
558/558 - 3s - loss: 0.2425 - accuracy: 0.9052 - auc_2: 0.9413 - recall_2: 0.8280 - precision_2: 0.9793 - val_loss: 0.2459 - val_accuracy: 0.9051 - val_auc_2: 0.9382 - val_recall_2: 0.8250 - val_precision_2: 0.9807
Epoch 41/50
558/558 - 3s - loss: 0.2418 - accuracy: 0.9055 - auc_2: 0.9407 - recall_2: 0.8267 - precision_2: 0.9816 - val_loss: 0.2443 - val_accuracy: 0.9067 - val_auc_2: 0.9387 - val_recall_2: 0.8250 - val_precision_2: 0.9842
Epoch 42/50
558/558 - 3s - loss: 0.2431 - accuracy: 0.9052 - auc_2: 0.9418 - recall_2: 0.8268 - precision_2: 0.9807 - val_loss: 0.2501 - val_accuracy: 0.9036 - val_auc_2: 0.9381 - val_recall_2: 0.8240 - val_precision_2: 0.9783
Epoch 43/50
558/558 - 3s - loss: 0.2414 - accuracy: 0.9052 - auc_2: 0.9409 - recall_2: 0.8267 - precision_2: 0.9810 - val_loss: 0.2388 - val_accuracy: 0.9092 - val_auc_2: 0.9397 - val_recall_2: 0.8260 - val_precision_2: 0.9890
Epoch 44/50
558/558 - 3s - loss: 0.2421 - accuracy: 0.9052 - auc_2: 0.9415 - recall_2: 0.8270 - precision_2: 0.9806 - val_loss: 0.2493 - val_accuracy: 0.9077 - val_auc_2: 0.9384 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 45/50
558/558 - 3s - loss: 0.2414 - accuracy: 0.9060 - auc_2: 0.9400 - recall_2: 0.8276 - precision_2: 0.9818 - val_loss: 0.2419 - val_accuracy: 0.9077 - val_auc_2: 0.9392 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 46/50
558/558 - 3s - loss: 0.2413 - accuracy: 0.9058 - auc_2: 0.9411 - recall_2: 0.8275 - precision_2: 0.9813 - val_loss: 0.2407 - val_accuracy: 0.9087 - val_auc_2: 0.9400 - val_recall_2: 0.8260 - val_precision_2: 0.9878
Epoch 47/50
558/558 - 3s - loss: 0.2408 - accuracy: 0.9055 - auc_2: 0.9389 - recall_2: 0.8265 - precision_2: 0.9818 - val_loss: 0.2424 - val_accuracy: 0.9077 - val_auc_2: 0.9397 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 48/50
558/558 - 3s - loss: 0.2399 - accuracy: 0.9053 - auc_2: 0.9399 - recall_2: 0.8275 - precision_2: 0.9802 - val_loss: 0.2415 - val_accuracy: 0.9087 - val_auc_2: 0.9392 - val_recall_2: 0.8260 - val_precision_2: 0.9878
Epoch 49/50
558/558 - 3s - loss: 0.2406 - accuracy: 0.9055 - auc_2: 0.9417 - recall_2: 0.8266 - precision_2: 0.9818 - val_loss: 0.2425 - val_accuracy: 0.9077 - val_auc_2: 0.9380 - val_recall_2: 0.8260 - val_precision_2: 0.9854
Epoch 50/50
558/558 - 3s - loss: 0.2398 - accuracy: 0.9055 - auc_2: 0.9425 - recall_2: 0.8268 - precision_2: 0.9815 - val_loss: 0.2527 - val_accuracy: 0.9057 - val_auc_2: 0.9368 - val_recall_2: 0.8260 - val_precision_2: 0.9807
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
ps-detector-infec  testset_min:-1.7222021363244926
ps-detector-infec  testset_max:31.46267630066733
Metrics: 
 {'auc': 0.5999690755600536, 'accuracy': 0.9503897944720057, 'precision': 0.7647058823529411, 'recall': 0.49056603773584906, 'f1': 0.5977011494252874, 'fp': 48, 'tp': 156, 'fn': 162, 'tn': 3867, 'auprc': 0.36027289633314585, 'precision99': 0.56, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.07629427792915532
proportion of infection events tagged by ps-detector-recon detector:  0.4824402058734484
proportion of infection events tagged by ps-detector-infec detector:  0.42239378342920575
proportion of events estimated to be benign :  0.0677162175799778
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_6 (LSTM)                   [(None, 10, 128), (N 68096       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         lstm_6[0][1]                     
__________________________________________________________________________________________________
repeat_vector (RepeatVector)    (None, 10, 128)      0           batch_normalization[0][0]        
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128)          512         lstm_6[0][2]                     
__________________________________________________________________________________________________
lstm_7 (LSTM)                   (None, 10, 128)      131584      repeat_vector[0][0]              
                                                                 batch_normalization[0][0]        
                                                                 batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dot (Dot)                       (None, 10, 10)       0           lstm_7[0][0]                     
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 10, 10)       0           dot[0][0]                        
__________________________________________________________________________________________________
dot_1 (Dot)                     (None, 10, 128)      0           activation[0][0]                 
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 10, 128)      512         dot_1[0][0]                      
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 10, 256)      0           batch_normalization_2[0][0]      
                                                                 lstm_7[0][0]                     
__________________________________________________________________________________________________
time_distributed (TimeDistribut (None, 10, 1)        257         concatenate[0][0]                
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 10, 1)        0           time_distributed[0][0]           
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 9s - loss: 0.0565 - accuracy: 0.9838 - auc_3: 0.9956 - recall_3: 0.9833 - precision_3: 0.9843 - val_loss: 0.0391 - val_accuracy: 0.9933 - val_auc_3: 0.9984 - val_recall_3: 0.9936 - val_precision_3: 0.9930
Epoch 2/30
159/159 - 6s - loss: 0.0359 - accuracy: 0.9925 - auc_3: 0.9969 - recall_3: 0.9935 - precision_3: 0.9916 - val_loss: 0.0253 - val_accuracy: 0.9935 - val_auc_3: 0.9988 - val_recall_3: 0.9946 - val_precision_3: 0.9924
Epoch 3/30
159/159 - 6s - loss: 0.0316 - accuracy: 0.9932 - auc_3: 0.9973 - recall_3: 0.9931 - precision_3: 0.9933 - val_loss: 0.0305 - val_accuracy: 0.9935 - val_auc_3: 0.9987 - val_recall_3: 0.9913 - val_precision_3: 0.9957
Epoch 4/30
159/159 - 6s - loss: 0.0314 - accuracy: 0.9932 - auc_3: 0.9973 - recall_3: 0.9931 - precision_3: 0.9932 - val_loss: 0.0287 - val_accuracy: 0.9942 - val_auc_3: 0.9985 - val_recall_3: 0.9901 - val_precision_3: 0.9983
Epoch 5/30
159/159 - 6s - loss: 0.0312 - accuracy: 0.9932 - auc_3: 0.9974 - recall_3: 0.9933 - precision_3: 0.9932 - val_loss: 0.0495 - val_accuracy: 0.9935 - val_auc_3: 0.9985 - val_recall_3: 0.9886 - val_precision_3: 0.9984
Epoch 6/30
159/159 - 6s - loss: 0.0285 - accuracy: 0.9934 - auc_3: 0.9979 - recall_3: 0.9926 - precision_3: 0.9942 - val_loss: 0.0212 - val_accuracy: 0.9946 - val_auc_3: 0.9990 - val_recall_3: 0.9936 - val_precision_3: 0.9956
Epoch 7/30
159/159 - 6s - loss: 0.0278 - accuracy: 0.9936 - auc_3: 0.9979 - recall_3: 0.9928 - precision_3: 0.9944 - val_loss: 0.0223 - val_accuracy: 0.9940 - val_auc_3: 0.9990 - val_recall_3: 0.9908 - val_precision_3: 0.9971
Epoch 8/30
159/159 - 6s - loss: 0.0272 - accuracy: 0.9934 - auc_3: 0.9980 - recall_3: 0.9927 - precision_3: 0.9940 - val_loss: 0.0230 - val_accuracy: 0.9948 - val_auc_3: 0.9986 - val_recall_3: 0.9916 - val_precision_3: 0.9981
Epoch 9/30
159/159 - 6s - loss: 0.0298 - accuracy: 0.9934 - auc_3: 0.9977 - recall_3: 0.9931 - precision_3: 0.9936 - val_loss: 0.0239 - val_accuracy: 0.9946 - val_auc_3: 0.9990 - val_recall_3: 0.9932 - val_precision_3: 0.9961
Epoch 10/30
159/159 - 6s - loss: 0.0272 - accuracy: 0.9933 - auc_3: 0.9982 - recall_3: 0.9922 - precision_3: 0.9944 - val_loss: 0.0898 - val_accuracy: 0.9701 - val_auc_3: 0.9987 - val_recall_3: 0.9414 - val_precision_3: 0.9988
Epoch 11/30
159/159 - 6s - loss: 0.0273 - accuracy: 0.9935 - auc_3: 0.9982 - recall_3: 0.9923 - precision_3: 0.9947 - val_loss: 0.0528 - val_accuracy: 0.9926 - val_auc_3: 0.9983 - val_recall_3: 0.9865 - val_precision_3: 0.9987
Epoch 12/30
159/159 - 6s - loss: 0.0275 - accuracy: 0.9933 - auc_3: 0.9980 - recall_3: 0.9930 - precision_3: 0.9936 - val_loss: 0.0299 - val_accuracy: 0.9931 - val_auc_3: 0.9990 - val_recall_3: 0.9876 - val_precision_3: 0.9986
Epoch 13/30
159/159 - 6s - loss: 0.0275 - accuracy: 0.9937 - auc_3: 0.9979 - recall_3: 0.9926 - precision_3: 0.9947 - val_loss: 0.1467 - val_accuracy: 0.9837 - val_auc_3: 0.9988 - val_recall_3: 0.9687 - val_precision_3: 0.9988
Epoch 14/30
159/159 - 6s - loss: 0.0278 - accuracy: 0.9935 - auc_3: 0.9980 - recall_3: 0.9928 - precision_3: 0.9942 - val_loss: 0.0701 - val_accuracy: 0.9871 - val_auc_3: 0.9988 - val_recall_3: 0.9750 - val_precision_3: 0.9991
Epoch 15/30
159/159 - 6s - loss: 0.0240 - accuracy: 0.9937 - auc_3: 0.9986 - recall_3: 0.9927 - precision_3: 0.9946 - val_loss: 0.0790 - val_accuracy: 0.9732 - val_auc_3: 0.9981 - val_recall_3: 0.9473 - val_precision_3: 0.9991
Epoch 16/30
159/159 - 6s - loss: 0.0248 - accuracy: 0.9937 - auc_3: 0.9984 - recall_3: 0.9921 - precision_3: 0.9952 - val_loss: 0.0219 - val_accuracy: 0.9949 - val_auc_3: 0.9985 - val_recall_3: 0.9929 - val_precision_3: 0.9968
Epoch 17/30
159/159 - 6s - loss: 0.0245 - accuracy: 0.9937 - auc_3: 0.9984 - recall_3: 0.9923 - precision_3: 0.9950 - val_loss: 0.1546 - val_accuracy: 0.9470 - val_auc_3: 0.9983 - val_recall_3: 0.8953 - val_precision_3: 0.9985
Epoch 18/30
159/159 - 6s - loss: 0.0246 - accuracy: 0.9938 - auc_3: 0.9984 - recall_3: 0.9929 - precision_3: 0.9947 - val_loss: 0.0210 - val_accuracy: 0.9945 - val_auc_3: 0.9991 - val_recall_3: 0.9903 - val_precision_3: 0.9987
Epoch 19/30
159/159 - 6s - loss: 0.0240 - accuracy: 0.9936 - auc_3: 0.9985 - recall_3: 0.9919 - precision_3: 0.9952 - val_loss: 0.0407 - val_accuracy: 0.9873 - val_auc_3: 0.9987 - val_recall_3: 0.9755 - val_precision_3: 0.9991
Epoch 20/30
159/159 - 6s - loss: 0.0254 - accuracy: 0.9935 - auc_3: 0.9983 - recall_3: 0.9920 - precision_3: 0.9950 - val_loss: 0.0675 - val_accuracy: 0.9778 - val_auc_3: 0.9987 - val_recall_3: 0.9569 - val_precision_3: 0.9987
Epoch 21/30
159/159 - 6s - loss: 0.0229 - accuracy: 0.9937 - auc_3: 0.9986 - recall_3: 0.9919 - precision_3: 0.9955 - val_loss: 0.0259 - val_accuracy: 0.9950 - val_auc_3: 0.9989 - val_recall_3: 0.9914 - val_precision_3: 0.9986
Epoch 22/30
159/159 - 6s - loss: 0.0227 - accuracy: 0.9937 - auc_3: 0.9987 - recall_3: 0.9923 - precision_3: 0.9951 - val_loss: 0.1500 - val_accuracy: 0.9428 - val_auc_3: 0.9978 - val_recall_3: 0.8866 - val_precision_3: 0.9990
Epoch 23/30
159/159 - 6s - loss: 0.0228 - accuracy: 0.9939 - auc_3: 0.9986 - recall_3: 0.9923 - precision_3: 0.9955 - val_loss: 0.0740 - val_accuracy: 0.9895 - val_auc_3: 0.9989 - val_recall_3: 0.9798 - val_precision_3: 0.9991
Epoch 24/30
159/159 - 6s - loss: 0.0219 - accuracy: 0.9938 - auc_3: 0.9987 - recall_3: 0.9917 - precision_3: 0.9959 - val_loss: 0.0360 - val_accuracy: 0.9910 - val_auc_3: 0.9990 - val_recall_3: 0.9830 - val_precision_3: 0.9991
Epoch 25/30
159/159 - 6s - loss: 0.0231 - accuracy: 0.9937 - auc_3: 0.9986 - recall_3: 0.9925 - precision_3: 0.9949 - val_loss: 0.0286 - val_accuracy: 0.9938 - val_auc_3: 0.9991 - val_recall_3: 0.9883 - val_precision_3: 0.9992
Epoch 26/30
159/159 - 6s - loss: 0.0223 - accuracy: 0.9938 - auc_3: 0.9986 - recall_3: 0.9922 - precision_3: 0.9954 - val_loss: 0.0580 - val_accuracy: 0.9819 - val_auc_3: 0.9984 - val_recall_3: 0.9646 - val_precision_3: 0.9991
Epoch 27/30
159/159 - 6s - loss: 0.0259 - accuracy: 0.9933 - auc_3: 0.9983 - recall_3: 0.9924 - precision_3: 0.9941 - val_loss: 0.0436 - val_accuracy: 0.9928 - val_auc_3: 0.9988 - val_recall_3: 0.9864 - val_precision_3: 0.9991
Epoch 28/30
159/159 - 6s - loss: 0.0230 - accuracy: 0.9938 - auc_3: 0.9987 - recall_3: 0.9917 - precision_3: 0.9958 - val_loss: 0.1817 - val_accuracy: 0.9117 - val_auc_3: 0.9990 - val_recall_3: 0.8234 - val_precision_3: 1.0000
Epoch 29/30
159/159 - 6s - loss: 0.0222 - accuracy: 0.9938 - auc_3: 0.9987 - recall_3: 0.9914 - precision_3: 0.9962 - val_loss: 0.0231 - val_accuracy: 0.9940 - val_auc_3: 0.9989 - val_recall_3: 0.9891 - val_precision_3: 0.9989
Epoch 30/30
159/159 - 6s - loss: 0.0210 - accuracy: 0.9939 - auc_3: 0.9987 - recall_3: 0.9912 - precision_3: 0.9965 - val_loss: 0.0214 - val_accuracy: 0.9940 - val_auc_3: 0.9989 - val_recall_3: 0.9893 - val_precision_3: 0.9987
WARNING:tensorflow:Layer lstm_8 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_8 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_9 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_9 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
features len is  41
-----------------------------
Retraining infection detector
-----------------------------
ps-detector-infec  dataset_min:-2.3799714775110803
ps-detector-infec  dataset_max:140.77286670370265
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
558/558 - 4s - loss: 0.3551 - accuracy: 0.8667 - auc_4: 0.9074 - recall_4: 0.8110 - precision_4: 0.9170 - val_loss: 0.2856 - val_accuracy: 0.8845 - val_auc_4: 0.9312 - val_recall_4: 0.8202 - val_precision_4: 0.9437
Epoch 2/50
558/558 - 3s - loss: 0.2701 - accuracy: 0.8943 - auc_4: 0.9344 - recall_4: 0.8232 - precision_4: 0.9632 - val_loss: 0.2682 - val_accuracy: 0.8829 - val_auc_4: 0.9374 - val_recall_4: 0.7892 - val_precision_4: 0.9741
Epoch 3/50
558/558 - 3s - loss: 0.2559 - accuracy: 0.8996 - auc_4: 0.9378 - recall_4: 0.8246 - precision_4: 0.9735 - val_loss: 0.2535 - val_accuracy: 0.8986 - val_auc_4: 0.9389 - val_recall_4: 0.8172 - val_precision_4: 0.9785
Epoch 4/50
558/558 - 3s - loss: 0.2517 - accuracy: 0.9001 - auc_4: 0.9380 - recall_4: 0.8254 - precision_4: 0.9738 - val_loss: 0.2623 - val_accuracy: 0.8966 - val_auc_4: 0.9373 - val_recall_4: 0.8212 - val_precision_4: 0.9693
Epoch 5/50
558/558 - 3s - loss: 0.2445 - accuracy: 0.9023 - auc_4: 0.9407 - recall_4: 0.8259 - precision_4: 0.9784 - val_loss: 0.2548 - val_accuracy: 0.9006 - val_auc_4: 0.9388 - val_recall_4: 0.8262 - val_precision_4: 0.9729
Epoch 6/50
558/558 - 3s - loss: 0.2415 - accuracy: 0.9035 - auc_4: 0.9392 - recall_4: 0.8259 - precision_4: 0.9811 - val_loss: 0.2551 - val_accuracy: 0.8991 - val_auc_4: 0.9364 - val_recall_4: 0.8132 - val_precision_4: 0.9843
Epoch 7/50
558/558 - 3s - loss: 0.2409 - accuracy: 0.9027 - auc_4: 0.9409 - recall_4: 0.8246 - precision_4: 0.9806 - val_loss: 0.2449 - val_accuracy: 0.9062 - val_auc_4: 0.9415 - val_recall_4: 0.8272 - val_precision_4: 0.9845
Epoch 8/50
558/558 - 3s - loss: 0.2371 - accuracy: 0.9057 - auc_4: 0.9405 - recall_4: 0.8272 - precision_4: 0.9846 - val_loss: 0.2453 - val_accuracy: 0.9046 - val_auc_4: 0.9404 - val_recall_4: 0.8222 - val_precision_4: 0.9868
Epoch 9/50
558/558 - 3s - loss: 0.2362 - accuracy: 0.9047 - auc_4: 0.9407 - recall_4: 0.8259 - precision_4: 0.9839 - val_loss: 0.2744 - val_accuracy: 0.9031 - val_auc_4: 0.9345 - val_recall_4: 0.8302 - val_precision_4: 0.9742
Epoch 10/50
558/558 - 3s - loss: 0.2368 - accuracy: 0.9046 - auc_4: 0.9424 - recall_4: 0.8259 - precision_4: 0.9836 - val_loss: 0.2547 - val_accuracy: 0.8956 - val_auc_4: 0.9403 - val_recall_4: 0.8112 - val_precision_4: 0.9783
Epoch 11/50
558/558 - 3s - loss: 0.2339 - accuracy: 0.9061 - auc_4: 0.9407 - recall_4: 0.8273 - precision_4: 0.9854 - val_loss: 0.2356 - val_accuracy: 0.9072 - val_auc_4: 0.9406 - val_recall_4: 0.8282 - val_precision_4: 0.9857
Epoch 12/50
558/558 - 3s - loss: 0.2316 - accuracy: 0.9069 - auc_4: 0.9411 - recall_4: 0.8275 - precision_4: 0.9871 - val_loss: 0.2367 - val_accuracy: 0.9062 - val_auc_4: 0.9409 - val_recall_4: 0.8272 - val_precision_4: 0.9845
Epoch 13/50
558/558 - 3s - loss: 0.2308 - accuracy: 0.9073 - auc_4: 0.9426 - recall_4: 0.8281 - precision_4: 0.9872 - val_loss: 0.2379 - val_accuracy: 0.9062 - val_auc_4: 0.9418 - val_recall_4: 0.8232 - val_precision_4: 0.9892
Epoch 14/50
558/558 - 3s - loss: 0.2297 - accuracy: 0.9067 - auc_4: 0.9431 - recall_4: 0.8266 - precision_4: 0.9876 - val_loss: 0.2383 - val_accuracy: 0.9067 - val_auc_4: 0.9409 - val_recall_4: 0.8302 - val_precision_4: 0.9823
Epoch 15/50
558/558 - 3s - loss: 0.2299 - accuracy: 0.9073 - auc_4: 0.9410 - recall_4: 0.8274 - precision_4: 0.9881 - val_loss: 0.2368 - val_accuracy: 0.9062 - val_auc_4: 0.9410 - val_recall_4: 0.8292 - val_precision_4: 0.9822
Epoch 16/50
558/558 - 3s - loss: 0.2284 - accuracy: 0.9074 - auc_4: 0.9436 - recall_4: 0.8276 - precision_4: 0.9880 - val_loss: 0.2296 - val_accuracy: 0.9097 - val_auc_4: 0.9422 - val_recall_4: 0.8302 - val_precision_4: 0.9893
Epoch 17/50
558/558 - 3s - loss: 0.2265 - accuracy: 0.9082 - auc_4: 0.9422 - recall_4: 0.8281 - precision_4: 0.9894 - val_loss: 0.2281 - val_accuracy: 0.9092 - val_auc_4: 0.9426 - val_recall_4: 0.8292 - val_precision_4: 0.9893
Epoch 18/50
558/558 - 3s - loss: 0.2271 - accuracy: 0.9077 - auc_4: 0.9425 - recall_4: 0.8271 - precision_4: 0.9894 - val_loss: 0.2373 - val_accuracy: 0.9036 - val_auc_4: 0.9407 - val_recall_4: 0.8302 - val_precision_4: 0.9754
Epoch 19/50
558/558 - 3s - loss: 0.2257 - accuracy: 0.9084 - auc_4: 0.9424 - recall_4: 0.8281 - precision_4: 0.9898 - val_loss: 0.2395 - val_accuracy: 0.9062 - val_auc_4: 0.9411 - val_recall_4: 0.8292 - val_precision_4: 0.9822
Epoch 20/50
558/558 - 3s - loss: 0.2263 - accuracy: 0.9086 - auc_4: 0.9419 - recall_4: 0.8278 - precision_4: 0.9906 - val_loss: 0.2606 - val_accuracy: 0.9036 - val_auc_4: 0.9367 - val_recall_4: 0.8302 - val_precision_4: 0.9754
Epoch 21/50
558/558 - 3s - loss: 0.2249 - accuracy: 0.9089 - auc_4: 0.9432 - recall_4: 0.8284 - precision_4: 0.9906 - val_loss: 0.2310 - val_accuracy: 0.9097 - val_auc_4: 0.9425 - val_recall_4: 0.8302 - val_precision_4: 0.9893
Epoch 22/50
558/558 - 3s - loss: 0.2246 - accuracy: 0.9091 - auc_4: 0.9445 - recall_4: 0.8286 - precision_4: 0.9908 - val_loss: 0.2324 - val_accuracy: 0.9077 - val_auc_4: 0.9426 - val_recall_4: 0.8232 - val_precision_4: 0.9928
Epoch 23/50
558/558 - 3s - loss: 0.2229 - accuracy: 0.9097 - auc_4: 0.9445 - recall_4: 0.8286 - precision_4: 0.9923 - val_loss: 0.2326 - val_accuracy: 0.9087 - val_auc_4: 0.9432 - val_recall_4: 0.8302 - val_precision_4: 0.9869
Epoch 24/50
558/558 - 3s - loss: 0.2230 - accuracy: 0.9098 - auc_4: 0.9425 - recall_4: 0.8287 - precision_4: 0.9923 - val_loss: 0.2352 - val_accuracy: 0.9046 - val_auc_4: 0.9405 - val_recall_4: 0.8292 - val_precision_4: 0.9788
Epoch 25/50
558/558 - 3s - loss: 0.2212 - accuracy: 0.9097 - auc_4: 0.9442 - recall_4: 0.8290 - precision_4: 0.9918 - val_loss: 0.2326 - val_accuracy: 0.9087 - val_auc_4: 0.9426 - val_recall_4: 0.8302 - val_precision_4: 0.9869
Epoch 26/50
558/558 - 3s - loss: 0.2206 - accuracy: 0.9105 - auc_4: 0.9428 - recall_4: 0.8291 - precision_4: 0.9936 - val_loss: 0.2279 - val_accuracy: 0.9072 - val_auc_4: 0.9435 - val_recall_4: 0.8252 - val_precision_4: 0.9892
Epoch 27/50
558/558 - 3s - loss: 0.2240 - accuracy: 0.9097 - auc_4: 0.9433 - recall_4: 0.8288 - precision_4: 0.9921 - val_loss: 0.2309 - val_accuracy: 0.9082 - val_auc_4: 0.9425 - val_recall_4: 0.8292 - val_precision_4: 0.9869
Epoch 28/50
558/558 - 3s - loss: 0.2220 - accuracy: 0.9097 - auc_4: 0.9428 - recall_4: 0.8284 - precision_4: 0.9925 - val_loss: 0.2302 - val_accuracy: 0.9092 - val_auc_4: 0.9424 - val_recall_4: 0.8282 - val_precision_4: 0.9904
Epoch 29/50
558/558 - 3s - loss: 0.2204 - accuracy: 0.9109 - auc_4: 0.9421 - recall_4: 0.8292 - precision_4: 0.9943 - val_loss: 0.2292 - val_accuracy: 0.9112 - val_auc_4: 0.9427 - val_recall_4: 0.8302 - val_precision_4: 0.9928
Epoch 30/50
558/558 - 2s - loss: 0.2216 - accuracy: 0.9102 - auc_4: 0.9436 - recall_4: 0.8284 - precision_4: 0.9936 - val_loss: 0.2285 - val_accuracy: 0.9107 - val_auc_4: 0.9436 - val_recall_4: 0.8302 - val_precision_4: 0.9916
Epoch 31/50
558/558 - 3s - loss: 0.2220 - accuracy: 0.9100 - auc_4: 0.9428 - recall_4: 0.8292 - precision_4: 0.9923 - val_loss: 0.2273 - val_accuracy: 0.9112 - val_auc_4: 0.9434 - val_recall_4: 0.8292 - val_precision_4: 0.9940
Epoch 32/50
558/558 - 3s - loss: 0.2207 - accuracy: 0.9106 - auc_4: 0.9438 - recall_4: 0.8288 - precision_4: 0.9942 - val_loss: 0.2296 - val_accuracy: 0.9087 - val_auc_4: 0.9421 - val_recall_4: 0.8282 - val_precision_4: 0.9893
Epoch 33/50
558/558 - 3s - loss: 0.2218 - accuracy: 0.9101 - auc_4: 0.9430 - recall_4: 0.8283 - precision_4: 0.9935 - val_loss: 0.2260 - val_accuracy: 0.9092 - val_auc_4: 0.9442 - val_recall_4: 0.8262 - val_precision_4: 0.9928
Epoch 34/50
558/558 - 3s - loss: 0.2200 - accuracy: 0.9105 - auc_4: 0.9434 - recall_4: 0.8291 - precision_4: 0.9935 - val_loss: 0.2278 - val_accuracy: 0.9112 - val_auc_4: 0.9437 - val_recall_4: 0.8302 - val_precision_4: 0.9928
Epoch 35/50
558/558 - 3s - loss: 0.2200 - accuracy: 0.9109 - auc_4: 0.9428 - recall_4: 0.8291 - precision_4: 0.9946 - val_loss: 0.2250 - val_accuracy: 0.9112 - val_auc_4: 0.9441 - val_recall_4: 0.8302 - val_precision_4: 0.9928
Epoch 36/50
558/558 - 3s - loss: 0.2197 - accuracy: 0.9106 - auc_4: 0.9452 - recall_4: 0.8295 - precision_4: 0.9933 - val_loss: 0.2260 - val_accuracy: 0.9102 - val_auc_4: 0.9426 - val_recall_4: 0.8282 - val_precision_4: 0.9928
Epoch 37/50
558/558 - 3s - loss: 0.2184 - accuracy: 0.9115 - auc_4: 0.9436 - recall_4: 0.8296 - precision_4: 0.9952 - val_loss: 0.2295 - val_accuracy: 0.9117 - val_auc_4: 0.9439 - val_recall_4: 0.8302 - val_precision_4: 0.9940
Epoch 38/50
558/558 - 3s - loss: 0.2207 - accuracy: 0.9109 - auc_4: 0.9432 - recall_4: 0.8288 - precision_4: 0.9947 - val_loss: 0.2255 - val_accuracy: 0.9102 - val_auc_4: 0.9430 - val_recall_4: 0.8302 - val_precision_4: 0.9905
Epoch 39/50
558/558 - 3s - loss: 0.2216 - accuracy: 0.9108 - auc_4: 0.9446 - recall_4: 0.8294 - precision_4: 0.9939 - val_loss: 0.2238 - val_accuracy: 0.9112 - val_auc_4: 0.9436 - val_recall_4: 0.8302 - val_precision_4: 0.9928
Epoch 40/50
558/558 - 3s - loss: 0.2194 - accuracy: 0.9111 - auc_4: 0.9449 - recall_4: 0.8291 - precision_4: 0.9951 - val_loss: 0.2256 - val_accuracy: 0.9107 - val_auc_4: 0.9429 - val_recall_4: 0.8302 - val_precision_4: 0.9916
Epoch 41/50
558/558 - 3s - loss: 0.2204 - accuracy: 0.9105 - auc_4: 0.9438 - recall_4: 0.8291 - precision_4: 0.9935 - val_loss: 0.2232 - val_accuracy: 0.9122 - val_auc_4: 0.9443 - val_recall_4: 0.8302 - val_precision_4: 0.9952
Epoch 42/50
558/558 - 3s - loss: 0.2192 - accuracy: 0.9112 - auc_4: 0.9441 - recall_4: 0.8296 - precision_4: 0.9946 - val_loss: 0.2243 - val_accuracy: 0.9102 - val_auc_4: 0.9441 - val_recall_4: 0.8282 - val_precision_4: 0.9928
Epoch 43/50
558/558 - 3s - loss: 0.2187 - accuracy: 0.9110 - auc_4: 0.9438 - recall_4: 0.8287 - precision_4: 0.9952 - val_loss: 0.2284 - val_accuracy: 0.9092 - val_auc_4: 0.9432 - val_recall_4: 0.8302 - val_precision_4: 0.9881
Epoch 44/50
558/558 - 3s - loss: 0.2176 - accuracy: 0.9117 - auc_4: 0.9450 - recall_4: 0.8298 - precision_4: 0.9955 - val_loss: 0.2369 - val_accuracy: 0.9062 - val_auc_4: 0.9378 - val_recall_4: 0.8202 - val_precision_4: 0.9927
Epoch 45/50
558/558 - 3s - loss: 0.2183 - accuracy: 0.9118 - auc_4: 0.9446 - recall_4: 0.8298 - precision_4: 0.9958 - val_loss: 0.2269 - val_accuracy: 0.9122 - val_auc_4: 0.9437 - val_recall_4: 0.8302 - val_precision_4: 0.9952
Epoch 46/50
558/558 - 3s - loss: 0.2186 - accuracy: 0.9119 - auc_4: 0.9430 - recall_4: 0.8299 - precision_4: 0.9959 - val_loss: 0.2300 - val_accuracy: 0.9082 - val_auc_4: 0.9408 - val_recall_4: 0.8262 - val_precision_4: 0.9904
Epoch 47/50
558/558 - 3s - loss: 0.2173 - accuracy: 0.9118 - auc_4: 0.9437 - recall_4: 0.8295 - precision_4: 0.9960 - val_loss: 0.2218 - val_accuracy: 0.9107 - val_auc_4: 0.9445 - val_recall_4: 0.8292 - val_precision_4: 0.9928
Epoch 48/50
558/558 - 3s - loss: 0.2188 - accuracy: 0.9111 - auc_4: 0.9439 - recall_4: 0.8294 - precision_4: 0.9947 - val_loss: 0.2373 - val_accuracy: 0.9097 - val_auc_4: 0.9426 - val_recall_4: 0.8302 - val_precision_4: 0.9893
Epoch 49/50
558/558 - 3s - loss: 0.2184 - accuracy: 0.9117 - auc_4: 0.9451 - recall_4: 0.8302 - precision_4: 0.9951 - val_loss: 0.2409 - val_accuracy: 0.9072 - val_auc_4: 0.9412 - val_recall_4: 0.8302 - val_precision_4: 0.9834
Epoch 50/50
558/558 - 3s - loss: 0.2160 - accuracy: 0.9121 - auc_4: 0.9454 - recall_4: 0.8299 - precision_4: 0.9963 - val_loss: 0.2239 - val_accuracy: 0.9112 - val_auc_4: 0.9442 - val_recall_4: 0.8302 - val_precision_4: 0.9928
classifier is generated with time step 1
------------------------------------------------------
Measureing infection detector performance on test data
------------------------------------------------------
ps-detector-infec  testset_min:-1.7222021363244926
ps-detector-infec  testset_max:31.46267630066733
-----------------------------------------------------
Per-step infection detector metrics BEFORE relabeling
-----------------------------------------------------
{'auc': 0.5999690755600536, 'accuracy': 0.9503897944720057, 'precision': 0.7647058823529411, 'recall': 0.49056603773584906, 'f1': 0.5977011494252874, 'fp': 48, 'tp': 156, 'fn': 162, 'tn': 3867, 'auprc': 0.36027289633314585, 'precision99': 0.56, 'recall99': 0.0}
----------------------------------------------------
Per-step infection detector metrics AFTER relabeling
----------------------------------------------------
Round 0:
{'auc': 0.619815336915749, 'accuracy': 0.9548783368769195, 'precision': 0.8009478672985783, 'recall': 0.5314465408805031, 'f1': 0.6389413988657845, 'fp': 42, 'tp': 169, 'fn': 149, 'tn': 3873, 'auprc': 0.43806335356604437, 'precision99': 0.99, 'recall99': 0.0}
2023-05-08 03:38:31.525599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:38:32.129423: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 03:38:32.129937: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2023-05-08 03:38:32.158919: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.159100: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 03:38:32.159118: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:38:32.161313: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:38:32.161346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:38:32.176460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 03:38:32.176616: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 03:38:32.177426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 03:38:32.177868: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 03:38:32.177956: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 03:38:32.178041: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.178237: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.178382: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 03:38:32.178568: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX2 FMA
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2023-05-08 03:38:32.180135: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2023-05-08 03:38:32.180218: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.180370: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:41:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.70GiB deviceMemoryBandwidth: 871.81GiB/s
2023-05-08 03:38:32.180388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:38:32.180399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:38:32.180408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:38:32.180417: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2023-05-08 03:38:32.180425: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2023-05-08 03:38:32.180434: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2023-05-08 03:38:32.180442: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2023-05-08 03:38:32.180450: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2023-05-08 03:38:32.180491: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.180657: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.180790: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2023-05-08 03:38:32.180816: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2023-05-08 03:38:32.443037: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2023-05-08 03:38:32.443077: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2023-05-08 03:38:32.443083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2023-05-08 03:38:32.443297: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.443497: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.443669: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:941] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2023-05-08 03:38:32.443817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22414 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:41:00.0, compute capability: 8.6)
WARNING:tensorflow:Layer lstm will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_1 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
2023-05-08 03:38:32.671068: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:116] None of the MLIR optimization passes are enabled (registered 2)
2023-05-08 03:38:32.672032: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 3792855000 Hz
2023-05-08 03:38:33.756979: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2023-05-08 03:38:34.192714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2023-05-08 03:38:34.198978: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
the count of label lines 20084
(20084,)
features len is  41
------------------------------------
Training ps-detector-attack detector
------------------------------------
ps-detector-attack  dataset_min:-3.0454362462748454
ps-detector-attack  dataset_max:138.38713813073164
the info of dataset, (19152, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
539/539 - 5s - loss: 0.1310 - accuracy: 0.9562 - auc: 0.9902 - recall: 0.9598 - precision: 0.9531 - val_loss: 0.0840 - val_accuracy: 0.9687 - val_auc: 0.9948 - val_recall: 0.9904 - val_precision: 0.9478
Epoch 2/50
539/539 - 3s - loss: 0.0635 - accuracy: 0.9758 - auc: 0.9970 - recall: 0.9865 - precision: 0.9660 - val_loss: 0.0714 - val_accuracy: 0.9729 - val_auc: 0.9956 - val_recall: 0.9818 - val_precision: 0.9633
Epoch 3/50
539/539 - 3s - loss: 0.0560 - accuracy: 0.9806 - auc: 0.9974 - recall: 0.9909 - precision: 0.9710 - val_loss: 0.0491 - val_accuracy: 0.9812 - val_auc: 0.9978 - val_recall: 0.9893 - val_precision: 0.9727
Epoch 4/50
539/539 - 3s - loss: 0.0520 - accuracy: 0.9804 - auc: 0.9977 - recall: 0.9905 - precision: 0.9711 - val_loss: 0.0535 - val_accuracy: 0.9781 - val_auc: 0.9980 - val_recall: 0.9818 - val_precision: 0.9735
Epoch 5/50
539/539 - 3s - loss: 0.0500 - accuracy: 0.9814 - auc: 0.9978 - recall: 0.9907 - precision: 0.9726 - val_loss: 0.0435 - val_accuracy: 0.9812 - val_auc: 0.9985 - val_recall: 0.9936 - val_precision: 0.9687
Epoch 6/50
539/539 - 3s - loss: 0.0463 - accuracy: 0.9821 - auc: 0.9983 - recall: 0.9917 - precision: 0.9731 - val_loss: 0.0423 - val_accuracy: 0.9838 - val_auc: 0.9988 - val_recall: 0.9914 - val_precision: 0.9758
Epoch 7/50
539/539 - 3s - loss: 0.0453 - accuracy: 0.9820 - auc: 0.9983 - recall: 0.9912 - precision: 0.9733 - val_loss: 0.0394 - val_accuracy: 0.9864 - val_auc: 0.9990 - val_recall: 0.9925 - val_precision: 0.9799
Epoch 8/50
539/539 - 3s - loss: 0.0448 - accuracy: 0.9832 - auc: 0.9984 - recall: 0.9919 - precision: 0.9751 - val_loss: 0.0426 - val_accuracy: 0.9807 - val_auc: 0.9988 - val_recall: 0.9850 - val_precision: 0.9756
Epoch 9/50
539/539 - 3s - loss: 0.0425 - accuracy: 0.9840 - auc: 0.9985 - recall: 0.9934 - precision: 0.9752 - val_loss: 0.0410 - val_accuracy: 0.9833 - val_auc: 0.9987 - val_recall: 0.9904 - val_precision: 0.9758
Epoch 10/50
539/539 - 3s - loss: 0.0436 - accuracy: 0.9834 - auc: 0.9984 - recall: 0.9926 - precision: 0.9748 - val_loss: 0.0410 - val_accuracy: 0.9849 - val_auc: 0.9988 - val_recall: 0.9925 - val_precision: 0.9768
Epoch 11/50
539/539 - 3s - loss: 0.0422 - accuracy: 0.9838 - auc: 0.9986 - recall: 0.9924 - precision: 0.9757 - val_loss: 0.0441 - val_accuracy: 0.9817 - val_auc: 0.9984 - val_recall: 0.9914 - val_precision: 0.9717
Epoch 12/50
539/539 - 3s - loss: 0.0410 - accuracy: 0.9845 - auc: 0.9985 - recall: 0.9934 - precision: 0.9761 - val_loss: 0.0362 - val_accuracy: 0.9875 - val_auc: 0.9990 - val_recall: 0.9957 - val_precision: 0.9790
Epoch 13/50
539/539 - 3s - loss: 0.0398 - accuracy: 0.9837 - auc: 0.9987 - recall: 0.9918 - precision: 0.9761 - val_loss: 0.0431 - val_accuracy: 0.9833 - val_auc: 0.9987 - val_recall: 0.9904 - val_precision: 0.9758
Epoch 14/50
539/539 - 3s - loss: 0.0390 - accuracy: 0.9844 - auc: 0.9988 - recall: 0.9933 - precision: 0.9760 - val_loss: 0.0407 - val_accuracy: 0.9849 - val_auc: 0.9988 - val_recall: 0.9925 - val_precision: 0.9768
Epoch 15/50
539/539 - 3s - loss: 0.0377 - accuracy: 0.9858 - auc: 0.9988 - recall: 0.9944 - precision: 0.9776 - val_loss: 0.0333 - val_accuracy: 0.9864 - val_auc: 0.9993 - val_recall: 0.9914 - val_precision: 0.9810
Epoch 16/50
539/539 - 3s - loss: 0.0367 - accuracy: 0.9858 - auc: 0.9989 - recall: 0.9934 - precision: 0.9786 - val_loss: 0.0357 - val_accuracy: 0.9870 - val_auc: 0.9989 - val_recall: 0.9925 - val_precision: 0.9810
Epoch 17/50
539/539 - 3s - loss: 0.0369 - accuracy: 0.9859 - auc: 0.9989 - recall: 0.9939 - precision: 0.9784 - val_loss: 0.0484 - val_accuracy: 0.9828 - val_auc: 0.9986 - val_recall: 0.9947 - val_precision: 0.9708
Epoch 18/50
539/539 - 3s - loss: 0.0355 - accuracy: 0.9857 - auc: 0.9989 - recall: 0.9934 - precision: 0.9785 - val_loss: 0.0330 - val_accuracy: 0.9870 - val_auc: 0.9993 - val_recall: 0.9989 - val_precision: 0.9749
Epoch 19/50
539/539 - 3s - loss: 0.0346 - accuracy: 0.9869 - auc: 0.9990 - recall: 0.9951 - precision: 0.9791 - val_loss: 0.0504 - val_accuracy: 0.9838 - val_auc: 0.9973 - val_recall: 0.9893 - val_precision: 0.9778
Epoch 20/50
539/539 - 3s - loss: 0.0335 - accuracy: 0.9870 - auc: 0.9991 - recall: 0.9931 - precision: 0.9812 - val_loss: 0.0320 - val_accuracy: 0.9875 - val_auc: 0.9994 - val_recall: 0.9893 - val_precision: 0.9851
Epoch 21/50
539/539 - 3s - loss: 0.0324 - accuracy: 0.9879 - auc: 0.9991 - recall: 0.9947 - precision: 0.9815 - val_loss: 0.0352 - val_accuracy: 0.9880 - val_auc: 0.9990 - val_recall: 0.9957 - val_precision: 0.9800
Epoch 22/50
539/539 - 3s - loss: 0.0333 - accuracy: 0.9876 - auc: 0.9991 - recall: 0.9946 - precision: 0.9809 - val_loss: 0.0328 - val_accuracy: 0.9885 - val_auc: 0.9992 - val_recall: 0.9914 - val_precision: 0.9851
Epoch 23/50
539/539 - 3s - loss: 0.0325 - accuracy: 0.9881 - auc: 0.9990 - recall: 0.9949 - precision: 0.9816 - val_loss: 0.0336 - val_accuracy: 0.9864 - val_auc: 0.9991 - val_recall: 0.9947 - val_precision: 0.9779
Epoch 24/50
539/539 - 3s - loss: 0.0321 - accuracy: 0.9882 - auc: 0.9991 - recall: 0.9948 - precision: 0.9820 - val_loss: 0.0332 - val_accuracy: 0.9864 - val_auc: 0.9991 - val_recall: 0.9882 - val_precision: 0.9840
Epoch 25/50
539/539 - 3s - loss: 0.0305 - accuracy: 0.9886 - auc: 0.9991 - recall: 0.9943 - precision: 0.9831 - val_loss: 0.0387 - val_accuracy: 0.9870 - val_auc: 0.9986 - val_recall: 0.9989 - val_precision: 0.9749
Epoch 26/50
539/539 - 3s - loss: 0.0307 - accuracy: 0.9886 - auc: 0.9992 - recall: 0.9942 - precision: 0.9832 - val_loss: 0.0331 - val_accuracy: 0.9870 - val_auc: 0.9992 - val_recall: 0.9957 - val_precision: 0.9779
Epoch 27/50
539/539 - 3s - loss: 0.0300 - accuracy: 0.9886 - auc: 0.9992 - recall: 0.9942 - precision: 0.9832 - val_loss: 0.0293 - val_accuracy: 0.9885 - val_auc: 0.9994 - val_recall: 0.9936 - val_precision: 0.9831
Epoch 28/50
539/539 - 3s - loss: 0.0302 - accuracy: 0.9888 - auc: 0.9992 - recall: 0.9946 - precision: 0.9833 - val_loss: 0.0383 - val_accuracy: 0.9843 - val_auc: 0.9991 - val_recall: 0.9840 - val_precision: 0.9840
Epoch 29/50
539/539 - 3s - loss: 0.0305 - accuracy: 0.9891 - auc: 0.9991 - recall: 0.9950 - precision: 0.9834 - val_loss: 0.0281 - val_accuracy: 0.9890 - val_auc: 0.9993 - val_recall: 0.9925 - val_precision: 0.9851
Epoch 30/50
539/539 - 3s - loss: 0.0289 - accuracy: 0.9896 - auc: 0.9993 - recall: 0.9950 - precision: 0.9843 - val_loss: 0.0285 - val_accuracy: 0.9880 - val_auc: 0.9995 - val_recall: 0.9947 - val_precision: 0.9810
Epoch 31/50
539/539 - 3s - loss: 0.0287 - accuracy: 0.9891 - auc: 0.9992 - recall: 0.9949 - precision: 0.9835 - val_loss: 0.0301 - val_accuracy: 0.9875 - val_auc: 0.9993 - val_recall: 0.9925 - val_precision: 0.9820
Epoch 32/50
539/539 - 2s - loss: 0.0292 - accuracy: 0.9895 - auc: 0.9992 - recall: 0.9953 - precision: 0.9840 - val_loss: 0.0266 - val_accuracy: 0.9901 - val_auc: 0.9996 - val_recall: 0.9947 - val_precision: 0.9852
Epoch 33/50
539/539 - 3s - loss: 0.0269 - accuracy: 0.9903 - auc: 0.9993 - recall: 0.9963 - precision: 0.9846 - val_loss: 0.0282 - val_accuracy: 0.9896 - val_auc: 0.9994 - val_recall: 0.9936 - val_precision: 0.9852
Epoch 34/50
539/539 - 3s - loss: 0.0277 - accuracy: 0.9902 - auc: 0.9993 - recall: 0.9962 - precision: 0.9844 - val_loss: 0.0387 - val_accuracy: 0.9849 - val_auc: 0.9991 - val_recall: 0.9850 - val_precision: 0.9840
Epoch 35/50
539/539 - 3s - loss: 0.0281 - accuracy: 0.9904 - auc: 0.9992 - recall: 0.9965 - precision: 0.9846 - val_loss: 0.0268 - val_accuracy: 0.9885 - val_auc: 0.9995 - val_recall: 0.9925 - val_precision: 0.9841
Epoch 36/50
539/539 - 3s - loss: 0.0286 - accuracy: 0.9897 - auc: 0.9993 - recall: 0.9956 - precision: 0.9840 - val_loss: 0.0309 - val_accuracy: 0.9890 - val_auc: 0.9993 - val_recall: 0.9989 - val_precision: 0.9790
Epoch 37/50
539/539 - 3s - loss: 0.0262 - accuracy: 0.9907 - auc: 0.9994 - recall: 0.9961 - precision: 0.9856 - val_loss: 0.0522 - val_accuracy: 0.9854 - val_auc: 0.9973 - val_recall: 0.9861 - val_precision: 0.9840
Epoch 38/50
539/539 - 3s - loss: 0.0262 - accuracy: 0.9903 - auc: 0.9994 - recall: 0.9951 - precision: 0.9856 - val_loss: 0.0213 - val_accuracy: 0.9906 - val_auc: 0.9998 - val_recall: 0.9968 - val_precision: 0.9842
Epoch 39/50
539/539 - 3s - loss: 0.0271 - accuracy: 0.9899 - auc: 0.9994 - recall: 0.9953 - precision: 0.9848 - val_loss: 0.0240 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9989 - val_precision: 0.9842
Epoch 40/50
539/539 - 3s - loss: 0.0254 - accuracy: 0.9908 - auc: 0.9994 - recall: 0.9959 - precision: 0.9858 - val_loss: 0.0250 - val_accuracy: 0.9911 - val_auc: 0.9996 - val_recall: 0.9947 - val_precision: 0.9873
Epoch 41/50
539/539 - 3s - loss: 0.0274 - accuracy: 0.9897 - auc: 0.9993 - recall: 0.9954 - precision: 0.9843 - val_loss: 0.0275 - val_accuracy: 0.9885 - val_auc: 0.9996 - val_recall: 0.9904 - val_precision: 0.9862
Epoch 42/50
539/539 - 3s - loss: 0.0264 - accuracy: 0.9905 - auc: 0.9993 - recall: 0.9961 - precision: 0.9851 - val_loss: 0.0229 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9957 - val_precision: 0.9873
Epoch 43/50
539/539 - 3s - loss: 0.0270 - accuracy: 0.9903 - auc: 0.9994 - recall: 0.9956 - precision: 0.9851 - val_loss: 0.0248 - val_accuracy: 0.9875 - val_auc: 0.9996 - val_recall: 0.9925 - val_precision: 0.9820
Epoch 44/50
539/539 - 3s - loss: 0.0275 - accuracy: 0.9904 - auc: 0.9992 - recall: 0.9955 - precision: 0.9855 - val_loss: 0.0259 - val_accuracy: 0.9896 - val_auc: 0.9994 - val_recall: 0.9914 - val_precision: 0.9872
Epoch 45/50
539/539 - 3s - loss: 0.0253 - accuracy: 0.9908 - auc: 0.9994 - recall: 0.9964 - precision: 0.9855 - val_loss: 0.0196 - val_accuracy: 0.9932 - val_auc: 0.9998 - val_recall: 0.9925 - val_precision: 0.9936
Epoch 46/50
539/539 - 3s - loss: 0.0251 - accuracy: 0.9912 - auc: 0.9994 - recall: 0.9963 - precision: 0.9863 - val_loss: 0.0216 - val_accuracy: 0.9911 - val_auc: 0.9997 - val_recall: 0.9947 - val_precision: 0.9873
Epoch 47/50
539/539 - 3s - loss: 0.0239 - accuracy: 0.9914 - auc: 0.9994 - recall: 0.9964 - precision: 0.9865 - val_loss: 0.0208 - val_accuracy: 0.9916 - val_auc: 0.9997 - val_recall: 0.9957 - val_precision: 0.9873
Epoch 48/50
539/539 - 3s - loss: 0.0231 - accuracy: 0.9910 - auc: 0.9996 - recall: 0.9963 - precision: 0.9859 - val_loss: 0.0210 - val_accuracy: 0.9932 - val_auc: 0.9997 - val_recall: 0.9979 - val_precision: 0.9883
Epoch 49/50
539/539 - 3s - loss: 0.0227 - accuracy: 0.9916 - auc: 0.9995 - recall: 0.9963 - precision: 0.9872 - val_loss: 0.0253 - val_accuracy: 0.9901 - val_auc: 0.9995 - val_recall: 0.9936 - val_precision: 0.9862
Epoch 50/50
539/539 - 3s - loss: 0.0238 - accuracy: 0.9914 - auc: 0.9994 - recall: 0.9963 - precision: 0.9867 - val_loss: 0.0221 - val_accuracy: 0.9916 - val_auc: 0.9996 - val_recall: 0.9947 - val_precision: 0.9883
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_2 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_3 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
---------------------------------------------------------------
Measureing ps-detector-attack detector performance on test data
---------------------------------------------------------------
ps-detector-attack  testset_min:-3.045436243980641
ps-detector-attack  testset_max:32.63330682674631
Metrics: 
 {'auc': 0.9340276541451544, 'accuracy': 0.9848806992676589, 'precision': 0.6766467065868264, 'recall': 0.9186991869918699, 'f1': 0.7793103448275861, 'fp': 54, 'tp': 113, 'fn': 10, 'tn': 4056, 'auprc': 0.9133907977814223, 'precision99': 0.88, 'recall99': 0.0}
features len is  41
-----------------------------------
Training ps-detector-recon detector
-----------------------------------
ps-detector-recon  dataset_min:-2.4484992515578954
ps-detector-recon  dataset_max:96.22275969699034
the info of dataset, (14410, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
406/406 - 3s - loss: 0.3485 - accuracy: 0.8660 - auc_1: 0.8913 - recall_1: 0.9892 - precision_1: 0.7936 - val_loss: 0.3009 - val_accuracy: 0.8765 - val_auc_1: 0.9033 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 2/50
406/406 - 2s - loss: 0.3003 - accuracy: 0.8772 - auc_1: 0.9011 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2984 - val_accuracy: 0.8765 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 3/50
406/406 - 2s - loss: 0.2988 - accuracy: 0.8772 - auc_1: 0.9026 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2983 - val_accuracy: 0.8772 - val_auc_1: 0.9034 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 4/50
406/406 - 2s - loss: 0.2977 - accuracy: 0.8772 - auc_1: 0.9052 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.2986 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 5/50
406/406 - 2s - loss: 0.2976 - accuracy: 0.8772 - auc_1: 0.9045 - recall_1: 0.9958 - precision_1: 0.8048 - val_loss: 0.3027 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 6/50
406/406 - 2s - loss: 0.2964 - accuracy: 0.8774 - auc_1: 0.9032 - recall_1: 0.9965 - precision_1: 0.8048 - val_loss: 0.2995 - val_accuracy: 0.8765 - val_auc_1: 0.9038 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 7/50
406/406 - 2s - loss: 0.2958 - accuracy: 0.8777 - auc_1: 0.9018 - recall_1: 0.9969 - precision_1: 0.8050 - val_loss: 0.2981 - val_accuracy: 0.8765 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 8/50
406/406 - 2s - loss: 0.2958 - accuracy: 0.8780 - auc_1: 0.9019 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2972 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 9/50
406/406 - 2s - loss: 0.2951 - accuracy: 0.8779 - auc_1: 0.9041 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2966 - val_accuracy: 0.8772 - val_auc_1: 0.9031 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 10/50
406/406 - 2s - loss: 0.2949 - accuracy: 0.8779 - auc_1: 0.9028 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2952 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 11/50
406/406 - 2s - loss: 0.2947 - accuracy: 0.8779 - auc_1: 0.9022 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2979 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 12/50
406/406 - 2s - loss: 0.2943 - accuracy: 0.8780 - auc_1: 0.9020 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2977 - val_accuracy: 0.8765 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 13/50
406/406 - 2s - loss: 0.2941 - accuracy: 0.8779 - auc_1: 0.9017 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 14/50
406/406 - 2s - loss: 0.2929 - accuracy: 0.8779 - auc_1: 0.9045 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2981 - val_accuracy: 0.8772 - val_auc_1: 0.9034 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 15/50
406/406 - 2s - loss: 0.2932 - accuracy: 0.8779 - auc_1: 0.9041 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2987 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 16/50
406/406 - 2s - loss: 0.2935 - accuracy: 0.8779 - auc_1: 0.9033 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2954 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 17/50
406/406 - 2s - loss: 0.2933 - accuracy: 0.8781 - auc_1: 0.9020 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2951 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 18/50
406/406 - 2s - loss: 0.2922 - accuracy: 0.8780 - auc_1: 0.9047 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2966 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 19/50
406/406 - 2s - loss: 0.2923 - accuracy: 0.8779 - auc_1: 0.9048 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2949 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 20/50
406/406 - 2s - loss: 0.2928 - accuracy: 0.8780 - auc_1: 0.9033 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2978 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 21/50
406/406 - 2s - loss: 0.2920 - accuracy: 0.8779 - auc_1: 0.9040 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2957 - val_accuracy: 0.8765 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8031
Epoch 22/50
406/406 - 2s - loss: 0.2925 - accuracy: 0.8779 - auc_1: 0.9028 - recall_1: 0.9974 - precision_1: 0.8050 - val_loss: 0.2963 - val_accuracy: 0.8772 - val_auc_1: 0.9035 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 23/50
406/406 - 2s - loss: 0.2929 - accuracy: 0.8779 - auc_1: 0.9036 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2939 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 24/50
406/406 - 2s - loss: 0.2920 - accuracy: 0.8779 - auc_1: 0.9031 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2941 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 25/50
406/406 - 2s - loss: 0.2927 - accuracy: 0.8780 - auc_1: 0.9029 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2955 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 26/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8780 - auc_1: 0.9051 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2953 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 27/50
406/406 - 2s - loss: 0.2916 - accuracy: 0.8780 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 28/50
406/406 - 2s - loss: 0.2913 - accuracy: 0.8781 - auc_1: 0.9053 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2940 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 29/50
406/406 - 2s - loss: 0.2914 - accuracy: 0.8779 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2939 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 30/50
406/406 - 2s - loss: 0.2911 - accuracy: 0.8781 - auc_1: 0.9060 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2967 - val_accuracy: 0.8772 - val_auc_1: 0.9039 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 31/50
406/406 - 2s - loss: 0.2922 - accuracy: 0.8779 - auc_1: 0.9027 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2933 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 32/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8780 - auc_1: 0.9057 - recall_1: 0.9974 - precision_1: 0.8052 - val_loss: 0.2936 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 33/50
406/406 - 2s - loss: 0.2908 - accuracy: 0.8783 - auc_1: 0.9052 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2938 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 34/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8779 - auc_1: 0.9058 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2978 - val_accuracy: 0.8772 - val_auc_1: 0.9034 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 35/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8779 - auc_1: 0.9026 - recall_1: 0.9974 - precision_1: 0.8051 - val_loss: 0.2949 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 36/50
406/406 - 2s - loss: 0.2907 - accuracy: 0.8784 - auc_1: 0.9056 - recall_1: 0.9974 - precision_1: 0.8057 - val_loss: 0.2918 - val_accuracy: 0.8806 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 37/50
406/406 - 2s - loss: 0.2909 - accuracy: 0.8781 - auc_1: 0.9045 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2921 - val_accuracy: 0.8772 - val_auc_1: 0.9040 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 38/50
406/406 - 2s - loss: 0.2907 - accuracy: 0.8783 - auc_1: 0.9038 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2934 - val_accuracy: 0.8772 - val_auc_1: 0.9032 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 39/50
406/406 - 2s - loss: 0.2903 - accuracy: 0.8781 - auc_1: 0.9026 - recall_1: 0.9974 - precision_1: 0.8053 - val_loss: 0.2928 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 40/50
406/406 - 2s - loss: 0.2906 - accuracy: 0.8782 - auc_1: 0.9052 - recall_1: 0.9974 - precision_1: 0.8054 - val_loss: 0.2937 - val_accuracy: 0.8772 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 41/50
406/406 - 2s - loss: 0.2902 - accuracy: 0.8783 - auc_1: 0.9035 - recall_1: 0.9974 - precision_1: 0.8056 - val_loss: 0.2905 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 42/50
406/406 - 2s - loss: 0.2891 - accuracy: 0.8787 - auc_1: 0.9066 - recall_1: 0.9974 - precision_1: 0.8061 - val_loss: 0.2928 - val_accuracy: 0.8772 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8040
Epoch 43/50
406/406 - 2s - loss: 0.2894 - accuracy: 0.8786 - auc_1: 0.9040 - recall_1: 0.9974 - precision_1: 0.8060 - val_loss: 0.2904 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 44/50
406/406 - 2s - loss: 0.2894 - accuracy: 0.8786 - auc_1: 0.9063 - recall_1: 0.9974 - precision_1: 0.8060 - val_loss: 0.2926 - val_accuracy: 0.8806 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 45/50
406/406 - 2s - loss: 0.2880 - accuracy: 0.8797 - auc_1: 0.9058 - recall_1: 0.9977 - precision_1: 0.8072 - val_loss: 0.2920 - val_accuracy: 0.8806 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 46/50
406/406 - 2s - loss: 0.2883 - accuracy: 0.8800 - auc_1: 0.9052 - recall_1: 0.9974 - precision_1: 0.8078 - val_loss: 0.2900 - val_accuracy: 0.8806 - val_auc_1: 0.9036 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 47/50
406/406 - 2s - loss: 0.2871 - accuracy: 0.8803 - auc_1: 0.9026 - recall_1: 0.9975 - precision_1: 0.8081 - val_loss: 0.2875 - val_accuracy: 0.8813 - val_auc_1: 0.9042 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 48/50
406/406 - 2s - loss: 0.2879 - accuracy: 0.8804 - auc_1: 0.9045 - recall_1: 0.9975 - precision_1: 0.8082 - val_loss: 0.2880 - val_accuracy: 0.8806 - val_auc_1: 0.9043 - val_recall_1: 0.9972 - val_precision_1: 0.8086
Epoch 49/50
406/406 - 2s - loss: 0.2870 - accuracy: 0.8803 - auc_1: 0.9049 - recall_1: 0.9974 - precision_1: 0.8081 - val_loss: 0.2872 - val_accuracy: 0.8813 - val_auc_1: 0.9043 - val_recall_1: 0.9972 - val_precision_1: 0.8095
Epoch 50/50
406/406 - 2s - loss: 0.2881 - accuracy: 0.8799 - auc_1: 0.9025 - recall_1: 0.9974 - precision_1: 0.8076 - val_loss: 0.2883 - val_accuracy: 0.8806 - val_auc_1: 0.9043 - val_recall_1: 0.9972 - val_precision_1: 0.8086
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_4 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_5 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-recon detector performance on test data
--------------------------------------------------------------
ps-detector-recon  testset_min:-2.4484992496151756
ps-detector-recon  testset_max:28.32679285519669
Metrics: 
 {'auc': 0.9124489880832564, 'accuracy': 0.9593668792818332, 'precision': 0.9506670803599131, 'recall': 0.9957751056223595, 'f1': 0.9726984126984127, 'fp': 159, 'tp': 3064, 'fn': 13, 'tn': 997, 'auprc': 0.8881319766966768, 'precision99': 0.74, 'recall99': 0.74}
features len is  41
-----------------------------------
Training ps-detector-infec detector
-----------------------------------
ps-detector-infec  dataset_min:-2.3799714775110803
ps-detector-infec  dataset_max:140.77286670370265
the info of dataset, (19818, 1, 41)
shuffle is enabled for training
Early stopping: NO.
Epoch 1/50
558/558 - 4s - loss: 0.3814 - accuracy: 0.8532 - auc_2: 0.8954 - recall_2: 0.8026 - precision_2: 0.8932 - val_loss: 0.3110 - val_accuracy: 0.8870 - val_auc_2: 0.9227 - val_recall_2: 0.8169 - val_precision_2: 0.9481
Epoch 2/50
558/558 - 3s - loss: 0.3005 - accuracy: 0.8857 - auc_2: 0.9252 - recall_2: 0.8200 - precision_2: 0.9444 - val_loss: 0.2878 - val_accuracy: 0.8935 - val_auc_2: 0.9287 - val_recall_2: 0.8189 - val_precision_2: 0.9606
Epoch 3/50
558/558 - 3s - loss: 0.2830 - accuracy: 0.8920 - auc_2: 0.9305 - recall_2: 0.8219 - precision_2: 0.9562 - val_loss: 0.2728 - val_accuracy: 0.8951 - val_auc_2: 0.9329 - val_recall_2: 0.8230 - val_precision_2: 0.9597
Epoch 4/50
558/558 - 3s - loss: 0.2794 - accuracy: 0.8926 - auc_2: 0.9324 - recall_2: 0.8218 - precision_2: 0.9576 - val_loss: 0.2713 - val_accuracy: 0.8951 - val_auc_2: 0.9316 - val_recall_2: 0.8260 - val_precision_2: 0.9564
Epoch 5/50
558/558 - 3s - loss: 0.2738 - accuracy: 0.8945 - auc_2: 0.9324 - recall_2: 0.8223 - precision_2: 0.9614 - val_loss: 0.2696 - val_accuracy: 0.8961 - val_auc_2: 0.9332 - val_recall_2: 0.8260 - val_precision_2: 0.9587
Epoch 6/50
558/558 - 3s - loss: 0.2695 - accuracy: 0.8963 - auc_2: 0.9367 - recall_2: 0.8238 - precision_2: 0.9637 - val_loss: 0.2679 - val_accuracy: 0.8976 - val_auc_2: 0.9319 - val_recall_2: 0.8260 - val_precision_2: 0.9621
Epoch 7/50
558/558 - 3s - loss: 0.2670 - accuracy: 0.8966 - auc_2: 0.9358 - recall_2: 0.8234 - precision_2: 0.9648 - val_loss: 0.2623 - val_accuracy: 0.9036 - val_auc_2: 0.9345 - val_recall_2: 0.8250 - val_precision_2: 0.9771
Epoch 8/50
558/558 - 3s - loss: 0.2669 - accuracy: 0.8976 - auc_2: 0.9342 - recall_2: 0.8239 - precision_2: 0.9666 - val_loss: 0.2610 - val_accuracy: 0.8986 - val_auc_2: 0.9346 - val_recall_2: 0.8260 - val_precision_2: 0.9644
Epoch 9/50
558/558 - 3s - loss: 0.2641 - accuracy: 0.8975 - auc_2: 0.9347 - recall_2: 0.8227 - precision_2: 0.9676 - val_loss: 0.2648 - val_accuracy: 0.8961 - val_auc_2: 0.9344 - val_recall_2: 0.8230 - val_precision_2: 0.9620
Epoch 10/50
558/558 - 3s - loss: 0.2630 - accuracy: 0.8981 - auc_2: 0.9359 - recall_2: 0.8235 - precision_2: 0.9680 - val_loss: 0.2631 - val_accuracy: 0.8991 - val_auc_2: 0.9341 - val_recall_2: 0.8260 - val_precision_2: 0.9655
Epoch 11/50
558/558 - 3s - loss: 0.2623 - accuracy: 0.8991 - auc_2: 0.9344 - recall_2: 0.8241 - precision_2: 0.9698 - val_loss: 0.2587 - val_accuracy: 0.9001 - val_auc_2: 0.9354 - val_recall_2: 0.8260 - val_precision_2: 0.9678
Epoch 12/50
558/558 - 3s - loss: 0.2595 - accuracy: 0.8996 - auc_2: 0.9373 - recall_2: 0.8243 - precision_2: 0.9706 - val_loss: 0.2786 - val_accuracy: 0.8961 - val_auc_2: 0.9314 - val_recall_2: 0.8260 - val_precision_2: 0.9587
Epoch 13/50
558/558 - 3s - loss: 0.2596 - accuracy: 0.8994 - auc_2: 0.9366 - recall_2: 0.8242 - precision_2: 0.9702 - val_loss: 0.2669 - val_accuracy: 0.8961 - val_auc_2: 0.9337 - val_recall_2: 0.8250 - val_precision_2: 0.9598
Epoch 14/50
558/558 - 3s - loss: 0.2573 - accuracy: 0.9003 - auc_2: 0.9379 - recall_2: 0.8251 - precision_2: 0.9713 - val_loss: 0.2602 - val_accuracy: 0.9006 - val_auc_2: 0.9358 - val_recall_2: 0.8260 - val_precision_2: 0.9690
Epoch 15/50
558/558 - 3s - loss: 0.2565 - accuracy: 0.9012 - auc_2: 0.9363 - recall_2: 0.8257 - precision_2: 0.9727 - val_loss: 0.2567 - val_accuracy: 0.9016 - val_auc_2: 0.9353 - val_recall_2: 0.8260 - val_precision_2: 0.9713
Epoch 16/50
558/558 - 3s - loss: 0.2549 - accuracy: 0.9010 - auc_2: 0.9380 - recall_2: 0.8251 - precision_2: 0.9730 - val_loss: 0.2559 - val_accuracy: 0.8986 - val_auc_2: 0.9365 - val_recall_2: 0.8149 - val_precision_2: 0.9768
Epoch 17/50
558/558 - 3s - loss: 0.2537 - accuracy: 0.9021 - auc_2: 0.9368 - recall_2: 0.8260 - precision_2: 0.9744 - val_loss: 0.2878 - val_accuracy: 0.8824 - val_auc_2: 0.9241 - val_recall_2: 0.7823 - val_precision_2: 0.9759
Epoch 18/50
558/558 - 3s - loss: 0.2544 - accuracy: 0.9012 - auc_2: 0.9382 - recall_2: 0.8247 - precision_2: 0.9738 - val_loss: 0.2509 - val_accuracy: 0.9041 - val_auc_2: 0.9372 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 19/50
558/558 - 3s - loss: 0.2523 - accuracy: 0.9021 - auc_2: 0.9389 - recall_2: 0.8252 - precision_2: 0.9752 - val_loss: 0.2667 - val_accuracy: 0.9001 - val_auc_2: 0.9340 - val_recall_2: 0.8179 - val_precision_2: 0.9769
Epoch 20/50
558/558 - 3s - loss: 0.2543 - accuracy: 0.9017 - auc_2: 0.9372 - recall_2: 0.8252 - precision_2: 0.9743 - val_loss: 0.2557 - val_accuracy: 0.9041 - val_auc_2: 0.9368 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 21/50
558/558 - 3s - loss: 0.2510 - accuracy: 0.9014 - auc_2: 0.9384 - recall_2: 0.8244 - precision_2: 0.9746 - val_loss: 0.2541 - val_accuracy: 0.9051 - val_auc_2: 0.9365 - val_recall_2: 0.8240 - val_precision_2: 0.9818
Epoch 22/50
558/558 - 3s - loss: 0.2499 - accuracy: 0.9023 - auc_2: 0.9394 - recall_2: 0.8246 - precision_2: 0.9766 - val_loss: 0.2489 - val_accuracy: 0.9057 - val_auc_2: 0.9376 - val_recall_2: 0.8260 - val_precision_2: 0.9807
Epoch 23/50
558/558 - 3s - loss: 0.2506 - accuracy: 0.9023 - auc_2: 0.9382 - recall_2: 0.8256 - precision_2: 0.9755 - val_loss: 0.2594 - val_accuracy: 0.9031 - val_auc_2: 0.9360 - val_recall_2: 0.8260 - val_precision_2: 0.9748
Epoch 24/50
558/558 - 3s - loss: 0.2504 - accuracy: 0.9026 - auc_2: 0.9391 - recall_2: 0.8253 - precision_2: 0.9764 - val_loss: 0.2556 - val_accuracy: 0.9016 - val_auc_2: 0.9343 - val_recall_2: 0.8260 - val_precision_2: 0.9713
Epoch 25/50
558/558 - 3s - loss: 0.2487 - accuracy: 0.9029 - auc_2: 0.9399 - recall_2: 0.8249 - precision_2: 0.9776 - val_loss: 0.2481 - val_accuracy: 0.9062 - val_auc_2: 0.9388 - val_recall_2: 0.8240 - val_precision_2: 0.9842
Epoch 26/50
558/558 - 3s - loss: 0.2489 - accuracy: 0.9032 - auc_2: 0.9391 - recall_2: 0.8257 - precision_2: 0.9773 - val_loss: 0.2565 - val_accuracy: 0.9026 - val_auc_2: 0.9365 - val_recall_2: 0.8260 - val_precision_2: 0.9736
Epoch 27/50
558/558 - 3s - loss: 0.2473 - accuracy: 0.9038 - auc_2: 0.9403 - recall_2: 0.8257 - precision_2: 0.9788 - val_loss: 0.2546 - val_accuracy: 0.9041 - val_auc_2: 0.9373 - val_recall_2: 0.8250 - val_precision_2: 0.9783
Epoch 28/50
558/558 - 3s - loss: 0.2469 - accuracy: 0.9044 - auc_2: 0.9403 - recall_2: 0.8269 - precision_2: 0.9787 - val_loss: 0.2658 - val_accuracy: 0.8935 - val_auc_2: 0.9373 - val_recall_2: 0.8006 - val_precision_2: 0.9813
Epoch 29/50
558/558 - 3s - loss: 0.2453 - accuracy: 0.9047 - auc_2: 0.9398 - recall_2: 0.8269 - precision_2: 0.9794 - val_loss: 0.2537 - val_accuracy: 0.9026 - val_auc_2: 0.9371 - val_recall_2: 0.8220 - val_precision_2: 0.9782
Epoch 30/50
558/558 - 3s - loss: 0.2454 - accuracy: 0.9044 - auc_2: 0.9392 - recall_2: 0.8261 - precision_2: 0.9795 - val_loss: 0.2496 - val_accuracy: 0.9041 - val_auc_2: 0.9375 - val_recall_2: 0.8260 - val_precision_2: 0.9771
Epoch 31/50
558/558 - 3s - loss: 0.2469 - accuracy: 0.9040 - auc_2: 0.9388 - recall_2: 0.8268 - precision_2: 0.9780 - val_loss: 0.2487 - val_accuracy: 0.9067 - val_auc_2: 0.9386 - val_recall_2: 0.8240 - val_precision_2: 0.9854
Epoch 32/50
558/558 - 3s - loss: 0.2456 - accuracy: 0.9042 - auc_2: 0.9405 - recall_2: 0.8267 - precision_2: 0.9786 - val_loss: 0.2455 - val_accuracy: 0.9062 - val_auc_2: 0.9379 - val_recall_2: 0.8250 - val_precision_2: 0.9830
Epoch 33/50
558/558 - 3s - loss: 0.2462 - accuracy: 0.9046 - auc_2: 0.9383 - recall_2: 0.8266 - precision_2: 0.9797 - val_loss: 0.2469 - val_accuracy: 0.9067 - val_auc_2: 0.9375 - val_recall_2: 0.8260 - val_precision_2: 0.9831
Epoch 34/50
558/558 - 3s - loss: 0.2464 - accuracy: 0.9041 - auc_2: 0.9405 - recall_2: 0.8261 - precision_2: 0.9790 - val_loss: 0.2535 - val_accuracy: 0.9021 - val_auc_2: 0.9378 - val_recall_2: 0.8260 - val_precision_2: 0.9725
Epoch 35/50
558/558 - 3s - loss: 0.2449 - accuracy: 0.9040 - auc_2: 0.9407 - recall_2: 0.8261 - precision_2: 0.9788 - val_loss: 0.2432 - val_accuracy: 0.9072 - val_auc_2: 0.9384 - val_recall_2: 0.8250 - val_precision_2: 0.9854
Epoch 36/50
558/558 - 3s - loss: 0.2445 - accuracy: 0.9041 - auc_2: 0.9397 - recall_2: 0.8256 - precision_2: 0.9797 - val_loss: 0.2488 - val_accuracy: 0.9062 - val_auc_2: 0.9374 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 37/50
558/558 - 3s - loss: 0.2437 - accuracy: 0.9047 - auc_2: 0.9397 - recall_2: 0.8270 - precision_2: 0.9793 - val_loss: 0.2469 - val_accuracy: 0.9082 - val_auc_2: 0.9384 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 38/50
558/558 - 3s - loss: 0.2432 - accuracy: 0.9050 - auc_2: 0.9403 - recall_2: 0.8268 - precision_2: 0.9802 - val_loss: 0.2576 - val_accuracy: 0.9046 - val_auc_2: 0.9379 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 39/50
558/558 - 3s - loss: 0.2449 - accuracy: 0.9037 - auc_2: 0.9382 - recall_2: 0.8256 - precision_2: 0.9786 - val_loss: 0.2567 - val_accuracy: 0.9046 - val_auc_2: 0.9361 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 40/50
558/558 - 3s - loss: 0.2430 - accuracy: 0.9055 - auc_2: 0.9406 - recall_2: 0.8277 - precision_2: 0.9804 - val_loss: 0.2459 - val_accuracy: 0.9062 - val_auc_2: 0.9384 - val_recall_2: 0.8240 - val_precision_2: 0.9842
Epoch 41/50
558/558 - 3s - loss: 0.2422 - accuracy: 0.9049 - auc_2: 0.9415 - recall_2: 0.8280 - precision_2: 0.9786 - val_loss: 0.2529 - val_accuracy: 0.9041 - val_auc_2: 0.9375 - val_recall_2: 0.8220 - val_precision_2: 0.9818
Epoch 42/50
558/558 - 3s - loss: 0.2432 - accuracy: 0.9045 - auc_2: 0.9414 - recall_2: 0.8261 - precision_2: 0.9799 - val_loss: 0.2487 - val_accuracy: 0.9062 - val_auc_2: 0.9378 - val_recall_2: 0.8260 - val_precision_2: 0.9819
Epoch 43/50
558/558 - 3s - loss: 0.2417 - accuracy: 0.9053 - auc_2: 0.9407 - recall_2: 0.8269 - precision_2: 0.9809 - val_loss: 0.2402 - val_accuracy: 0.9087 - val_auc_2: 0.9391 - val_recall_2: 0.8260 - val_precision_2: 0.9878
Epoch 44/50
558/558 - 3s - loss: 0.2426 - accuracy: 0.9054 - auc_2: 0.9409 - recall_2: 0.8268 - precision_2: 0.9811 - val_loss: 0.2623 - val_accuracy: 0.9046 - val_auc_2: 0.9349 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 45/50
558/558 - 3s - loss: 0.2420 - accuracy: 0.9058 - auc_2: 0.9400 - recall_2: 0.8279 - precision_2: 0.9809 - val_loss: 0.2541 - val_accuracy: 0.9046 - val_auc_2: 0.9363 - val_recall_2: 0.8260 - val_precision_2: 0.9783
Epoch 46/50
558/558 - 3s - loss: 0.2430 - accuracy: 0.9055 - auc_2: 0.9411 - recall_2: 0.8272 - precision_2: 0.9810 - val_loss: 0.2432 - val_accuracy: 0.9082 - val_auc_2: 0.9402 - val_recall_2: 0.8250 - val_precision_2: 0.9878
Epoch 47/50
558/558 - 3s - loss: 0.2409 - accuracy: 0.9056 - auc_2: 0.9387 - recall_2: 0.8269 - precision_2: 0.9815 - val_loss: 0.2412 - val_accuracy: 0.9082 - val_auc_2: 0.9400 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 48/50
558/558 - 3s - loss: 0.2406 - accuracy: 0.9052 - auc_2: 0.9397 - recall_2: 0.8286 - precision_2: 0.9787 - val_loss: 0.2416 - val_accuracy: 0.9082 - val_auc_2: 0.9395 - val_recall_2: 0.8260 - val_precision_2: 0.9866
Epoch 49/50
558/558 - 3s - loss: 0.2405 - accuracy: 0.9057 - auc_2: 0.9422 - recall_2: 0.8267 - precision_2: 0.9820 - val_loss: 0.2493 - val_accuracy: 0.9072 - val_auc_2: 0.9371 - val_recall_2: 0.8260 - val_precision_2: 0.9842
Epoch 50/50
558/558 - 3s - loss: 0.2396 - accuracy: 0.9056 - auc_2: 0.9430 - recall_2: 0.8271 - precision_2: 0.9813 - val_loss: 0.2531 - val_accuracy: 0.9057 - val_auc_2: 0.9367 - val_recall_2: 0.8260 - val_precision_2: 0.9807
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_6 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
WARNING:tensorflow:Layer lstm_7 will not use cuDNN kernel since it doesn't meet the cuDNN kernel criteria. It will use generic GPU kernel as fallback when running on GPU
classifier is generated with time step 1
--------------------------------------------------------------
Measureing ps-detector-infec detector performance on test data
--------------------------------------------------------------
ps-detector-infec  testset_min:-1.7222021363244926
ps-detector-infec  testset_max:31.46267630066733
Metrics: 
 {'auc': 0.6072580062170172, 'accuracy': 0.9544058587290338, 'precision': 0.817258883248731, 'recall': 0.5062893081761006, 'f1': 0.6252427184466018, 'fp': 36, 'tp': 161, 'fn': 157, 'tn': 3879, 'auprc': 0.36810020364139967, 'precision99': 0.45, 'recall99': 0.0}
proportion of infection events tagged by ps-detector-attack detector:  0.039913210212937734
proportion of infection events tagged by ps-detector-recon detector:  0.48365122615803813
proportion of infection events tagged by ps-detector-infec detector:  0.42168735492986176
proportion of events estimated to be benign :  0.0686749419719447
Permute truncated is False
Use prob embedding is False
Permute Truncated is disabled
Model: "model"
__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to                     
==================================================================================================
input_1 (InputLayer)            [(None, 10, 4)]      0                                            
__________________________________________________________________________________________________
lstm_6 (LSTM)                   [(None, 10, 128), (N 68096       input_1[0][0]                    
__________________________________________________________________________________________________
batch_normalization (BatchNorma (None, 128)          512         lstm_6[0][1]                     
__________________________________________________________________________________________________
repeat_vector (RepeatVector)    (None, 10, 128)      0           batch_normalization[0][0]        
__________________________________________________________________________________________________
batch_normalization_1 (BatchNor (None, 128)          512         lstm_6[0][2]                     
__________________________________________________________________________________________________
lstm_7 (LSTM)                   (None, 10, 128)      131584      repeat_vector[0][0]              
                                                                 batch_normalization[0][0]        
                                                                 batch_normalization_1[0][0]      
__________________________________________________________________________________________________
dot (Dot)                       (None, 10, 10)       0           lstm_7[0][0]                     
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
activation (Activation)         (None, 10, 10)       0           dot[0][0]                        
__________________________________________________________________________________________________
dot_1 (Dot)                     (None, 10, 128)      0           activation[0][0]                 
                                                                 lstm_6[0][0]                     
__________________________________________________________________________________________________
batch_normalization_2 (BatchNor (None, 10, 128)      512         dot_1[0][0]                      
__________________________________________________________________________________________________
concatenate (Concatenate)       (None, 10, 256)      0           batch_normalization_2[0][0]      
                                                                 lstm_7[0][0]                     
__________________________________________________________________________________________________
time_distributed (TimeDistribut (None, 10, 1)        257         concatenate[0][0]                
__________________________________________________________________________________________________
activation_1 (Activation)       (None, 10, 1)        0           time_distributed[0][0]           
==================================================================================================
Total params: 201,473
Trainable params: 200,705
Non-trainable params: 768
__________________________________________________________________________________________________
Epoch 1/30
159/159 - 8s - loss: 0.0548 - accuracy: 0.9843 - auc_3: 0.9959 - recall_3: 0.9838 - precision_3: 0.9848 - val_loss: 0.0882 - val_accuracy: 0.9829 - val_auc_3: 0.9982 - val_recall_3: 0.9707 - val_precision_3: 0.9949
Epoch 2/30
159/159 - 6s - loss: 0.0353 - accuracy: 0.9923 - auc_3: 0.9970 - recall_3: 0.9931 - precision_3: 0.9916 - val_loss: 0.0223 - val_accuracy: 0.9941 - val_auc_3: 0.9987 - val_recall_3: 0.9934 - val_precision_3: 0.9948
Epoch 3/30
159/159 - 6s - loss: 0.0309 - accuracy: 0.9931 - auc_3: 0.9974 - recall_3: 0.9927 - precision_3: 0.9935 - val_loss: 0.1042 - val_accuracy: 0.9618 - val_auc_3: 0.9979 - val_recall_3: 0.9259 - val_precision_3: 0.9975
Epoch 4/30
159/159 - 6s - loss: 0.0306 - accuracy: 0.9932 - auc_3: 0.9972 - recall_3: 0.9930 - precision_3: 0.9934 - val_loss: 0.0540 - val_accuracy: 0.9868 - val_auc_3: 0.9987 - val_recall_3: 0.9749 - val_precision_3: 0.9986
Epoch 5/30
159/159 - 6s - loss: 0.0318 - accuracy: 0.9931 - auc_3: 0.9972 - recall_3: 0.9931 - precision_3: 0.9931 - val_loss: 0.0739 - val_accuracy: 0.9849 - val_auc_3: 0.9975 - val_recall_3: 0.9708 - val_precision_3: 0.9989
Epoch 6/30
159/159 - 6s - loss: 0.0280 - accuracy: 0.9935 - auc_3: 0.9977 - recall_3: 0.9931 - precision_3: 0.9939 - val_loss: 0.0222 - val_accuracy: 0.9948 - val_auc_3: 0.9989 - val_recall_3: 0.9928 - val_precision_3: 0.9968
Epoch 7/30
159/159 - 6s - loss: 0.0286 - accuracy: 0.9934 - auc_3: 0.9976 - recall_3: 0.9925 - precision_3: 0.9944 - val_loss: 0.0505 - val_accuracy: 0.9937 - val_auc_3: 0.9989 - val_recall_3: 0.9890 - val_precision_3: 0.9985
Epoch 8/30
159/159 - 6s - loss: 0.0286 - accuracy: 0.9933 - auc_3: 0.9977 - recall_3: 0.9927 - precision_3: 0.9938 - val_loss: 0.0319 - val_accuracy: 0.9943 - val_auc_3: 0.9990 - val_recall_3: 0.9902 - val_precision_3: 0.9984
Epoch 9/30
159/159 - 6s - loss: 0.0297 - accuracy: 0.9935 - auc_3: 0.9975 - recall_3: 0.9929 - precision_3: 0.9942 - val_loss: 0.0276 - val_accuracy: 0.9947 - val_auc_3: 0.9990 - val_recall_3: 0.9927 - val_precision_3: 0.9966
Epoch 10/30
159/159 - 6s - loss: 0.0276 - accuracy: 0.9936 - auc_3: 0.9978 - recall_3: 0.9923 - precision_3: 0.9949 - val_loss: 0.0310 - val_accuracy: 0.9949 - val_auc_3: 0.9991 - val_recall_3: 0.9920 - val_precision_3: 0.9978
Epoch 11/30
159/159 - 6s - loss: 0.0282 - accuracy: 0.9933 - auc_3: 0.9978 - recall_3: 0.9923 - precision_3: 0.9943 - val_loss: 0.0746 - val_accuracy: 0.9945 - val_auc_3: 0.9988 - val_recall_3: 0.9906 - val_precision_3: 0.9984
Epoch 12/30
159/159 - 6s - loss: 0.0273 - accuracy: 0.9936 - auc_3: 0.9980 - recall_3: 0.9927 - precision_3: 0.9945 - val_loss: 0.0450 - val_accuracy: 0.9943 - val_auc_3: 0.9989 - val_recall_3: 0.9903 - val_precision_3: 0.9984
Epoch 13/30
159/159 - 6s - loss: 0.0272 - accuracy: 0.9938 - auc_3: 0.9979 - recall_3: 0.9927 - precision_3: 0.9948 - val_loss: 0.0916 - val_accuracy: 0.9949 - val_auc_3: 0.9991 - val_recall_3: 0.9914 - val_precision_3: 0.9984
Epoch 14/30
159/159 - 6s - loss: 0.0269 - accuracy: 0.9936 - auc_3: 0.9981 - recall_3: 0.9929 - precision_3: 0.9943 - val_loss: 0.2428 - val_accuracy: 0.8913 - val_auc_3: 0.9990 - val_recall_3: 0.7827 - val_precision_3: 1.0000
Epoch 15/30
159/159 - 6s - loss: 0.0250 - accuracy: 0.9938 - auc_3: 0.9985 - recall_3: 0.9925 - precision_3: 0.9951 - val_loss: 0.0282 - val_accuracy: 0.9949 - val_auc_3: 0.9990 - val_recall_3: 0.9922 - val_precision_3: 0.9976
Epoch 16/30
159/159 - 6s - loss: 0.0262 - accuracy: 0.9934 - auc_3: 0.9983 - recall_3: 0.9921 - precision_3: 0.9948 - val_loss: 0.2134 - val_accuracy: 0.9578 - val_auc_3: 0.9984 - val_recall_3: 0.9167 - val_precision_3: 0.9987
Epoch 17/30
159/159 - 6s - loss: 0.0252 - accuracy: 0.9934 - auc_3: 0.9985 - recall_3: 0.9923 - precision_3: 0.9946 - val_loss: 0.0854 - val_accuracy: 0.9932 - val_auc_3: 0.9990 - val_recall_3: 0.9869 - val_precision_3: 0.9995
Epoch 18/30
159/159 - 6s - loss: 0.0252 - accuracy: 0.9938 - auc_3: 0.9984 - recall_3: 0.9927 - precision_3: 0.9950 - val_loss: 0.6594 - val_accuracy: 0.7443 - val_auc_3: 0.9934 - val_recall_3: 0.4894 - val_precision_3: 0.9988
Epoch 19/30
159/159 - 6s - loss: 0.0292 - accuracy: 0.9934 - auc_3: 0.9980 - recall_3: 0.9928 - precision_3: 0.9940 - val_loss: 0.0636 - val_accuracy: 0.9914 - val_auc_3: 0.9985 - val_recall_3: 0.9836 - val_precision_3: 0.9992
Epoch 20/30
159/159 - 6s - loss: 0.0258 - accuracy: 0.9938 - auc_3: 0.9981 - recall_3: 0.9925 - precision_3: 0.9950 - val_loss: 0.1907 - val_accuracy: 0.9017 - val_auc_3: 0.9985 - val_recall_3: 0.8047 - val_precision_3: 0.9986
Epoch 21/30
159/159 - 6s - loss: 0.0241 - accuracy: 0.9938 - auc_3: 0.9985 - recall_3: 0.9922 - precision_3: 0.9954 - val_loss: 0.0337 - val_accuracy: 0.9945 - val_auc_3: 0.9986 - val_recall_3: 0.9925 - val_precision_3: 0.9966
Epoch 22/30
159/159 - 6s - loss: 0.0237 - accuracy: 0.9939 - auc_3: 0.9985 - recall_3: 0.9925 - precision_3: 0.9954 - val_loss: 0.4151 - val_accuracy: 0.8275 - val_auc_3: 0.9985 - val_recall_3: 0.6553 - val_precision_3: 0.9998
Epoch 23/30
159/159 - 6s - loss: 0.0231 - accuracy: 0.9940 - auc_3: 0.9986 - recall_3: 0.9923 - precision_3: 0.9957 - val_loss: 0.5227 - val_accuracy: 0.7424 - val_auc_3: 0.9986 - val_recall_3: 0.4855 - val_precision_3: 0.9992
Epoch 24/30
159/159 - 6s - loss: 0.0230 - accuracy: 0.9938 - auc_3: 0.9986 - recall_3: 0.9920 - precision_3: 0.9955 - val_loss: 0.3897 - val_accuracy: 0.8185 - val_auc_3: 0.9982 - val_recall_3: 0.6373 - val_precision_3: 0.9999
Epoch 25/30
159/159 - 6s - loss: 0.0236 - accuracy: 0.9938 - auc_3: 0.9986 - recall_3: 0.9926 - precision_3: 0.9950 - val_loss: 0.5183 - val_accuracy: 0.7538 - val_auc_3: 0.9983 - val_recall_3: 0.5079 - val_precision_3: 0.9997
Epoch 26/30
159/159 - 6s - loss: 0.0231 - accuracy: 0.9939 - auc_3: 0.9987 - recall_3: 0.9922 - precision_3: 0.9956 - val_loss: 0.9896 - val_accuracy: 0.5413 - val_auc_3: 0.9963 - val_recall_3: 0.0831 - val_precision_3: 1.0000
Epoch 27/30
159/159 - 6s - loss: 0.0229 - accuracy: 0.9938 - auc_3: 0.9987 - recall_3: 0.9924 - precision_3: 0.9952 - val_loss: 0.3827 - val_accuracy: 0.7853 - val_auc_3: 0.9982 - val_recall_3: 0.5712 - val_precision_3: 0.9992
Epoch 28/30
159/159 - 6s - loss: 0.0218 - accuracy: 0.9939 - auc_3: 0.9988 - recall_3: 0.9916 - precision_3: 0.9962 - val_loss: 0.1958 - val_accuracy: 0.8998 - val_auc_3: 0.9990 - val_recall_3: 0.7998 - val_precision_3: 0.9999
Epoch 29/30
159/159 - 6s - loss: 0.0252 - accuracy: 0.9936 - auc_3: 0.9984 - recall_3: 0.9923 - precision_3: 0.9948 - val_loss: 0.6917 - val_accuracy: 0.6598 - val_auc_3: 0.9982 - val_recall_3: 0.3198 - val_precision_3: 1.0000
Epoch 30/30
159/159 - 6s - loss: 0.0237 - accuracy: 0.9938 - auc_3: 0.9986 - recall_3: 0.9926 - precision_3: 0.9950 - val_loss: 0.4595 - val_accuracy: 0.7711 - val_auc_3: 0.9984 - val_recall_3: 0.5426 - val_precision_3: 0.9995
Permute truncated is False
Use prob embedding is False
preds ps infec shape is (19818,)
test_data_infection.shape: (4233, 41)
test_data_infection.shape: (4233, 1, 41)
ps_infec.testset_min: -1.7222021363244926
ps_infec.testset_max: 31.46267630066733
Traceback (most recent call last):
  File "relabel_train.py", line 202, in <module>
    art_classifier = KerasClassifier(model=ps_infec, clip_values=(ps_infec.testset_min, ps_infec.testset_max), use_logits=False)
  File "/home/huan1932/.conda/envs/iotedef/lib/python3.8/site-packages/art/estimators/classification/keras.py", line 127, in __init__
    raise TypeError("Type of model not recognized:" + str(type(model)))
TypeError: Type of model not recognized:<class 'models.lstm.Lstm'>
